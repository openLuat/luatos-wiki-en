包含以下内容
Contains the following
本函数仅代表发起成功, 后续仍需根据ready函数判断mqtt是否连接正常
this function only indicates that the mqtt is successfully initiated. you need to determine whether the mqtt connection is normal according to the ready function.
本库有专属demo，[点此链接查看mqtt的demo例子
This library has its own demo,[click this link to view the demo example of mqtt
本页文档由[这个文件](https://gitee.com/openLuat/LuatOS/tree/master/luat/../components/network/libemqtt/luat_lib_mqtt.c)自动生成。如有错误，请提交issue或帮忙修改后pr，谢谢
This page document is automatically generated by [this file](https://gitee.com/openLuat/LuatOS/tree/master/luat/../components/network/libemqtt/luat_lib_mqtt.c). If there is any error, please submit issue or help modify pr, thank you
参数
Parameters
常量
Constant
常量|类型|解释
constant | type | explanation
成功返回true,否则返回
Returns true on success, otherwise
传入值类型|解释
Incoming Value Type | Explanation
带账号密码登录
Login with account password
订阅单个topic, 且
Subscribe to a single topic, and
订阅多个topic, 且使用不同的
subscribe to multiple topics and use different
订阅主题
Subscribe to Topic
端口号
Port number
断开
Disconnect
断开服务器连接(不会释放资源
Disconnect the server (resources are not released
断开连接
Disconnect
额外配置cleanSession,不清除
Additional configuration cleanSession, do not clear
发布消息
Publish message
发起成功返回true, 否则返回
Returns true if the launch is successful, otherwise
发送完成, qos0会马上通知, qos1/qos2会在服务器应答会回调, data为消息
After the sending is completed, qos0 will notify immediately, qos1/qos2 will call back in the server response, and data is a message.
返回值
Return Value
返回值类型|解释
return value type | explanation
服务器地址,可以是域名, 也可以是
Server address, which can be a domain name or
服务器断开连接,网络问题或服务器踢了客户端,例如clientId重复,超时未上报业务数据
The server is disconnected, network problems or the server kicks the client, such as duplicate clientId, timeout not reporting business data
服务器鉴权完成,mqtt连接已经建立, 可以订阅和发布数据了,没有附加数据
the server authentication is completed, the mqtt connection has been established, and data can be subscribed and published without additional data.
回调,参数包括
callback, parameters include
加密TCP链接,不验证服务器证书
Encrypt TCP link without validating server certificate
加密TCPTCP链接,单服务器证书验证
Encrypted TCPTCP link, single server certificate validation
加密TCPTCP链接,单服务器证书验证, 但可选认证
Encrypted TCPTCP link, single server certificate validation, but optional authentication
加密TCPTCP链接,双向证书验证
Encrypted TCPTCP link, two-way certificate verification
接收到数据,由服务器下发, data为topic值(string), payload为业务数据(string).metas是元数据(table), 一般不处理
The received data is delivered by the server, data is the topic value (string), payload is the business data (string), metas is metadata (table), generally not processed.
开始建立连接
Start establishing a connection
可能出现的值有
The possible values are
可选 单位s 默认240s. 最先15,最高
Optional unit s defaults to 240s. first 15, highest
客户端
Client
客户端创建
Client Creation
客户端关闭(关闭后资源释放无法再使用
Client shutdown (resources released after shutdown can no longer be used
客户端是否就绪
Whether the client is ready
客户端状态
Client Status
例子
Examples
连接服务器
Connection Server
连接中
In connection
密码 可选
Password optional
配置是否打开debug信息
Configure whether to open debug information
普通TCP链接
Common TCP Link
清除session,默认true,可选
Clear session, default true, optional
取消订阅主题
Unsubscribe from a topic
取值范围
Value range
若成功会返回mqtt客户端实例,否则返回
if successful, the mqtt client instance is returned. otherwise, the mqtt client instance is returned.
三元组配置及
Triple configuration and
设备识别id,对于同一个mqtt服务器来说, 通常要求唯一,相同client_id会互相踢下线
the device id must be unique for the same mqtt server. the same client_id will be kicked off each other.
设置遗嘱消息
Set Will Message
是否存档, 0/1,默认
Archive, 0/1, default
是否打开debug开关
Whether to turn on debug switch
是否为ipv6 默认不是
ipv6 default is not
是否为ssl加密连接,默认不加密,true为无证书最简单的加密，table为有证书的加密 <br>server_cert 服务器ca证书数据 <br>client_cert 客户端证书数据 <br>client_key 客户端私钥加密数据 <br>client_password 客户端私钥口令数据 <br>verify 是否强制校验 0不校验/1可选校验/2强制校验 默认
Whether it is an ssl encrypted connection or not, default is no encryption, true is the simplest encryption without certificate, table is encryption with certificate <br>server_cert server ca certificate data <br>client_cert client certificate data <br>client_key client private key encrypted data <br>client_password client private key password data <br>verify mandatory verification 0 no verification/1 optional verification/2 mandatory verification default
是否自动重连
Auto reconnect
适配器序号, 只能是socket.ETH0, socket.STA, socket.AP,如果不填,会选择平台自带的方式,然后是最后一个注册的适配器
The adapter serial number can only be socket.ETH0, socket.STA, socket.AP. If it is not filled in, the platform's own method will be selected, and then the last registered adapter will be selected.
为string时生效 0/1/2 默认
0/1/2 Default
无
None
无返回值
No return value
无账号密码登录,仅
Login without account password, only
无clientId模式, 服务器随机生成id, cleanSession不可配置
no clientId mode, the server randomly generates an id, the cleanSession is not configurable
消息,必填,但长度可以是
Message, required, but length can be
消息级别 0/1 默认
Message Level 0/1 Default
消息id, 当qos为1或2时会有效值. 若底层返回是否, 会返回
the id of the message, which is valid when qos is 1 or 2. if no is returned from the bottom layer, the value is returned.
消息id,当qos为1/2时有效, 若底层返回失败,会返回
Message id, valid when qos is 1/2, if the bottom layer fails to return, it will return
心跳设置
Heartbeat Settings
要在connect之前调用
To call before connect
遗嘱消息的
The message of the will
遗嘱消息的qos, 默认0, 可以不填
Qos of will message, default 0, can not fill in
遗嘱消息的retain, 默认0, 可以不填
Retain of will message, default 0, can not fill in
已连接
Connected
已连接 mqtt连接中
Connected mqtt connection in process
已适配
Adapted
用户自定义代码
User-defined code
账号 可选
Account Number Optional
主题
Theme
主题,必填
Subject, required
注册mqtt回调
register mqtt callback
自动重连
Automatic reconnect
自动重连周期 单位ms 默认
Auto reconnect cycle unit ms default