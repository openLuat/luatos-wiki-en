<!doctype html>
<html class="no-js" lang="en_US">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
    <link rel="icon" href="https://www.luatos.com/favicon.ico" type="image/x-icon">
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="prev" title="Luat framework (advanced-underlying mechanism)" href="luatFramework_exts.html" />

    <meta name="generator" content="sphinx-4.4.0, furo 2022.03.04"/>
        <title>Lua 5.3 Reference Manual - LuatOS documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=935aa2abcc5c1da4283d1dc201fb1f0add16d23a" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=25ceb02ed1c46dc30f2321ff83e92799f69dfdb9" />
    <link rel="stylesheet" type="text/css" href="../_static/css/theme-overrides.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/run-code.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/magnific-popup.css" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">LuatOS  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky">
        <!-- 英文站提示 start -->
        <div id="en-site-css" style="display: none;"><a id="en-site-link" style="font-size: 22px;font-weight: bold;background: red;color: white;" href="https://wiki.luatos.org/">(NEW) Go to English site</a></div>
        <div id="zh-site-css" style="display: none;"><a id="zh-site-link" style="font-size: 22px;font-weight: bold;background: red;color: white;" href="https://wiki.luatos.org/">前往中文站点</a></div>
        <div id="discord-css" style="display: none;"><a href="https://discord.gg/FFRsvk4D85"><img src="https://img.shields.io/discord/890114586647355402?color=7289da&label=Discord&logo=discord&logoColor=white" alt="Discord"></a></div>
        <script>
          document.getElementById('en-site-link').href = location.href.replace("wiki.luatos"+".com","wiki.luatos.org");
          document.getElementById('zh-site-link').href = location.href.replace("wiki.luatos.org","wiki.luatos"+".com");
          //在主站，而且是非中文用户
          if (navigator.language.indexOf("CN") < 0 && location.href.indexOf("https://wiki.luatos.org") !== 0 ) {
            document.getElementById('en-site-css').style.cssText = "";
          }
          //在英文站
          if (location.href.indexOf("https://wiki.luatos.org") == 0 ) {
            if(navigator.language.indexOf("CN") < 0)//英文用户
              document.getElementById('discord-css').style.cssText = "";
            else//中文用户
              document.getElementById('zh-site-css').style.cssText = "";
          }
        </script>
        <!-- 英文站提示 end --><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/logo.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/logo-light.svg" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">💁 LuatOS Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://wiki.luatos.org">🏠️ Home Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/emulator.html">🕹️ Online Experience LuatOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/tools.html">🛠 LuatOS Tools Daquan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pages/supports.html">💬 Technical Support</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">🌠 Quick to get started</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="index.html">🌙 Lua Tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Basic Grammar</a></li>
<li class="toctree-l2"><a class="reference internal" href="luatask.html">LuaTask Framework</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chips/index.html">🧮 Chips and Development Boards</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chips/chips.html">📊 Chip comparison and selection table</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../chips/air001/index.html">🛴 Air001</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../chips/air001/mcu.html">Air001 Chip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air001/board.html">Development Board</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air001/hardware.html">Hardware Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air001/Air001-MDK.html">Air001 Keil MDK-based user manual</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air001/Air001-Arduino.html">Air001 Arduino-based user manual</a></li>
<li class="toctree-l3"><a class="reference external" href="https://wiki.luatos.org/_static/bom/Air001.html">Air001_PCB</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../chips/air101/index.html">🚗 Air101</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../chips/air101/mcu.html">Air101 Chip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air101/board.html">Development Board</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air101/hardware.html">Hardware Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air101/Air101-Hard-design.html">Air101 Hardware Design Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air101/Air101.html">Air101 Getting Started Manual</a></li>
<li class="toctree-l3"><a class="reference external" href="https://wiki.luatos.org/_static/bom/Air101.html">Air101_PCB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air101/power_dissipation.html">Air101 power consumption curve</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../chips/air103/index.html">🚗 Air103</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../chips/air103/mcu.html">Air103 Chip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air103/board.html">Development Board</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air103/hardware.html">Hardware Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air103/lcdseg.html">Function Description of Segment Screen/Segment Screen</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air103/touchkey.html">Touch sensor/touch button</a></li>
<li class="toctree-l3"><a class="reference external" href="https://wiki.luatos.org/_static/bom/Air103.html">Air103_PCB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air103/power_dissipation.html">Air103 power consumption curve</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../chips/air105/index.html">🚗 Air105</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../chips/air105/mcu.html">Air105 Chip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air105/board.html">Air105 Development Board</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air105/hardware.html">Hardware Data</a></li>
<li class="toctree-l3"><a class="reference external" href="https://wiki.luatos.org/_static/bom/Air105.html">Air105_PCB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air105/power_dissipation.html">Air105 power consumption curve</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air105/encrypt.html">Air105 Script Encryption</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../chips/air601/index.html">📡 Air601</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../chips/air601/mcu.html">Air601</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air601/board.html">Air601-12F Development Board</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air601/hardware.html">Air601 Hardware Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air601/changelog.html">Firmware Release Notes</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../chips/air780e/index.html">📶 Air780E(EC618 Series General)</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../chips/air780e/mcu.html">Air780E Module (EC618 Series General)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air780e/board.html">Development Board</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air780e/hardware.html">Hardware Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air780e/multiownload.html">Description of mass production brush machine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air780e/network.html">Network Characteristics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air780e/iomux.html">LuatOS IO multiplexing configuration under firmware</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air780e/air780eg.html">Air780EG Additional instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air780e/air700e.html">Air700E Additional instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air780e/tts.html">TTS Description of the function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air780e/firmware.html">Firmware Description</a></li>
<li class="toctree-l3"><a class="reference external" href="https://wiki.luatos.org/_static/bom/Air780E.html">Air780E_PCB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air780e/changelog.html">Ec618 Series Firmware Release Notes</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../chips/air780ep/index.html">📶 Air780EP(EC718P Series General)</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../chips/air780ep/mcu.html">Air780EP Module (EC718P Series General)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air780ep/changelog.html">Ec718 Series Firmware Release Notes</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../chips/esp32c3/index.html">📡 ESP32-C3</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../chips/esp32c3/board.html">ESP32C3-CORE Development Board</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/esp32c3/hardware.html">Hardware Data</a></li>
<li class="toctree-l3"><a class="reference external" href="https://wiki.luatos.org/_static/bom/esp32c3.html">ESP32-C3_PCB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/esp32c3/power_dissipation.html">ESP32C3 power consumption curve</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/esp32c3/change_flash.html">Replace flash tutorial</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../chips/esp32s3/index.html">📡 ESP32-S3</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../chips/esp32s3/board.html">ESP32S3-CORE Development Board</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/esp32s3/hardware.html">Hardware Data</a></li>
<li class="toctree-l3"><a class="reference external" href="https://wiki.luatos.org/_static/bom/esp32s3.html">ESP32-S3_PCB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/esp32s3/mifi.html">Portable wifi data collection</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../chips/air32f103/index.html">🚲 Air32F103</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../chips/air32f103/mcu.html">AIR32F103 Chip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air32f103/board.html">Development Board</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air32f103/hardware.html">Hardware Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air32f103/Air32f103.html">Air32F103 Manual</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air32f103/switchFromSxx.html">Transplant from SXX32F103</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air32f103/enhancement.html">Enhanced function instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air32f103/daplink.html">DAPLink Manual</a></li>
<li class="toctree-l3"><a class="reference external" href="https://wiki.luatos.org/_static/bom/Air32F103.html">Air32F103_PCB</a></li>
<li class="toctree-l3"><a class="reference external" href="https://wiki.luatos.org/_static/bom/BluePill.html">BluePill_PCB</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../chips/rp2040/index.html">📡 RP2040</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference external" href="https://wiki.luatos.org/_static/bom/rp2040.html">RP2040_PCB</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../chips/swm181/index.html">🚲 SWM181CBT6</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../chips/swm181/mcu.html">SWM181CBT6 Chip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/swm181/board.html">Development Board</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/swm181/hardware.html">Hardware Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/swm181/swm181.html">SWM181 Manual</a></li>
<li class="toctree-l3"><a class="reference external" href="https://wiki.luatos.org/_static/bom/SWM181.html">SWM181_PCB</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../chips/air302/index.html">📶 Air302</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../chips/air302/mcu.html">Air302 Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air302/board.html">Development Board</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air302/hardware.html">Hardware Data</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../chips/air640w/index.html">📡 Air640w</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../chips/air640w/mcu.html">Air640w</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air640w/board.html">Development Board</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chips/air640w/hardware.html">Hardware Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../chips/W806.html">🚗 W806</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chips/win32.html">🖥️ PC End version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chips/coremark/README.html">Performance testing (based on coremark)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chips/supported.html">Equipment Support/Supported Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chips/question.html">FAQ List</a></li>
<li class="toctree-l2"><a class="reference external" href="https://air724ug.cn">Air724UG</a></li>
<li class="toctree-l2"><a class="reference external" href="https://air820ug.cn">Air820UG</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../peripherals/index.html">🧷 Peripheral expansion data</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../peripherals/lcd_air10x/index.html">Air10x Series Screen Expansion Board</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../peripherals/lcd_air10x/hardware.html">Hardware Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripherals/lcd_air10x/demos.html">Use Example</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../peripherals/eink_1.54/index.html">EINK1.54 Ink screen</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../peripherals/eink_1.54/hardware.html">Hardware Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripherals/eink_1.54/software.html">Use Example</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../peripherals/lcd_1in8_128x160/index.html">1.8 TFT LCD resolution 128x160</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../peripherals/lcd_1in8_128x160/hardware.html">Hardware Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripherals/lcd_1in8_128x160/demos.html">Use Example</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../peripherals/lcd_2in4_320x240/index.html">2.4 Inch TFT_ LCD color screen resolution 240x320</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../peripherals/lcd_2in4_320x240/hardware.html">Hardware Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripherals/lcd_2in4_320x240/demos.html">Use Example</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../peripherals/lcd_1in54_240x240/index.html">1.54 Inch TFT_ LCD resolution 240x240</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../peripherals/lcd_1in54_240x240/hardware.html">Hardware Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripherals/lcd_1in54_240x240/demos.html">Use Example</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../peripherals/camera_gc032a/index.html">Air105 Supporting GC032A camera</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../peripherals/camera_gc032a/hardware.html">Hardware Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripherals/camera_gc032a/demos.html">Use Example</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../peripherals/chip_gtfont/index.html">Qualcomm Font Chip</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../peripherals/chip_gtfont/hardware.html">Hardware Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peripherals/chip_gtfont/demos.html">Use Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../boardGuide/index.html">📚 Development Tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../boardGuide/roadmap.html">recommend learning line</a></li>
<li class="toctree-l2"><a class="reference internal" href="../boardGuide/vscode.html">Construction of development environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../boardGuide/flash.html">Burn Tutorial</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../boardGuide/common/index.html">API Tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../boardGuide/common/log.html">log</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boardGuide/common/sys.html">sys</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boardGuide/common/adc/index.html">adc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boardGuide/common/crypto.html">CRYPTO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boardGuide/common/fdb.html">fdb</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boardGuide/common/disp.html">DISP</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../boardGuide/common/i2c/index.html">i2c</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../boardGuide/common/i2c/air101.html">air101</a></li>
<li class="toctree-l4"><a class="reference internal" href="../boardGuide/common/i2c/air103.html">air103</a></li>
<li class="toctree-l4"><a class="reference internal" href="../boardGuide/common/i2c/air105.html">air105</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../boardGuide/common/spi/index.html">spi</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../boardGuide/common/spi/air101.html">air101</a></li>
<li class="toctree-l4"><a class="reference internal" href="../boardGuide/common/spi/air103.html">air103</a></li>
<li class="toctree-l4"><a class="reference internal" href="../boardGuide/common/spi/air105.html">air105</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../boardGuide/common/uart/index.html">uart</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../boardGuide/common/uart/air101.html">air101</a></li>
<li class="toctree-l4"><a class="reference internal" href="../boardGuide/common/uart/air103.html">air103</a></li>
<li class="toctree-l4"><a class="reference internal" href="../boardGuide/common/uart/air105.html">air105</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../boardGuide/common/lcd.html">LCD Drive screen</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../boardGuide/common/mcu/index.html">mcu</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../boardGuide/common/mcu/air101.html">air101</a></li>
<li class="toctree-l4"><a class="reference internal" href="../boardGuide/common/mcu/air103.html">air103</a></li>
<li class="toctree-l4"><a class="reference internal" href="../boardGuide/common/mcu/air105.html">air105</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../boardGuide/common/pm.html">PM</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../boardGuide/common/pwm/index.html">pwm</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../boardGuide/common/pwm/air101.html">air101</a></li>
<li class="toctree-l4"><a class="reference internal" href="../boardGuide/common/pwm/air103.html">air103</a></li>
<li class="toctree-l4"><a class="reference internal" href="../boardGuide/common/pwm/air105.html">air105</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../boardGuide/common/rtc.html">RTC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../boardGuide/common/sfd.html">sfd</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../boardGuide/common/sfud/index.html">sfud</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../boardGuide/common/sfud/air101.html">air101</a></li>
<li class="toctree-l4"><a class="reference internal" href="../boardGuide/common/sfud/air103.html">air103</a></li>
<li class="toctree-l4"><a class="reference internal" href="../boardGuide/common/sfud/air105.html">air105</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../boardGuide/common/timer.html">timer</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://gitee.com/openLuat/LuatOS/releases">Firmware Download</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">📖 Reference Manual</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">🍴 LuatOS-SOC Interface Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/supported.html">Adaptation status</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/adc.html">adc - Digital-to-analog conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/audio.html">audio - Multimedia-Audio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/bit64.html">bit64 - 32 Basic arithmetic and logical operations on 64-bit data on bit systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/camera.html">camera - Camera</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/codec.html">codec - Multimedia-Codec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/coremark.html">coremark - Running points</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/crypto.html">crypto - Encryption and decryption and hash functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/ctiot.html">ctiot - China Telecom CTIOT Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/dac.html">dac - Digital-to-analog conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/disp.html">disp - disp Library (Obsolete)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/eink.html">eink - ink screen operation library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/errDump.html">errDump - Error reporting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/fastlz.html">fastlz - FastLZ Compression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/fatfs.html">fatfs - read/write fatfs format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/fdb.html">fdb - kv Database, power failure does not lose data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/fonts.html">fonts - Font Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/fota.html">fota - Underlying Firmware Upgrade</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/fs.html">fs - Additional File System Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/fskv.html">fskv - kv Database, power failure does not lose data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/ftp.html">ftp - ftp Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gmssl.html">gmssl - national secret algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gpio.html">gpio - GPIO Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gtfont.html">gtfont - Qualcomm Font Chip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/hmeta.html">hmeta - Hardware metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/http.html">http - http Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/httpsrv.html">httpsrv - http Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/i2c.html">i2c - I2C Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/i2s.html">i2s - Digital Audio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/iconv.html">iconv - iconv Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/io.html">io - io action (extended)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/ioqueue.html">ioqueue - io Sequence operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/iotauth.html">iotauth - IoT Authentication library, used to generate parameters for various cloud platforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/ir.html">ir - infrared remote control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/json.html">json - json Generating and parsing libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/keyboard.html">keyboard - Keyboard Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/lcd.html">lcd - lcd Drive module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/lcdseg.html">lcdseg - Segment lcd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libcoap.html">libcoap - coap Data processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libgnss.html">libgnss - NMEA Data processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/log.html">log - Logstore</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/lora.html">lora - lora Drive module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/lora2.html">lora2 - lora2 Driver module (supports multi-hanging)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/lvgl.html">lvgl - LVGL Image Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/max30102.html">max30102 - Heart Rate Module(MAX30102)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/mcu.html">mcu - encapsulation mcu some special operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/miniz.html">miniz - Easy zlib compression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/mlx90640.html">mlx90640 - infrared temperature measurement(MLX90640)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/mobile.html">mobile - Cellular Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/mqtt.html">mqtt - mqtt Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/nbiot.html">nbiot - NB-IOT Operation Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/nes.html">nes - nes Simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/nimble.html">nimble - Bluetooth BLE library (nimble version)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/onewire.html">onewire - single bus protocol driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/os.html">os - os Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/otp.html">otp - OTP Operation Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/pack.html">pack - Packing and unpacking format string</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/pin.html">pin - Pin Naming Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/pm.html">pm - Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/protobuf.html">protobuf - ProtoBuffs Codec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/pwm.html">pwm - PWM Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/repl.html">repl - “Read-evaluate-output “loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/rsa.html">rsa - RSA encryption and decryption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/rtc.html">rtc - Real Time Clock</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/rtos.html">rtos - RTOS underlying operation library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/sdio.html">sdio - sdio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/sensor.html">sensor - Sensor Operation Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/sfd.html">sfd - SPI FLASH Operation Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/sfud.html">sfud - SPI FLASH sfud Software package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/sms.html">sms - SMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/socket.html">socket - Network Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/softkeyboard.html">softkeyboard - software keyboard matrix (currently only supported by air105)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/spi.html">spi - spi Operation Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/sqlite3.html">sqlite3 - sqlite3 Database Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/statem.html">statem - SM State Machine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/string.html">string - String Manipulation Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/sys.html">sys - sys Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/sysplus.html">sysplus - sys A strong complement to the library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/timer.html">timer - Operating the bottom timer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/touchkey.html">touchkey - Touch keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/u8g2.html">u8g2 - u8g2 graphics processing library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/uart.html">uart - serial port operation library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/ufont.html">ufont - Unified Font Library (under development)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/usbapp.html">usbapp - USB Functional operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/w5500.html">w5500 - w5500 Ethernet driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/wdt.html">wdt - watchdog Operation Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/websocket.html">websocket - websocket Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/wlan.html">wlan - wifi Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/ws2812.html">ws2812 - Phantom Lights with RGB Controller (WS2812 Series)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/ymodem.html">ymodem - ymodem Agreement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/zbuff.html">zbuff - c Memory Data Manipulation Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/zlib.html">zlib - zlib Compression/Decompression (Obsolete)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/sys_pub.html">📮 sys System Messages</a></li>
<li class="toctree-l1"><a class="reference external" href="https://wiki.luatos.org/_static/lua53doc/index.html">🌕 Native API Manual</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/libs/index.html">🥢 Extended Library Interface Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" role="switch" type="checkbox"/><label for="toctree-checkbox-34"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/ads1115.html">ads1115 - ads1115 analog-to-digital converter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/adxl34x.html">adxl34x - adxl34x 3 Axis accelerometer currently supports adxl345 adxl346</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/aht10.html">aht10 - aht10 Temperature and humidity sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/air153C_wtd.html">air153C_wtd - Add software watchdog function to prevent crashes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/ak8963.html">ak8963 - ak8963 geomagnetic sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/am2320.html">am2320 - am2320 Temperature and humidity sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/bh1750.html">bh1750 - bh1750 Digital light intensity sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/bmx.html">bmx - bmx The air pressure sensor currently supports bmp180 bmp280 bme280 bme680 will automatically judge the device</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/cht8305c.html">cht8305c - cht8305c Temperature and humidity sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/ds3231.html">ds3231 - ds3231 Real Time Clock Sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/ec11.html">ec11 - ec11 Rotary encoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/gt911.html">gt911 - gt911 Drive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/gy53l1.html">gy53l1 - gy53l1 laser ranging sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/httpdns.html">httpdns - Domain name resolution using Http</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/httpplus.html">httpplus - http Supplement to the library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/ina226.html">ina226 - ina226 Drive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/iotcloud.html">iotcloud - iotcloud Cloud platform library (supported: tengxun cloud ariyun onenet huawei cloud graffiti cloud baidu cloud others will also support, useful issue will accelerate support  )</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/l3g4200d.html">l3g4200d - l3g4200d Three-Axis Digital Gyroscope Sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/lbsLoc.html">lbsLoc - lbsLoc Sending Base Station Location Request</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/lbsLoc2.html">lbsLoc2 - base station positioning v2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/libfota.html">libfota - libfota fota Upgrade</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/libnet.html">libnet - libnet synchronous blocking api based on the socket library, the socket library itself is asynchronous non-blocking api</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/lis2dh12.html">lis2dh12 - lis2dh12 Three-axis sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/lm75.html">lm75 - lm75 Temperature Sensor Support lm75a lm75b</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/mcp2515.html">mcp2515 - mcp2515 CAN Protocol Controller Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/mlx90614.html">mlx90614 - mlx90614 infrared temperature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/mpu6xxx.html">mpu6xxx - mpu6xxx Six-axis/nine-axis sensor support mpu6500,mpu6050,mpu9250,icm2068g,icm20608d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/necir.html">necir - necir NEC protocol infrared receiving</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/netLed.html">netLed - netLed Network status indicator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/pcf8563t.html">pcf8563t - pcf8563t Clock Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/pcf8574.html">pcf8574 - pcf8574 IO Extension</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/qmc5883l.html">qmc5883l - qmc5883l geomagnetic sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/rc522.html">rc522 - rc522 Non-contact read/write card driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/rtkv.html">rtkv - Remote KV Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/shift595.html">shift595 - shift595 74HC595 Chip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/si24r1.html">si24r1 - si24r1 Drive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/spl06.html">spl06 - spl06_01 Air pressure sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/tcs3472.html">tcs3472 - tcs3472 Color Sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/tm1637.html">tm1637 - tm1637 Digital tube</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/tm1640.html">tm1640 - tm1640 Digital tube and LED driver chip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/tm1650.html">tm1650 - tm1650 Digital tube and key scanning chip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/tsl2561.html">tsl2561 - tsl2561 light intensity sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/udpsrv.html">udpsrv - UDP Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/vl6180.html">vl6180 - VL6180 laser ranging sensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/xmodem.html">xmodem - xmodem Drive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/ze08g_ch2o.html">ze08g_ch2o - ZE08G-CH2O electrochemical formaldehyde module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/libs/zh07.html">zh07 - ZH07 Laser Dust Sensor</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">🖥️ Kernel Development</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../develop/compile.html">👨‍💻 Compile source code</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" role="switch" type="checkbox"/><label for="toctree-checkbox-35"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../develop/compile/Cloud_compilation.html">☁️ Cloud Compilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../develop/compile/Air780E.html">📶 Air780E Compilation Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../develop/compile/Air101.html">🚗 Air101 / Air103</a></li>
<li class="toctree-l2"><a class="reference internal" href="../develop/compile/Air105.html">🚗 Air105</a></li>
<li class="toctree-l2"><a class="reference internal" href="../develop/compile/ESP32C3.html">📡 ESP32 Series Compilation Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="../develop/compile/Win32.html">🖥️ Win32</a></li>
<li class="toctree-l2"><a class="reference internal" href="../develop/compile/Linux.html">🖥️ Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../develop/compile/Air640w.html">📡 Air640w</a></li>
<li class="toctree-l2"><a class="reference internal" href="../develop/compile/Air302.html">📶 Air302</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../develop/docs.html">📁 Development documentation</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" role="switch" type="checkbox"/><label for="toctree-checkbox-36"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../develop/docs_use.html">Development practice</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" role="switch" type="checkbox"/><label for="toctree-checkbox-37"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../develop/add_myapi_5min.html">Add Custom Functions (Rapid Edition)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../develop/add_myapi_lib.html">Add custom libraries and functions (full version)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../develop/add_lua_module.html">Lua Library File Writing Guide (Pure Lua Writing)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../develop/c_wait.html">C Interface implements Task waiting function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../develop/soc_download.html">Command Line Brush Guide</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../develop/docs_design.html">Development Information</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" role="switch" type="checkbox"/><label for="toctree-checkbox-38"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../develop/filesystems.html">LuatOS-SoC The file system</a></li>
<li class="toctree-l3"><a class="reference internal" href="../develop/hex_string.html">Explain lua’s string and hex data (hexadecimal)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../develop/contribute/luadb.html">LuaDB File Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="../develop/contribute/soc_format.html">LuatOS-SoC Common Firmware Format soc</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../develop/contribute/index.html">❤️ Contribution Code</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" role="switch" type="checkbox"/><label for="toctree-checkbox-39"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../develop/contribute/style.html">Coding Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../develop/contribute/add_module.html">Add New Library</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../develop/contribute/dev_doc/index.html">Design Document</a><input class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" role="switch" type="checkbox"/><label for="toctree-checkbox-40"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../develop/contribute/dev_doc/core/index.html">Core Layer</a><input class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" role="switch" type="checkbox"/><label for="toctree-checkbox-41"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../develop/contribute/dev_doc/core/luat_core.html">Luat Core</a></li>
<li class="toctree-l4"><a class="reference internal" href="../develop/contribute/dev_doc/core/luat_debugger.html">Luat Debugger</a></li>
<li class="toctree-l4"><a class="reference internal" href="../develop/contribute/dev_doc/core/luat_fs.html">File System</a></li>
<li class="toctree-l4"><a class="reference internal" href="../develop/contribute/dev_doc/core/luat_memory.html">Memory Pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../develop/contribute/dev_doc/core/luat_msgbus.html">Message Bus</a></li>
<li class="toctree-l4"><a class="reference internal" href="../develop/contribute/dev_doc/core/luat_platform.html">Luat Platform layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../develop/contribute/dev_doc/core/luat_pm.html">Power and Low Power Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../develop/contribute/dev_doc/core/luat_timer.html">Luat Timer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../develop/contribute/dev_doc/core/luat_zbuff.html">C style buffer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../develop/contribute/dev_doc/core/sys_wait_pub.html">C Interface implements Task waiting function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../develop/contribute/dev_doc/core/luat_zstruct.html">C The Structure of Style</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../develop/contribute/dev_doc/peripherals/index.html">Peripherals API</a><input class="toctree-checkbox" id="toctree-checkbox-42" name="toctree-checkbox-42" role="switch" type="checkbox"/><label for="toctree-checkbox-42"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../develop/contribute/dev_doc/peripherals/luat_gpio.html">GPIO</a></li>
<li class="toctree-l4"><a class="reference internal" href="../develop/contribute/dev_doc/peripherals/luat_ir.html">IR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../develop/contribute/dev_doc/peripherals/luat_spi.html">SPI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../develop/contribute/dev_doc/peripherals/luat_usart.html">UART</a></li>
<li class="toctree-l4"><a class="reference internal" href="../develop/contribute/dev_doc/peripherals/luat_wlan.html">WLAN</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">💼 actual combat reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../appDevelopment/index.html">⌨️ Application Development</a><input class="toctree-checkbox" id="toctree-checkbox-43" name="toctree-checkbox-43" role="switch" type="checkbox"/><label for="toctree-checkbox-43"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../appDevelopment/peripheral/index.html">Peripherals</a><input class="toctree-checkbox" id="toctree-checkbox-44" name="toctree-checkbox-44" role="switch" type="checkbox"/><label for="toctree-checkbox-44"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../appDevelopment/peripheral/ws2812/ws2812.html">LuatOS-Soc Driver WS2812 Tutorial</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../appDevelopment/lvgl/index.html">lvgl</a><input class="toctree-checkbox" id="toctree-checkbox-45" name="toctree-checkbox-45" role="switch" type="checkbox"/><label for="toctree-checkbox-45"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../appDevelopment/lvgl/LVGL_for_LuatOS/LVGL_for_LuatOS.html">LVGL for LuatOS Manual</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appDevelopment/lvgl/LVGL_for_LuatOS/LVGL_for_LuatOS.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appDevelopment/lvgl/LVGL_for_LuatOS/LVGL_for_LuatOS.html#lvgl-foundation">LVGL Foundation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appDevelopment/lvgl/LVGL_for_LuatOS/LVGL_for_LuatOS.html#lvgl-components">LVGL Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appDevelopment/lvgl/LVGL_for_LuatOS/LVGL_for_LuatOS.html#lvgl-advanced">LVGL Advanced</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appDevelopment/lvgl/LVGL_for_LuatOS/LVGL_for_LuatOS.html#id221">Precautions</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../appDevelopment/video_play/index.html">Video playback</a><input class="toctree-checkbox" id="toctree-checkbox-46" name="toctree-checkbox-46" role="switch" type="checkbox"/><label for="toctree-checkbox-46"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../appDevelopment/video_play/105/video_play.html"><strong>Air105 Video playback</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">🗄️ Other information</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../iotpower/index.html">⏳ IoT Power Power consumption test artifact</a><input class="toctree-checkbox" id="toctree-checkbox-47" name="toctree-checkbox-47" role="switch" type="checkbox"/><label for="toctree-checkbox-47"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../iotpower/power/index.html">🔋 IoT Power - V1</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../iotpower/pro/index.html">🔋 IoT Power - Pro</a><input class="toctree-checkbox" id="toctree-checkbox-48" name="toctree-checkbox-48" role="switch" type="checkbox"/><label for="toctree-checkbox-48"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../iotpower/pro/tech.html">Technical indicators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../iotpower/pro/connect.html">Connection and Appearance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../iotpower/pro/usage.html">Operating Instructions</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../iotpower/cc/index.html">⚡ IoT Power - CC</a><input class="toctree-checkbox" id="toctree-checkbox-49" name="toctree-checkbox-49" role="switch" type="checkbox"/><label for="toctree-checkbox-49"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../iotpower/cc/tech.html">Technical indicators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../iotpower/cc/parts.html">Connection and assembly</a></li>
<li class="toctree-l3"><a class="reference internal" href="../iotpower/cc/usage.html">Operating Instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../iotpower/cc/question.html">FAQ</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../iotpower/devices.html">🔍 Version Comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iotpower/pc.html">🖥 PC Client</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../archives.html">🗃️ Data Archiving</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-50" name="toctree-checkbox-50" role="switch" type="checkbox"/><label for="toctree-checkbox-50"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="luatFramework.html">Luat Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="luatFramework_exts.html">Luat framework (advanced-underlying mechanism)</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Lua 5.3 Reference Manual</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="lua-5-3-reference-manual">
<h1>Lua 5.3 Reference Manual<a class="headerlink" href="#lua-5-3-reference-manual" title="Permalink to this headline">#</a></h1>
<p>Author Roberto Ierusalimschy, Luiz Henrique de Figueiredo, Waldemar Celes</p>
<p>Translator <a class="reference external" href="http://blog.codingnow.com">Yun Feng</a></p>
<p>Lua.org, PUC-Rio 版权所有 © 2015 ， It can be used freely under the terms of <a class="reference external" href="http://www.lua.org/license.html">Lua license</a>.</p>
<p>If you are looking for the original manual page, please <a class="reference external" href="https://wiki.luatos.org/_static/lua53doc/index.html">click here to view</a></p>
<hr class="docutils"/>
<section id="introduction">
<h2>1 – Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>Lua It is an extended programming language designed to support general procedural programming and has related data description facilities. It also provides good support for object-oriented programming, functional programming and data-driven programming. As a powerful, lightweight embedded scripting language, it can be used by any program that needs it. Lua is implemented as a library by_clean C (a subset common between standard C and C).</p>
<p>As an extended language, Lua does not have the concept of a “main” program: it can only work in a host program, which is called an embedded program or, for short, a host program_. The host program can call functions to execute a small piece of Lua code, can read and write Lua variables, and can register C functions for Lua code to call. Relying on C functions, Lua can share the same syntax framework to customize the programming language and thus apply to different domains. The official release of Lua includes an example of a host program called <code class="docutils literal notranslate"><span class="pre">lua</span></code>, which is a complete stand-alone Lua interpreter implemented using the Lua library, which can be used for interactive applications or batch processing.</p>
<p>Lua It is a free software, and its use license determines its use without any guarantee. The implementation described in this manual can be found on Lua<code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">official</span> <span class="pre">website</span> <span class="pre">at</span> </code>www.lua.org.</p>
<p>Like many other reference manuals, this document is somewhat boring. For the design ideas behind Lua, take a look at the technical papers available on the Lua website. As for the details of programming with Lua, please refer to Roberto book，<em>Programming in Lua</em>。</p>
</section>
<section id="basic-concepts">
<h2>2 – Basic concepts<a class="headerlink" href="#basic-concepts" title="Permalink to this headline">#</a></h2>
<p>This chapter describes the basic concepts of language.</p>
<section id="value-and-type">
<h3>2.1 – Value and Type<a class="headerlink" href="#value-and-type" title="Permalink to this headline">#</a></h3>
<p>Lua is a_dynamically typed language_. This means that variables have no type; only values have a type. There is no type definition in the language. All values carry their own type.</p>
<p>Lua All the values in are_first-class citizens_. This means that all values can be stored in variables, passed as arguments to other functions, and returned as values.</p>
<p>Lua There are eight basic types in: <em>nil</em>,<em>boolean</em>,<em>number</em>,<em>string</em>,<em>function</em>,<em>userdata</em>,<em>thread</em>, and_table_. _Nil_is the type of value <strong>nil</strong> whose main characteristic is to distinguish it from other values; it is usually used to represent the state when a meaningful value does not exist. _Boolean_is a type of both <strong>false</strong>and<strong>true</strong> values. Both <strong>nil</strong>and<strong>false</strong> cause the condition to be false; any other value is true. _Number_represents integers and real numbers (floating point numbers). _String_represents an immutable sequence of bytes. Lua is 8-bit friendly: a string can hold any 8-bit value, including zeros (<code class="docutils literal notranslate"><span class="pre">\0</span></code>). Lua<code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">string</span> <span class="pre">has</span> <span class="pre">nothing</span> <span class="pre">to</span> <span class="pre">do</span> <span class="pre">with</span> <span class="pre">encoding;</span> <span class="pre">it</span> <span class="pre">doesn</span></code>t care about the exact contents of the string.</p>
<p><em>number</em> There are two internal representations of types,<em>integer_and_floating point</em>. Lua has clear rules for when to use which internal form, but it also makes automatic conversions as needed (see <span class="xref myst">§ 3.4.3</span>). Therefore, in most cases, the programmer can choose to ignore the difference between integers and floating-point numbers or assume complete control over the internal representation of each number. Standard Lua uses 64-bit integers and double-precision (64-bit) floats, but you can also compile Lua to use 32-bit integers and single-precision (32-bit) floats. Representation of numbers in 32 bits is particularly suitable for small machines and embedded systems. (See macros in the <code class="docutils literal notranslate"><span class="pre">luaconf.h</span></code> file <code class="docutils literal notranslate"><span class="pre">LUA_32BITS</span></code> 。）</p>
<p>Lua Functions written in Lua or C (see <span class="xref myst">§ 3.4.10</span>) can be called (and operated). These two functions have a uniform type <em>function</em>。</p>
<p><em>userdata</em> type allows data in C to be stored in Lua variables. The value of the user data type is a memory block, and there are two types of user data:<em>complete user data</em>, which refers to an object corresponding to a memory managed by Lua;<em>lightweight user data</em>, which refers to a simple C pointer. User data has no predefined operations in Lua other than assignment and equality determination. By using the_metatable_, the programmer can define a series of operations on full user data (see <span class="xref myst">§ 2.4</span>). You can only create or modify the value of user data in Lua code through the C API, which ensures that the data is only controlled by the host program.</p>
<p><em>thread</em> A type represents an independent execution sequence that is used to implement a coroutine (see <span class="xref myst">§ 2.6</span>). The threads of Lua have nothing to do with the threads of the operating system. Lua provides coroutet support for all systems, including those that do not support native threads.</p>
<p><em>table</em> is an associative array, that is, this array is not only indexed by numbers, but all Lua values except <strong>nil</strong> and NaN can be indexed. (The_Not a Number_ is a special number that is used to represent the result of an undefined or unrepresentative operation, such as<code class="docutils literal notranslate"><span class="pre">0/0</span></code>.) Tables can be heterogeneous; that is, they can contain values of any type (except <strong>nil</strong>). Any key with a value of <strong>nil</strong> will not be recorded inside the table structure. In other words, for keys that do not exist in the table, they all correspond to values. <strong>nil</strong> 。</p>
<p>Tables are the only data structures in Lua that can be used to represent ordinary arrays, sequences, symbolic tables, collections, records, graphs, trees, and so on. For records, Lua uses the domain name as an index. The language provides syntactic sugar such as <code class="docutils literal notranslate"><span class="pre">a.name</span></code> instead of <code class="docutils literal notranslate"><span class="pre">a["name"]</span></code>to facilitate the use of this structure. There are several convenient ways to create tables in Lua (cf. <span class="xref myst">§3.4.9</span>）。</p>
<p>We use the term_sequence_to denote a table indexed by the set of positive integers {1 ..<em>n</em>}. Here the non-negative integer_n_is called the length of the sequence (cf. <span class="xref myst">§3.4.7</span>）。</p>
<p>Like an index, the value of each field in a table can be of any type. It is important to note that since functions are first-class citizens, the fields of the table can also be functions. In this way, the table can carry_method. (See <span class="xref myst">§3.4.11</span>）。</p>
<p>The principle of indexing a table follows the rules of direct comparison in the language. The expressions <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">[I]</span> </code>and <code class="docutils literal notranslate"><span class="pre">a[j]</span></code> represent the same elements in the table if and only if <code class="docutils literal notranslate"><span class="pre">I</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span></code> are directly compared equal (I. e., not by meta-method comparison). In particular, a floating-point number that can be fully represented as an integer is equal to the corresponding integer (for example: <code class="docutils literal notranslate"><span class="pre">1.0</span> <span class="pre">=</span> <span class="pre">=</span> <span class="pre">1</span> </code>). In order to eliminate ambiguity, when a floating-point number that can be fully represented as an integer is used as a key value, it will be converted to the corresponding integer storage. For example, when you write <code class="docutils literal notranslate"><span class="pre">a[2.0]</span> <span class="pre">=</span> <span class="pre">true</span></code>, the key that is actually inserted into the table is the integer <code class="docutils literal notranslate"><span class="pre">2</span> </code>. (On the other hand, 2 and “<code class="docutils literal notranslate"><span class="pre">2</span></code>” are two different Lua values, so they can be different items in the same table.。）</p>
<p>Tables, functions, threads, and full user data are called_objects_in Lua: variables do not really_hold_their values, but only_references_to these objects_. Assignments, parameter passing, and function returns are all operations on references rather than values, and none of these operations do any form of implicit copy.</p>
<p>The library function <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">type</span></code></span> is used to return the type of a given value as a string. (See <span class="xref myst">§6.1</span>）。</p>
</section>
<section id="environment-and-global-environment">
<h3>2.2 – Environment and Global Environment<a class="headerlink" href="#environment-and-global-environment" title="Permalink to this headline">#</a></h3>
<p>As discussed later in <span class="xref myst">§ 3.2</span> and <span class="xref myst">§ 3.3.3</span>, reference to a free name called <code class="docutils literal notranslate"><span class="pre">var</span></code> (referring to a name that is not declared at any level) is syntactically translated as <code class="docutils literal notranslate"><span class="pre">_ENV.var</span></code>. In addition, every compiled Lua code block will have an external local variable called <code class="docutils literal notranslate"><span class="pre">_ENV</span></code> (see <span class="xref myst">§ 3.3.2</span>), so the name<code class="docutils literal notranslate"><span class="pre">_ENV</span></code> will never be a free name in a code block.</p>
<p>When translating those free names, it doesn<code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">matter</span> <span class="pre">whether</span> </code>_ENV<code class="docutils literal notranslate"><span class="pre">is</span> <span class="pre">the</span> <span class="pre">external</span> <span class="pre">local</span> <span class="pre">variable.</span> <span class="pre">There</span> <span class="pre">is</span> <span class="pre">no</span> <span class="pre">difference</span> <span class="pre">between</span></code>_ENV<code class="docutils literal notranslate"><span class="pre">and</span> <span class="pre">other</span> <span class="pre">variable</span> <span class="pre">names</span> <span class="pre">you</span> <span class="pre">can</span> <span class="pre">use.</span> <span class="pre">In</span> <span class="pre">particular,</span> <span class="pre">you</span> <span class="pre">can</span> <span class="pre">define</span> <span class="pre">a</span> <span class="pre">new</span> <span class="pre">variable</span> <span class="pre">or</span> <span class="pre">specify</span> <span class="pre">a</span> <span class="pre">parameter</span> <span class="pre">by</span> <span class="pre">this</span> <span class="pre">name.</span> <span class="pre">The</span></code>_ENV<code class="docutils literal notranslate"> <span class="pre">used</span> <span class="pre">by</span> <span class="pre">the</span> <span class="pre">compiler</span> <span class="pre">when</span> <span class="pre">translating</span> <span class="pre">free</span> <span class="pre">names</span> <span class="pre">refers</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">variable</span> <span class="pre">named</span> <span class="pre">\_ENV</span> <span class="pre">that</span> <span class="pre">is</span> <span class="pre">visible</span> <span class="pre">to</span> <span class="pre">your</span> <span class="pre">program</span> <span class="pre">at</span> <span class="pre">that</span> <span class="pre">point.</span> <span class="pre">(Lua</span></code>s visibility rules see <span class="xref myst">§3.5</span>）</p>
<p>The table used by <code class="docutils literal notranslate"><span class="pre">_ENV</span></code> for values is called_environment _。</p>
<p>Lua There is a special environment called_global environment. It is stored under a special index in the C registry (see <span class="xref myst">§ 4.5</span>). In Lua, the global variable <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">_G</span></code></span> is initialized to this value. (<span class="xref myst"><code class="docutils literal notranslate"><span class="pre">_G</span></code></span> is not used anywhere internally。）</p>
<p>When Lua loads a block of code, the default value of <code class="docutils literal notranslate"><span class="pre">_ENV</span></code> is the global environment (see <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">load</span></code></span>). Therefore, by default, the free names mentioned in Lua code refer to the relevant items in the global environment (therefore, they are also called_global variables_). In addition, all standard libraries are loaded into the global environment, and some functions also operate on this environment. You can load blocks of code with <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">load</span></code></span> (or <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">loadfile</span></code></span>) and give them different environments. (In C, when you load a block of code, you can change its environment by changing its first upper value.。）</p>
</section>
<section id="error-handling">
<h3>2.3 – Error handling<a class="headerlink" href="#error-handling" title="Permalink to this headline">#</a></h3>
<p>Since Lua is an embedded extension language, all its behaviors are derived from the call of a Lua library function by the C code in the host program. (When Lua is used alone, the <code class="docutils literal notranslate"><span class="pre">lua</span></code> program is the host program.) Therefore, in the process of compiling or running Lua code block, whenever an error occurs, control is returned to the host, which is responsible for taking appropriate measures (such as printing error messages）。</p>
<p>You can call the <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">error</span></code></span> function in Lua code to explicitly throw an error. If you need to catch these errors in Lua, you can use <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">pcall</span></code></span> or <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">xpcall</span></code></span> to call a function in_protected mode.</p>
<p>Whenever an error occurs, an_error object_ (<em>error message</em>) carrying the error message is thrown. Lua itself will only generate string type error objects for errors, but your program can generate any type of error object for errors, depending on how your Lua program or host program handles these error objects.</p>
<p>When using <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">xpcall</span></code></span> or <span class="xref myst">`lua_pcall</span>, you should provide a_message handler_to be called when the error is thrown. This function receives the original error message and returns a new error message. It is called when the stack has not been expanded since the error occurred, so you can use the stack to collect more information, such as by exploring the stack to create a set of stack backtracking information. At the same time, the handler is also in protected mode, so an error within the function triggers it again (recursively). If the recursion is too deep, Lua terminates the call and returns an appropriate message.</p>
</section>
<section id="meta-table-and-meta-method">
<h3>2.4 – Meta Table and Meta Method<a class="headerlink" href="#meta-table-and-meta-method" title="Permalink to this headline">#</a></h3>
<p>Lua Each value in can have a_meta table_. This_meta table_is a normal Lua table that defines the behavior of the original value under a specific operation. If you want to change the behavior of a value under a specific operation, you can set the corresponding field in its meta table. For example, when you add a non-numeric value, Lua checks the function under the <code class="docutils literal notranslate"><span class="pre">__add</span></code> field in the meta table for that value. If it can be found, Lua calls this function to complete the add operation.</p>
<p>The key value of an event in the meta table is a string with a double underscore (<code class="docutils literal notranslate"><span class="pre">__</span></code>) plus the event name; those values associated with the key are called the_meta method_. In the previous example, <code class="docutils literal notranslate"><span class="pre">__add</span></code> is the key value, and the corresponding meta method is the function that performs the add operation.</p>
<p>You can use the <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">getmetatable</span></code></span> function to get the metatable of any value. Lua uses direct access to query meta methods from the meta table (see <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">rawget</span></code></span>). So, the meta-method for getting event <code class="docutils literal notranslate"><span class="pre">ev</span></code> from object <code class="docutils literal notranslate"><span class="pre">o</span></code> is equivalent to the following code：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> rawget(getmetatable(_o_) or {}, "\_\__ev_")
</pre></div>
</div>
<p>You can use <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">setmetatable</span></code></span> to replace the meta table of a table. In Lua, you cannot change the meta table for values of types other than table (unless you use a debugging library (see <span class="xref myst">§ 6.10</span>)); to change the meta table for values of these non-table types, use C API。</p>
<p>Tables and full user data have separate meta tables (of course, multiple tables and user data can share the same meta table). Other types of values share a meta table by type; that is, all numbers share the same meta table, all strings share another meta table, and so on. By default, the value has no meta table, but the string library sets the meta table for the string type at initialization (see. <span class="xref myst">§6.4</span>）。</p>
<p>Metatables determine the behavior of an object during mathematical operations, bit operations, comparisons, joins, lengths, calls, and indexes. A metatable can also define a function that is called when a table object or user data object is garbage collected (see <span class="xref myst">§ 2.5</span>).</p>
<p>For unary operators (negative, length, bit inversion), when the meta method is called, the second parameter is a dummy with a value equal to the first parameter. This treatment is only to simplify the internal implementation of Lua (this treatment allows all operations to be consistent with binary operations), and this behavior may be removed in future versions. (The behavior of using this additional parameter is uncertain.。）</p>
<p>Next is a detailed list of the events that the meta table can control. Each operation is distinguished by the corresponding event name. The key name of each event is represented by a string prefixed with <code class="docutils literal notranslate"><span class="pre">__</span></code>; for example, the key name of the “add” operation is a string “<code class="docutils literal notranslate"><span class="pre">__add</span></code>”。</p>
<ul>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__add</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">+</span></code> Operation. If any value that is not a number (including a string that cannot be converted to a number) is added, Lua will try to call the meta method. First, Lua checks the first operand (even if it is legal). If this operand does not have a meta method defined for the “<code class="docutils literal notranslate"><span class="pre">__add</span></code>” event, Lua checks the second operand. Once Lua finds the meta-method, it will pass the two operands as parameters to the meta-method, and the result of the meta-method (adjusted to a single value) as the result of the operation. If the meta method cannot be found, an error will be thrown.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__sub</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">-</span></code> Operation. The behavior is similar to the “add” operation.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__mul</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">*</span></code> Operation. The behavior is similar to the “add” operation.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__div</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">/</span></code> Operation. The behavior is similar to the “add” operation.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__mod</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">%</span></code> Operation. The behavior is similar to the “add” operation.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__pow</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">^</span></code> （power) operation. The behavior is similar to the “add” operation.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__unm</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">-</span></code> （negative) operation. The behavior is similar to the “add” operation.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__idiv</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">//</span></code> （down to take the whole division) operation. The behavior is similar to the “add” operation.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__band</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> （bitwise and) operation. The behavior is similar to the “add” operation, except that Lua will try the element method when any of the operands cannot be converted to an integer (see <span class="xref myst">§ 3.4.3</span>).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__bor</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">|</span></code> （bitwise or) operation. The behavior is similar to the “band” operation.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__bxor</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">~</span></code> （bitwise XOR) operation. The behavior is similar to the “band” operation.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__bnot</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">~</span></code> （bitwise not) operation. The behavior is similar to the “band” operation.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__shl</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code> （left shift) operation. The behavior is similar to the “band” operation.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__shr</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code> （right) operation. The behavior is similar to the “band” operation.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__concat</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">..</span></code> （connection) operation. The behavior is similar to the “add” operation, except that Lua tries the meta method if any operand is neither a string nor a number (a number can always be converted to the corresponding string).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__len</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">#</span></code> （take the length) operation. If the object is not a string, Lua tries its meta methods. If there is a meta method, it is called and the object is passed in as a parameter, and the return value (adjusted to a single) is the result. If the object is a table and there is no meta-method, Lua uses the table length operation (see <span class="xref myst">§ 3.4.7</span>). In other cases, errors are thrown.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__eq</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">==</span></code> （equal to) operation. The behavior is similar to the “add” operation, except that Lua only tries meta methods when both values are tables or full user data and they are not the same object. The result of the call is always converted to a boolean.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__lt</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> （less than) operation. The behavior is similar to the “add” operation, except that Lua only tries meta methods when the two values are not all integers or all strings. The result of the call is always converted to a boolean.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__le</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code> （Less than or equal to) operation. Unlike other operations, the less than or equal to operation may use two different events. First, like the behavior of the “lt” operation, Lua looks for the “<code class="docutils literal notranslate"><span class="pre">__le</span></code>” meta-method in both operands. If a meta-method cannot find it, it will look for the “<code class="docutils literal notranslate"><span class="pre">__lt</span></code>” event again, assuming that <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&lt;=</span> <span class="pre">B</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">(B</span> <span class="pre">&lt;a)</span></code>. Similar to other comparison operators, the results are converted to Boolean quantities.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__index</span></code>:</strong> Index <code class="docutils literal notranslate"><span class="pre">table[key]</span></code>. This event is triggered when <code class="docutils literal notranslate"><span class="pre">table</span></code> is not a table or the key <code class="docutils literal notranslate"><span class="pre">key</span></code> does not exist in the table <code class="docutils literal notranslate"><span class="pre">table.</span> <span class="pre">At</span> <span class="pre">this</span> <span class="pre">point,</span> <span class="pre">the</span> <span class="pre">corresponding</span> <span class="pre">meta-method</span> <span class="pre">of</span> </code>table` is read out.</p>
<p>Despite the name, the meta-method for this event can actually be a function or a table. If it is a function, it is called with <code class="docutils literal notranslate"><span class="pre">table</span></code> and <code class="docutils literal notranslate"><span class="pre">key</span></code> as arguments. If it is a table, the final result is the result of indexing the table with `key. (This indexing process is a regular process, not a direct index, so this index may trigger another meta-method.。）</p>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__newindex</span></code>:</strong> Index assignment <code class="docutils literal notranslate"><span class="pre">table[key]</span> <span class="pre">=</span> <span class="pre">value</span> </code>. Similar to the index event, it occurs when <code class="docutils literal notranslate"><span class="pre">table</span></code> is not a table or the key <code class="docutils literal notranslate"><span class="pre">key</span></code> does not exist in the table <code class="docutils literal notranslate"><span class="pre">table.</span> <span class="pre">At</span> <span class="pre">this</span> <span class="pre">point,</span> <span class="pre">the</span> <span class="pre">corresponding</span> <span class="pre">meta-method</span> <span class="pre">of</span> </code>table` is read out.</p>
<p>As with the indexing process, the meta-method for this event can be either a function or a table. If it is a function, the parameters <code class="docutils literal notranslate"><span class="pre">table</span></code>, <code class="docutils literal notranslate"><span class="pre">key</span></code>, and <code class="docutils literal notranslate"><span class="pre">value</span></code> are passed in. If it is a table, Lua assigns an index to the table. (This indexing process is a regular process, not a direct index assignment, so this index assignment may trigger another meta-method。）</p>
<p>Once you have the “newindex” meta-method, Lua no longer does the initial assignment. (If necessary, <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">rawset</span></code></span> can be called inside the meta method to do the assignment。）</p>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">__call</span></code>:</strong> The function calls the operation <code class="docutils literal notranslate"><span class="pre">func(args)</span></code>. This event is triggered when Lua tries to call a value that is not a function (I. e. <code class="docutils literal notranslate"><span class="pre">func</span></code> is not a function). Find the meta-method of<code class="docutils literal notranslate"> <span class="pre">func</span></code>, and if you can find it, call this meta-method, <code class="docutils literal notranslate"><span class="pre">func</span></code> is passed in as the first parameter, and the originally called parameter (<code class="docutils literal notranslate"> <span class="pre">args</span></code>) is followed by the order.</p></li>
</ul>
</section>
<section id="garbage-collection">
<h3>2.5 – Garbage collection<a class="headerlink" href="#garbage-collection" title="Permalink to this headline">#</a></h3>
<p>Lua Automatic memory management. This means that you don’t have to worry about how the memory needed by newly created objects is allocated, or how to release the memory occupied by objects after they are no longer in use. Lua runs a_garbage collector_to collect all_dead objects_(that is, objects that are no longer accessible in Lua) to complete the work of automatic memory management. All memory used in Lua, such as strings, tables, user data, functions, threads, internal structures, etc., are subject to automatic management.</p>
<p>Lua An incremental marker-scan collector is implemented. It uses these two numbers to control the garbage collection cycle:<em>garbage collector intermittent rate_and_garbage collector step rate</em>. Both of these numbers use percentages as units (e. g. the value 100 is represented internally 1 ）。</p>
<p>The garbage collector intermittency rate controls how long the collector has to wait before starting a new cycle. Increasing this value will reduce the enthusiasm of the collector. When this value is less than 100, the collector will not wait before starting a new loop. Setting this value to 200 will cause the collector to wait until the total memory usage has doubled before starting a new cycle.</p>
<p>The garbage collector step rate controls the rate at which the collector operates relative to the memory allocation rate. Increasing this value not only makes the collector more aggressive, but also increases the length of each incremental step. Don’t set this value less than 100, then the collector will work too slowly to finish a cycle forever. The default value is 200, which means that the collector operates at twice the speed of memory allocation.</p>
<p>If you set the step factor to a very large number (10% larger than the number of bytes your program may use), the collector behaves like a stop-the-world collector. Then if you set the intermittent rate to 200, the collector behaves like the previous version of Lua: every time Lua doubles the memory used, it does a complete collection.</p>
<p>You can change these numbers by calling <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_gc</span></code></span> in C or <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">collectgarbage</span></code></span> in Lua. These two functions can also be used to directly control the collector (e. g. stop it or restart it）。</p>
<section id="garbage-collection-meta-method">
<h4>2.5.1 – garbage collection meta-method<a class="headerlink" href="#garbage-collection-meta-method" title="Permalink to this headline">#</a></h4>
<p>You can set the meta method for garbage collection for tables, and for full user data (see <span class="xref myst">§ 2.4</span>), you need to use the C API. The meta-method is called_terminator_. Finalizers allow you to work with Lua’s garbage collector to do some additional resource management tasks (such as closing files, network or database connections, or freeing up some of your own memory.）。</p>
<p>If you want an object (table or user data) to enter the finalization process during collection, you must_mark_it needs to trigger the finalizer. When you set up a meta table for an object, if at this moment the meta table uses a field indexed by the string “<code class="docutils literal notranslate"><span class="pre">__gc</span></code>”, then it is marked that the object needs to trigger the finalizer. Note: If you set up a meta table without <code class="docutils literal notranslate"><span class="pre">__gc</span></code> field for an object and then add this field to the meta table, then the object is not marked as needing to trigger the finalizer. However, once the object is marked, you are still free to change the <code class="docutils literal notranslate"><span class="pre">__gc</span></code> field in its meta table.</p>
<p>When a marked object becomes garbage, the garbage collector does not immediately recycle it. Instead, Lua puts it into a linked list. After the collection is complete, Lua will traverse the linked list. Lua will check the <code class="docutils literal notranslate"><span class="pre">__gc</span></code> meta-method of each object in the linked list: if it is a function, it will be called with the object as the only parameter; Otherwise, it will be ignored directly.</p>
<p>In the final stage of each garbage collection cycle, the triggering order of the finalizers of the objects detected in this cycle that need to be recycled is carried out in the reverse order of the order in which the objects were marked as needing to trigger the finalizers. That is to say, the first called finalizer is the one carried by the last marked object in the program. The operation of each finalizer may occur at any point during the execution of the regular code.</p>
<p>Since the recycled object still needs to be used by the finalizer, the object (and other objects that can only be accessed through it) must be revived by Lua_. Usually, the resurrection is short-lived and the memory to which the object belongs is freed in the next garbage collection cycle. Then, if the finalizer saves the object in some global place (for example, in a global variable), the resurrection will continue to take effect. In addition, if an object that is entering the finalizer process is marked again in the finalizer to trigger the finalizer, its finalizer function will be called again as long as the object is still unreachable in the next loop. In either case, the memory to which the object belongs is released only if the object is unreachable during the garbage collection cycle and is not marked as needing to trigger the finalizer.</p>
<p>When you close a state machine (see <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_close</span></code></span>), Lua will call all the finalization procedures marked as needing to trigger the finalizer object, in the reverse order of the marked order. Any act of the finalizer marking the object again does not take effect during this process.</p>
</section>
<section id="weak-table">
<h4>2.5.2 – Weak table<a class="headerlink" href="#weak-table" title="Permalink to this headline">#</a></h4>
<p>_ Weak table_refers to a table whose internal element is_weak reference. The garbage collector ignores weak references. In other words, if an object is referenced only by weak references, the garbage collector reclaims the object.</p>
<p>A weak table can have weak keys or weak values, or both keys and values can be weak references. A table with a weak value allows the collector to reclaim its value, but prevents the collector from reclaiming its key. If the key values of a table are weak references, the collector can recycle any key and value. In any case, whenever either the key or the value is recycled, the associated key-value pair is removed from the table. The ‘__mode’ field in the meta table of a table controls the weak properties of the table. When the ‘__mode’ field is a string containing the character ‘’k’’, all keys in this table are weak references. When the ‘__mode’ field is a string containing the character’ v’, all values in this table are weak references.</p>
<p>A table whose attribute is a weak key and strong value is also called a_temporary table_. For a temporary table, whether its value is reachable depends only on whether its corresponding key is reachable. Note that if a key in a table is referenced only by its value, the key-value pair will be removed from the table.</p>
<p>Modifications to a table’s weak attributes take effect only on the next collection cycle. Especially when you change the table from weak to strong, Lua may still recycle some items in the table before the modification takes effect.</p>
<p>Only those objects that have an explicit construction process are removed from the weak table. Values, such as numbers and lightweight C functions, are not governed by the garbage collector and therefore are not removed from the weak table (unless their associated items are recycled). Although strings are governed by the garbage collector, they do not have an explicit construction process, so they are not removed from the weak table.</p>
<p>Weak tables have special behavior for resurrected objects (those that are going through the finalizer process and can only be accessed by the finalizer). Objects referenced by weak values are removed before their finalizers are run, while objects referenced by weak keys are not removed until the finalizers are run and the next collection when the objects are actually released. This behavior allows the finalizer runtime to access the properties associated by the object in the weak table.</p>
<p>If a weak table is in the resurrection object in the current collection cycle, then the table may not be properly cleaned up before the next cycle.</p>
</section>
</section>
<section id="synergy">
<h3>2.6 – Synergy<a class="headerlink" href="#synergy" title="Permalink to this headline">#</a></h3>
<p>Lua Support coroutation, also called_collaborative multithreading_. A coroutine in Lua represents a separate thread of execution. However, unlike threads in multi-threaded systems, a coroutine suspends current execution only when a yield function is explicitly called.</p>
<p>Call the function <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">coroutine.create</span></code></span> to create a coprocess. Its only argument is the main function of the coroutine. The <code class="docutils literal notranslate"><span class="pre">create</span></code> function is only responsible for creating a coroutine and returning its handle (an object of type_thread_).</p>
<p>Call the <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">coroutine.resume</span></code></span> function to execute a coroutine. When calling <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">coroutine.resume</span></code></span> for the first time, the first parameter should pass in the thread object returned by <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">coroutine.create</span></code></span>, and then the coroutine starts execution from the first line of its main function. Additional parameters passed to <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">coroutine.resume</span></code></span> are passed in as arguments to the main coroutine function. After the coroute is started, it will run until it terminates or gives up._。</p>
<p>The running of the coroutine may be terminated in two ways: the normal way is that the main function returns (explicitly returns or runs the last instruction); The abnormal way is that an error has not been caught. For normal termination, <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">coroutine.resume</span></code></span> will return <strong>true</strong>, followed by the return value of the coroutine main function. When an error occurs, <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">coroutine.resume</span></code></span> will return <strong>false</strong> with the error message.</p>
<p>By calling <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">coroutine.yield</span></code></span>, the execution of the coroutine is suspended to give up the execution right. When a coroutine cedes, the corresponding nearest <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">coroutine.resume</span></code></span> function returns immediately, even if the cede occurs in an inline function call (I. e., not in the main function, but inside a function called directly or indirectly by the main function). <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">coroutine.resume</span></code></span> also returns <strong>true</strong> with the parameters passed to <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">coroutine.yield</span></code></span>. The next time the same co-process is restarted, the co-process will then continue to execute from the point of yield. At this point, the previous call to <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">coroutine.yield</span></code></span> at the exit point will be returned, and the return value is other than the first parameter passed to <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">coroutine.resume</span></code></span>.</p>
<p>Similar to <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">coroutine.create</span></code></span>, the <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">coroutine.wrap</span></code></span> function also creates a coroutine. The difference is that instead of returning the coroutine itself, it returns a function. Calling this function will start the coroutage. Any arguments passed to this function are treated as extra arguments to <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">coroutine.resume</span></code></span>. <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">coroutine.wrap</span></code></span> returns all the return values of <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">coroutine.resume</span></code></span> except the first return value (boolean error code). Unlike <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">coroutine.resume</span></code></span>, [<code class="docutils literal notranslate"><span class="pre">coroutine.</span> <span class="pre">pdf-coroutine.wrap](#</span> <span class="pre">resume</span></code>) does not catch errors; instead, any errors are propagated to the caller.</p>
<p>The following code shows an example of a coroutet working：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> function foo (a)
   print("foo", a)
   return coroutine.yield(2\*a)
 end

 co = coroutine.create(function (a,b)
       print("co-body", a, b)
       local r = foo(a+1)
       print("co-body", r)
       local r, s = coroutine.yield(a+b, a-b)
       print("co-body", r, s)
       return b, "end"
 end)

 print("main", coroutine.resume(co, 1, 10))
 print("main", coroutine.resume(co, "r"))
 print("main", coroutine.resume(co, "x", "y"))
 print("main", coroutine.resume(co, "x", "y"))
</pre></div>
</div>
<p>When you run it, it produces the following output：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> co-body 1       10
 foo     2
 main    true    4
 co-body r
 main    true    11      -9
 co-body x       y
 main    true    10      end
 main    false   cannot resume dead coroutine
</pre></div>
</div>
<p>You can also use the C API to create and manipulate coroutine: see functions <span class="xref myst">lua_newthread</span>, <span class="xref myst">lua_resume</span>, and <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_yield</span></code></span>。</p>
</section>
</section>
<section id="language-definition">
<h2>3 – Language Definition<a class="headerlink" href="#language-definition" title="Permalink to this headline">#</a></h2>
<p>This chapter describes the lexical, grammatical and syntactic aspects of Lua. In other words, this chapter describes which symbols are valid, how they are combined, and what these combinations mean.</p>
<p>Concepts about the composition of the language will be written in common extended BNF expressions. It looks like this: {<em>a</em>} means 0 or more_a_, and [<em>a</em>] means an optional_a_. Non-final symbols that can be decomposed are written as non-terminal, keywords are written as <strong>kword</strong>, and other final symbols that cannot be decomposed are written as’ **= * * ‘. The complete Lua syntax can be found in the last chapter of this manual <span class="xref myst">§ 9</span>.</p>
<section id="lexical-convention">
<h3>3.1 – lexical convention<a class="headerlink" href="#lexical-convention" title="Permalink to this headline">#</a></h3>
<p>Lua The language format is free. It ignores spaces (including line breaks) and comments between syntax elements (symbols) and only sees them as a separator between names and keywords.</p>
<p>Lua The_name_(also known as_identifier_) in can be a string consisting of any letter underscore and number that is not a number. Identifiers can be used to name variables, fields of tables, and labels.</p>
<p>The following_keywords_are reserved and cannot be used for names：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> and       break     do        else      elseif    end
 false     for       function  goto      if        in
 local     nil       not       or        repeat    return
 then      true      until     while
</pre></div>
</div>
<p>Lua The language is case sensitive: <code class="docutils literal notranslate"><span class="pre">and</span></code> is a reserved word, but <code class="docutils literal notranslate"><span class="pre">And</span></code> and <code class="docutils literal notranslate"><span class="pre">AND</span></code> are two different valid names. As a convention, programs should avoid creating names that are underlined with one or more uppercase letters (e. g. <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">_VERSION</span></code></span>）。</p>
<p>The following strings are some other symbols：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> +     -     \*     /     %     ^     #
 &amp;     ~     |     &lt;&lt;    &gt;&gt;    //
 ==    ~=    &lt;=    &gt;=    &lt;     &gt;     =
 (     )     {     }     \[     \]     ::
 ;     :     ,     .     ..    ...
</pre></div>
</div>
<p>_ The literal string_can be enclosed in single or double quotes. The literal string can contain the following C- style escape strings: <code class="docutils literal notranslate"><span class="pre">\a</span></code> (bell), <code class="docutils literal notranslate"><span class="pre">\B</span> </code>(backspace), <code class="docutils literal notranslate"><span class="pre">\f</span></code> (page change), <code class="docutils literal notranslate"><span class="pre">\n</span></code> (line change), <code class="docutils literal notranslate"><span class="pre">\r</span></code> (carriage return), <code class="docutils literal notranslate"><span class="pre">\t</span></code> (horizontal item tabulation), <code class="docutils literal notranslate"><span class="pre">\v</span></code> (vertical tabulation), <code class="docutils literal notranslate"><span class="pre">\</span> </code>(backslash), <code class="docutils literal notranslate"><span class="pre">\</span></code>(double quotation marks), and ```` (single quotation mark). A true line break followed by a backslash is equivalent to writing a line break in the string. The escape string <code class="docutils literal notranslate"><span class="pre">\z</span></code> ignores a series of blank characters after it, including line breaks; it is useful when you need to break multiple lines for a long string constant and want to keep indenting each new line.</p>
<p>Lua The string in can hold any 8-bit value, including 0 represented by <code class="docutils literal notranslate"><span class="pre">\0.</span> <span class="pre">In</span> <span class="pre">general,</span> <span class="pre">you</span> <span class="pre">can</span> <span class="pre">use</span> <span class="pre">the</span> <span class="pre">numeric</span> <span class="pre">value</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">character</span> <span class="pre">to</span> <span class="pre">represent</span> <span class="pre">the</span> <span class="pre">character.</span> <span class="pre">The</span> <span class="pre">method</span> <span class="pre">is</span> <span class="pre">to</span> <span class="pre">use</span> <span class="pre">the</span> <span class="pre">escape</span> <span class="pre">string</span> </code>\x_XX_<code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">where_XX_must</span> <span class="pre">be</span> <span class="pre">a</span> <span class="pre">hexadecimal</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">exactly</span> <span class="pre">two</span> <span class="pre">characters.</span> <span class="pre">Or</span> <span class="pre">you</span> <span class="pre">can</span> <span class="pre">use</span> <span class="pre">the</span> <span class="pre">escape</span> <span class="pre">string</span> </code>_ddd_`, where_ddd_is one to three decimal digits. (Note that if the escape character happens to be followed by a number symbol, you must write three digits in the escape form。）</p>
<p>For Unicode characters encoded in UTF-8, you can use the escape character <code class="docutils literal notranslate"><span class="pre">\u{_XXX_}</span></code> (there must be a pair of curly braces), where_XXX_is the hexadecimal character number.</p>
<p>Literal strings can also be defined in a way that_long brackets_are enclosed. We define the_n_equal sign inserted between two positive square brackets as the_n_level open long bracket_. That is to say, level 0 long brackets are written as <code class="docutils literal notranslate"><span class="pre">[[</span></code>, level 1 long brackets are written as <code class="docutils literal notranslate"><span class="pre">[=[</span></code>, and so on. _Closed long brackets_are similarly defined; For example, the long brackets for level 4 inversion are written <code class="docutils literal notranslate"><span class="pre">]====]</span></code>. A_long literal string_can begin with an open-length parenthesis of any level and end with a closed-length parenthesis of the first encountered sibling. A string described this way can contain anything, except, of course, for a specific level of backparentheses. The entire lexical analysis process will not be restricted by branches, will not handle any escape characters, and will ignore any long parentheses at different levels. Any form of line feed string encountered (carriage return, line feed, carriage return plus line feed, line feed plus carriage return) will be converted to a single line feed.</p>
<p>Each byte in the literal string that is not affected by the above rules is presented as itself. However, Lua uses text mode to open source file parsing, and some systems’ file manipulation functions may have problems with the handling of certain control characters. Therefore, for non-text data, it is safer to enclose it in quotation marks and explicitly express it according to escape character rules.</p>
<p>For convenience, when a long parenthesis is followed by a line break, the line break is not placed in the string. For example, suppose a system uses ASCII code (where ‘’a’’ is encoded as 97, line feed is encoded as 10, and ‘’1’’ is encoded as 49 ), and the following five ways describe exactly the same string.：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> a = 'alo\\n123"'
 a = "alo\\n123\\""
 a = '\\97lo\\10\\04923"'
 a = \[\[alo
 123"\]\]
 a = \[==\[
 alo
 123"\]==\]
</pre></div>
</div>
<p>_ The numeric constant_(or_numeric quantity_) may consist of an optional decimal part and an optional base-ten exponential part, which is marked with the character <code class="docutils literal notranslate"><span class="pre">e`</span> <span class="pre">or</span> </code>E. Lua also accepts hexadecimal constants starting with <code class="docutils literal notranslate"><span class="pre">0x</span></code> or `0X. Hexadecimal constants also accept the form of decimal plus exponential parts. The exponential part is based on two and is marked with the character <code class="docutils literal notranslate"><span class="pre">p</span></code> or ``P. A numeric constant is considered a floating-point number when it contains a decimal or exponential part; otherwise it is considered an integer. Here are some examples of legal integer constants：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> 3   345   0xff   0xBEBADA
</pre></div>
</div>
<p>The following are legal floating-point constants：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> 3.0     3.1416     314.16e-2     0.31416E1     34e1
 0x0.1E  0xA23p-4   0X1.921FB54442D18P+1
</pre></div>
</div>
<p>A portion beginning with a double-bar (<code class="docutils literal notranslate"><span class="pre">--</span></code>) that appears anywhere outside the string is_comment_. If <code class="docutils literal notranslate"><span class="pre">--</span></code> is not followed by an open brace, the comment is_short comment_, and the comment ends at the end of the current line. Otherwise, this is a_long comment_, and the comment area is maintained until the corresponding closed bracket. Long comments are often used to temporarily mask out large sections of code.</p>
</section>
<section id="variable">
<h3>3.2 – Variable<a class="headerlink" href="#variable" title="Permalink to this headline">#</a></h3>
<p>Variables are where values are stored. There are three types of variables in Lua: global variables, local variables, and fields of tables.</p>
<p>A single name can refer to a global variable or a local variable (or a formal parameter of a function, which is a special form of local variable.）。</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>var ::= Name
</pre></div>
</div>
<p>The name refers to the identifier defined in <span class="xref myst">§ 3.1</span>.</p>
<p>All variable names that are not explicitly declared as local (see <span class="xref myst">§ 3.3.7</span>) are treated as global variables. Local variables have their scope: local variables can be used freely by functions defined in their scope (see. <span class="xref myst">§3.5</span>）。</p>
<p>Before the first assignment of a variable, the value of the variable is <strong>nil</strong>。</p>
<p>Square brackets are used to index tables：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>var ::= prefixexp ‘**\[**’ exp ‘**\]**’
</pre></div>
</div>
<p>The meaning of access to global variables and the fields of the table can be changed through the meta-table. Indexing a variable<code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">[I]</span> </code>is equivalent to calling gettable_event(t, I)`. (See <span class="xref myst">§ 2.4</span> for a complete description of the gettable_event function. This function is not defined in lua and cannot be called in lua. Here we mention it only for convenience to illustrate the problem.。）</p>
<p><code class="docutils literal notranslate"><span class="pre">var.Name</span></code> This syntax is just a syntactic sugar used to represent <code class="docutils literal notranslate"><span class="pre">var["Name"]</span></code>：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>var ::= prefixexp ‘**.**’ Name
</pre></div>
</div>
<p>The operation on the global variable <code class="docutils literal notranslate"><span class="pre">x</span></code> is equivalent to the operation <code class="docutils literal notranslate"><span class="pre">_ENV.x</span></code>. Because of the way the code block is compiled, <code class="docutils literal notranslate"><span class="pre">_ENV</span></code> can never be a global name (cf. <span class="xref myst">§2.2</span>）。</p>
</section>
<section id="statement">
<h3>3.3 – Statement<a class="headerlink" href="#statement" title="Permalink to this headline">#</a></h3>
<p>Lua All common forms of statements similar to Pascal or C are supported. This collection includes assignments, control structures, function calls, and variable declarations.</p>
<section id="statement-block">
<h4>3.3.1 – statement block<a class="headerlink" href="#statement-block" title="Permalink to this headline">#</a></h4>
<p>A statement block is a sequence of statements that are executed in order：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>block ::= {stat}
</pre></div>
</div>
<p>Lua Support_empty statement_, you can use semicolon to divide the statement, you can also start a statement block with semicolon, or write two semicolon in succession：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>stat ::= ‘**;**’
</pre></div>
</div>
<p>Both function calls and assignment statements may be headed with a parenthesis, which may make Lua’s syntax ambiguous. Let’s take a look at the following code snippet：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> a = b + c
 (print or io.write)('done')
</pre></div>
</div>
<p>Grammatically, there are two possible ways of interpretation：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> a = b + c(print or io.write)('done')

 a = b + c; (print or io.write)('done')
</pre></div>
</div>
<p>The current parser always uses the first structure to parse, and it will see the open parenthesis as the beginning of the parameter passing of the function call. To avoid this ambiguity, it is a good habit to put a semicolon in front of a statement when it begins with a parenthesis.：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> ;(print or io.write)('done')
</pre></div>
</div>
<p>A statement block can be explicitly delimited as a single statement：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>stat ::= **do** block **end**
</pre></div>
</div>
<p>Explicit delimitation of a block is often used to control the scope of an internal variable declaration. Sometimes, explicit delimitation is also used to insert return in the middle of a statement block (see. <span class="xref myst">§3.3.4</span>）。</p>
</section>
<section id="code-block">
<h4>3.3.2 – Code Block<a class="headerlink" href="#code-block" title="Permalink to this headline">#</a></h4>
<p>Lua A compilation unit of is called a_code block_. In terms of syntactic composition, a code block is a statement block.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>chunk ::= block
</pre></div>
</div>
<p>Lua Treat a block of code as an anonymous function with indefinite parameters (see <span class="xref myst">§ 3.4.11</span>). In this way, local variables can be defined within the code block, which can receive parameters and return several values. In addition, the anonymous function is compiled with an external local variable <code class="docutils literal notranslate"><span class="pre">_ENV</span></code> bound to its scope (see <span class="xref myst">§ 2.2</span>). The function always has <code class="docutils literal notranslate"><span class="pre">_ENV</span></code> as its only upper value, even if the function does not use this variable, it still exists.</p>
<p>The code block can be saved in a file or as a string inside the host program. To execute a block of code, first have Lua load it, pre-compile the code in the block into instructions in the virtual machine, and then Lua uses the virtual machine interpreter to run the compiled code.</p>
<p>A block of code can be pre-compiled into binary form; see the program <code class="docutils literal notranslate"><span class="pre">luac</span></code> and the function <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">string.dump</span></code></span> for more details. Programs expressed in source code and compiled forms can be freely replaced; Lua will automatically detect the file format for corresponding processing (see <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">load</span></code></span>）。</p>
</section>
<section id="assignment">
<h4>3.3.3 – Assignment<a class="headerlink" href="#assignment" title="Permalink to this headline">#</a></h4>
<p>Lua Multiple assignments are allowed. Thus, the syntactic definition of assignment is to put a list of variables to the left of the equal sign and a list of expressions to the right of the equal sign. The elements in both sides of the list are separated by commas.：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>stat ::= varlist ‘**\=**’ explist
varlist ::= var {‘**,**’ var}
explist ::= exp {‘**,**’ exp}
</pre></div>
</div>
<p>Expressions are discussed in <span class="xref myst">§ 3.4</span>.</p>
<p>Before the assignment operation, the value list will be adjusted to the number of variables on the left. If there are more values than needed, the extra values are thrown away. If the number of values is not enough, it will be expanded as many <strong>nil</strong> as needed. If the expression list ends with a function call, all values returned by the function will be placed in the value list before the adjustment operation (unless the function call is enclosed in parentheses; see <span class="xref myst">§3.4</span>）。</p>
<p>The assignment statement first allows all expressions to complete the operation, and then the assignment operation. Therefore, the following code</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> i = 3
 i, a\[i\] = i+1, 20
</pre></div>
</div>
<p>will set <code class="docutils literal notranslate"><span class="pre">a[3]</span></code>to 20 without affecting <code class="docutils literal notranslate"><span class="pre">a[4]</span></code>. This is because the <code class="docutils literal notranslate"><span class="pre">I</span></code> in <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">[I]</span> </code>is calculated before it is assigned to 4 (it was 3 at the time). Simply put, such a line</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> x, y = y, x
</pre></div>
</div>
<p>would swap the values of <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>, and</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> x, y, z = y, z, x
</pre></div>
</div>
<p>The values of <code class="docutils literal notranslate"><span class="pre">x</span></code>,<code class="docutils literal notranslate"><span class="pre">y</span></code>,<code class="docutils literal notranslate"><span class="pre">z</span></code> will be rotated.</p>
<p>The meaning of assignment operations to global variables and fields of the table can be changed by the meta-table. Assigning a variable index such as<code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">[I]</span> <span class="pre">=</span> <span class="pre">val</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">settable_event(t,</span> <span class="pre">I,</span> <span class="pre">val)</span></code>. (For a detailed description of the function <code class="docutils literal notranslate"><span class="pre">settable_event,</span> </code>see <span class="xref myst">§ 2.4</span>. This function is not defined in Lua and cannot be called. We list them here for ease of explanation only.。）</p>
<p>The assignment to the global variable <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">val</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">_ENV.x</span> <span class="pre">=</span> <span class="pre">val</span></code> (cf. <span class="xref myst">§2.2</span>）。</p>
</section>
<section id="control-structure">
<h4>3.3.4 – control structure<a class="headerlink" href="#control-structure" title="Permalink to this headline">#</a></h4>
<p><strong>if</strong>, <strong>while</strong>, and <strong>repeat</strong> These control structures conform to the usual meaning, and there is a similar syntax：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>stat ::= **while** exp **do** block **end**
stat ::= **repeat** block **until** exp
stat ::= **if** exp **then** block {**elseif** exp **then** block} \[**else** block\] **end**
</pre></div>
</div>
<p>Lua There is also a <strong>for</strong> statement, which has two forms (see <span class="xref myst">§3.3.5</span>）。</p>
<p>A conditional expression in a control structure can return any value. <strong>false</strong>and<strong>nil</strong> are both considered false. All values other than <strong>nil</strong>and<strong>false</strong> are considered true (in particular, the number 0 and the empty string are also considered true.）。</p>
<p>In the <strong>repeat</strong>-<strong>until</strong> loop, the end point of the inner statement block is not at the <strong>until</strong> keyword, which also includes the conditional expression that follows it. Therefore, local variables defined in the internal statement block of the loop can be used in conditional expressions.</p>
<p><strong>goto</strong> statement transfers the control point of the program to a label. For syntactic reasons, labels in Lua are also considered statements：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>stat ::= **goto** Name
stat ::= label
label ::= ‘**::**’ Name ‘**::**’
</pre></div>
</div>
<p>The label is visible to the entire statement block in which it is defined, except in the case where a label with the same name is defined in an embedded function and in an embedded statement block. As long as goto does not enter the scope of a new local variable, it can jump to any visible label.</p>
<p>Labels and statements without content are called_empty statements_and they do nothing.</p>
<p><strong>break</strong> Is used to end a <strong>while</strong>, <strong>repeat</strong>, or <strong>for</strong> loop, which jumps to the next statement outside the loop to run：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>stat ::= **break**
</pre></div>
</div>
<p><strong>break</strong> Jump out of the innermost loop.</p>
<p><strong>return</strong> is used to return a value from a function or block of code (which is actually a function). A function can return more than one value, so the syntax for <strong>return</strong> is</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>stat ::= **return** \[explist\] \[‘**;**’\]
</pre></div>
</div>
<p><strong>return</strong> Can only be written in the last sentence of a statement block. If you really need to return from the middle of the statement block, you can use an explicit definition of an inner statement block, generally written <code class="docutils literal notranslate"><span class="pre">do</span> <span class="pre">return</span> <span class="pre">end</span> </code>. It can be written like this because now <strong>return</strong> is the last sentence of the (internal) statement block.</p>
</section>
<section id="for-statement">
<h4>3.3.5 – For Statement<a class="headerlink" href="#for-statement" title="Permalink to this headline">#</a></h4>
<p><strong>for</strong> There are two forms: one is digital form and the other is universal form.</p>
<p>The numerical form of the <strong>for</strong> loop, which continuously runs the internal code block through a mathematical operation. Here is its syntax：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>stat ::= **for** Name ‘**\=**’ exp ‘**,**’ exp \[‘**,**’ exp\] **do** block **end**
</pre></div>
</div>
<p><em>block</em> <em>name_will be used as a loop variable. Starting from the first_exp_until the value of the second_exp</em>, the step size is the third_exp_. More specifically, a <strong>for</strong> loop looks like this</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> for v = _e1_, _e2_, _e3_ do _block_ end
</pre></div>
</div>
<p>This is equivalent to code：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> do
   local _var_, _limit_, _step_ = tonumber(_e1_), tonumber(_e2_), tonumber(_e3_)
   if not (_var_ and _limit_ and _step_) then error() end
   _var_ = _var_ - _step_
   while true do
     _var_ = _var_ + _step_
     if (_step_ &gt;= 0 and _var_ &gt; _limit_) or (_step_ &lt; 0 and _var_ &lt; _limit_) then
       break
     end
     local v = _var_
     _block_
   end
 end
</pre></div>
</div>
<p>Note these points below.：</p>
<ul class="simple">
<li><p>All three control expressions are evaluated only once, before the loop begins. The result of these expressions must be a number.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_var_</span></code>，<code class="docutils literal notranslate"><span class="pre">_limit_</span></code>，and <code class="docutils literal notranslate"><span class="pre">_step_</span></code> are invisible variables. The names given here are only for convenience of explanation.</p></li>
<li><p>If the third expression (step) is not given, the step is set 1 。</p></li>
<li><p>You can use <strong>break</strong>and<strong>goto</strong> to exit the <strong>for</strong> loop.</p></li>
<li><p>The loop variable <code class="docutils literal notranslate"><span class="pre">v</span></code> is a local variable inside a loop; if you need to use this value at the end of the loop, assign it to another variable before exiting the loop.</p></li>
</ul>
<p>The generic form of <strong>for</strong> works through a function called_iterator. With each iteration, the iterator function is called to produce a new value, and when this value is <strong>nil</strong>, the loop stops. The syntax of the generic form of a <strong>for</strong> loop is as follows：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>stat ::= **for** namelist **in** explist **do** block **end**
namelist ::= Name {‘**,**’ Name}
</pre></div>
</div>
<p>Such a <strong>for</strong> statement</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> for _var\_1_, ···, _var\_n_ in _explist_ do _block_ end
</pre></div>
</div>
<p>It is equivalent to such a piece of code：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> do
   local _f_, _s_, _var_ = _explist_
   while true do
     local _var\_1_, ···, _var\_n_ = _f_(_s_, _var_)
     if _var\_1_ == nil then break end
     _var_ = _var\_1_
     _block_
   end
 end
</pre></div>
</div>
<p>Note the following points：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_explist_</span></code> It will only be counted once. It returns three values, an_iterator_function, an_state_, and the initial value of the_iterator._。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_f_</span></code>， <code class="docutils literal notranslate"><span class="pre">_s_</span></code>，Variables with <code class="docutils literal notranslate"><span class="pre">_var_</span></code> are invisible. The names given here are just for the convenience of explanation.</p></li>
<li><p>You can use <strong>break</strong> to get out of the <strong>for</strong> loop.</p></li>
<li><p>The loop variable <code class="docutils literal notranslate"><span class="pre">_var_</span> <span class="pre">I_</span></code> is local to the loop; you can`t use it after the loop ends. If you need to keep these values, assign them to other variables before the loop breaks out or ends.</p></li>
</ul>
</section>
<section id="function-call-statement">
<h4>3.3.6 – function call statement<a class="headerlink" href="#function-call-statement" title="Permalink to this headline">#</a></h4>
<p>To allow the use of function side effects, a function call can be executed as a statement：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>stat ::= functioncall
</pre></div>
</div>
<p>In this case, all return values are discarded. Function calls are explained in <span class="xref myst">§ 3.4.10</span>.</p>
</section>
<section id="local-declaration">
<h4>3.3.7 – Local declaration<a class="headerlink" href="#local-declaration" title="Permalink to this headline">#</a></h4>
<p>Local variables can be declared anywhere in the statement block. A declaration can contain an initialization assignment operation：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>stat ::= **local** namelist \[‘**\=**’ explist\]
</pre></div>
</div>
<p>The syntax of the initial assignment operation is the same as that of the assignment operation, if any (see <span class="xref myst">§ 3.3.3</span> ). If there is no initialization value, all variables are initialized <strong>nil</strong>。</p>
<p>A code block is also a block of statements (see <span class="xref myst">§ 3.3.2</span>), so local variables can be placed outside of those explicitly noted in the code block.</p>
<p>The visibility rules for local variables are explained in <span class="xref myst">§ 3.5</span>.</p>
</section>
</section>
<section id="expression">
<h3>3.4 – Expression<a class="headerlink" href="#expression" title="Permalink to this headline">#</a></h3>
<p>Lua There are these basic expressions in：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>exp ::= prefixexp
exp ::= **nil** | **false** | **true**
exp ::= Numeral
exp ::= LiteralString
exp ::= functiondef
exp ::= tableconstructor
exp ::= ‘**...**’
exp ::= exp binop exp
exp ::= unop exp
prefixexp ::= var | functioncall | ‘**(**’ exp ‘**)**’
</pre></div>
</div>
<p>Numbers and literal strings are explained in <span class="xref myst">§ 3.1</span>; variables are explained in <span class="xref myst">§ 3.2</span>; function definitions are explained in <span class="xref myst">§ 3.4.11</span>; function calls are explained in <span class="xref myst">§ 3.4.10</span>; and table construction is explained in <span class="xref myst">§ 3.4.9</span>. The expression for variable parameters is written in three points (‘’…’’), which can only be used directly in functions with variable parameters; these are explained in <span class="xref myst">§ 3.4.11</span>.</p>
<p>Binary operators include mathematical operation operators (see <span class="xref myst">§ 3.4.1</span>), bit operators (see <span class="xref myst">§ 3.4.2</span>), comparison operators (see <span class="xref myst">§ 3.4.4</span>), logical operators (see <span class="xref myst">§ 3.4.5</span>), and concatenate operators (see <span class="xref myst">§ 3.4.6</span>). The unary operators include the minus sign (see <span class="xref myst">§ 3.4.1</span>), the bitwise NOT (see <span class="xref myst">§ 3.4.2</span>), the logical NOT (see <span class="xref myst">§ 3.4.5</span>), and the take-length operator (see <span class="xref myst">§3.4.7</span>）。</p>
<p>Both function calls and variable argument expressions can be placed in multiple return values. If a function call is treated as a statement (see <span class="xref myst">§ 3.3.6</span>), its return value list is adjusted to zero elements, I .e. all return values are discarded. If the expression is used on the last (or only) element of the expression list, no adjustment is made (unless the expression is enclosed in parentheses). In other cases, Lua will adjust the result to an element and place it in the expression list, I .e. keep the first result and ignore all the values after it, or fill in the single when there is no result. <strong>nil</strong>。</p>
<p>Here are some examples：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> f()                -- Adjust to 0 results
 g(f(), x)          -- f() will be adjusted to a result
 g(x, f())          -- g Receive all results returned by x and f()
 a,b,c = f(), x     -- f() were adjusted to 1 result (c received nil）
 a,b = ...          -- a Received the first argument of the list of variadic arguments，
                    -- b Receive the second parameter (if the variable parameter list.
                    -- Without actual parameters, both a and B receive nil）

 a,b,c = x, f()     -- f() Adjusted for 2 results
 a,b,c = f()        -- f() Adjusted for 3 results
 return f()         -- Returns all returned results of f()
 return ...         -- Returns all parameters received from the variable parameter list parameters
 return x,y,f()     -- Returns all values returned by x, y, and f()
 {f()}              -- Create a list with all the return values of f()
 {...}              -- Create a list with all the values in the variable parameter
 {f(), nil}         -- f() be adjusted to a result
</pre></div>
</div>
<p>An expression enclosed in parentheses is always treated as a value. So, <code class="docutils literal notranslate"><span class="pre">(f(x,y,z))</span></code> even though <code class="docutils literal notranslate"><span class="pre">f</span></code> returns multiple values, the expression will always be a single value. The value of (<code class="docutils literal notranslate"><span class="pre">(f(x,y,z))</span></code> is the first value returned by <code class="docutils literal notranslate"><span class="pre">f.</span> <span class="pre">If</span> </code>f` does not return a value, then its value is <strong>nil</strong> 。）</p>
<section id="mathematical-operation-operator">
<h4>3.4.1 – Mathematical Operation Operator<a class="headerlink" href="#mathematical-operation-operator" title="Permalink to this headline">#</a></h4>
<p>Lua The following mathematical operators are supported：</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">+</span></code>:</strong> Addition</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">-</span></code>:</strong> subtraction</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">*</span></code>:</strong> Multiplication</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">/</span></code>:</strong> floating point division</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">//</span></code>:</strong> division down</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">%</span></code>:</strong> Modulus</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">^</span></code>:</strong> power</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">-</span></code>:</strong> take negative</p></li>
</ul>
<p>With the exception of power and floating-point division operations, mathematical operations work as follows: If both operands are integers, the operation operates as an integer and the result will also be an integer. Otherwise, when both operands are numbers or strings that can be converted to numbers (see <span class="xref myst">§ 3.4.3</span>), the operands are converted to two floating-point numbers, and the operation is performed according to the usual floating-point rules (generally following the IEEE 754 standard), and the result is also a floating-point number.</p>
<p>The power and floating-point division (<code class="docutils literal notranslate"><span class="pre">/</span></code>) always converts the operand to a floating-point number, and the result is always a floating-point number. The power uses the ISO C function <code class="docutils literal notranslate"><span class="pre">pow</span></code>, so it can also accept non-integer exponents.</p>
<p>Division (<code class="docutils literal notranslate"><span class="pre">//</span></code>) refers to division once and rounding the quotient to the side close to negative infinity, I .e. division of the operand floor 。</p>
<p>The modulus is defined as the remainder of the division, and its quotient is rounded to the side close to negative infinity (the division rounded down）。</p>
<p>For the overflow problem of integer mathematical operations, the strategy adopted by these operations is to follow the usual_wrap_rule for mathematical operations with 2 as the complement. (In other words, they return the number after the mathematical result of their operation is modulo_264_。）</p>
</section>
<section id="bit-operator">
<h4>3.4.2 – bit operator<a class="headerlink" href="#bit-operator" title="Permalink to this headline">#</a></h4>
<p>Lua The following bit operators are supported：</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">&amp;</span></code>:</strong> Bits and</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">|</span></code>:</strong> Bits or</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">~</span></code>:</strong> bitwise exclusive or</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code>:</strong> Move Right</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code>:</strong> Move left</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">~</span></code>:</strong> bitwise non</p></li>
</ul>
<p>All bit operations convert the operand to an integer (see <span class="xref myst">§ 3.4.3</span>) and then operate bitwise, the result of which is an integer.</p>
<p>For both right and left shifts, the gaps are filled with zeros. If the number of bits moved is negative, it will be shifted in the opposite direction; If the absolute value of the number of bits moved is greater than or equal to the number of bits of the integer itself, the result is zero (all bits are moved out）。</p>
</section>
<section id="forced-conversion">
<h4>3.4.3 – Forced Conversion<a class="headerlink" href="#forced-conversion" title="Permalink to this headline">#</a></h4>
<p>Lua The internal representations of some types and values do some mathematical transformations at run time. Bit operations always convert floating-point operands to integers. Exponentiation and floating-point division always convert integers to floating-point numbers. Other mathematical operations convert integers to floating-point numbers for mixed operands (integers and floating-point numbers); this is known as the usual rule_. The C API also converts integers to floats and floats to integers on demand. In addition, string concatenation operations can also accept numbers as parameters in addition to strings.</p>
<p>Lua also converts the string to a number when the operation requires a number.</p>
<p>When converting an integer to a floating-point number, if the integer value happens to be represented as a floating-point number, then take that floating-point number. Otherwise, the conversion takes the nearest larger or smaller value to represent the number. This conversion will not fail.</p>
<p>The process of converting a floating-point number to an integer checks whether the floating-point number can be accurately expressed as an integer (I. e., the floating-point number is an integer value and is within the range that the integer can express). If you can, the result is that number, otherwise the conversion fails.</p>
<p>The conversion process from a string to a number follows the following process: First, the syntax is analyzed according to the rules of the Lua lexer to convert to the corresponding integer or floating point number. (Strings can have leading or trailing spaces and a symbol.) The resulting number is then converted to the desired type (floating point or integer）。</p>
<p>Converts a number to a string using a non-specified human-readable format. To fully control the number-to-string conversion process, you can use the <code class="docutils literal notranslate"><span class="pre">format</span></code> function in the string library (see <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">string.format</span></code></span>）。</p>
</section>
<section id="comparison-operators">
<h4>3.4.4 – Comparison Operators<a class="headerlink" href="#comparison-operators" title="Permalink to this headline">#</a></h4>
<p>Lua The following comparison operators are supported：</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">==</span></code>:</strong> Equal</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">~=</span></code>:</strong> not equal</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">&lt;</span></code>:</strong> Less</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">&gt;</span></code>:</strong> Greater</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>:</strong> Less than or equal</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>:</strong> Greater than or equal</p></li>
</ul>
<p>The result of these operations is either <strong>false</strong> or <strong>true</strong>。</p>
<p>The equals operation (<code class="docutils literal notranslate"><span class="pre">=</span> <span class="pre">=</span></code>) compares the type of the operands first. If the types are different, the result is **false * *. Otherwise, continue to compare values. Strings are compared in the usual way. Numbers follow the rules of binary operations: if both operands are integers, they are compared as integers; otherwise, they are first converted to floating-point numbers and then compared.</p>
<p>Tables, user data, and threads are all compared by reference: they are considered equal only if they refer to the same object. Every time you create a new object (a table, user data, or a thread), the new object must be different from the existing and existing object. Closure of the same reference must be equal. Any perceptible differences (different behaviors, different definitions) must be unequal.</p>
<p>You can change the way Lua compares table and user data by using the “eq” meta-method (see <span class="xref myst">§ 2.4</span>).</p>
<p>Equals operations do not convert strings to numbers and vice versa. That is, <code class="docutils literal notranslate"><span class="pre">"0"</span> <span class="pre">=</span> <span class="pre">=</span> <span class="pre">0</span></code> results in <strong>false</strong>, and<code class="docutils literal notranslate"><span class="pre">t[0]</span></code>and<code class="docutils literal notranslate"><span class="pre">t["0"]</span></code> refer to different items in the table.</p>
<p><code class="docutils literal notranslate"><span class="pre">~=</span></code> The operation is completely equivalent to the inverse of the (<code class="docutils literal notranslate"><span class="pre">=</span> <span class="pre">=</span></code>) operation.</p>
<p>The size comparison operation is performed in the following manner. If the arguments are all numbers, they proceed in the regular of a binary operation. Otherwise, if both parameters are strings, their values are compared by the current locale. Then, Lua tries to call the “lt” or “le” meta-method (see <span class="xref myst">§ 2.4</span>). The comparison of <code class="docutils literal notranslate"><span class="pre">a&gt;</span> <span class="pre">B</span> </code>is translated as<code class="docutils literal notranslate"> <span class="pre">B</span> <span class="pre">&lt;a</span></code> and <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&gt;=</span> <span class="pre">B</span> </code>is translated <code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">&lt;=</span> <span class="pre">a</span></code>。</p>
</section>
<section id="logical-operator">
<h4>3.4.5 – logical operator<a class="headerlink" href="#logical-operator" title="Permalink to this headline">#</a></h4>
<p>Lua The logical operators in are <strong>and</strong>, <strong>or</strong>, and <strong>not * *. As with control structures (see <span class="xref myst">§ 3.3.4</span>), all logical operators treat <strong>false</strong>and</strong>nil** as false, and everything else as true.</p>
<p>The <strong>not</strong> operation always returns one of <strong>false</strong>or<strong>true. with the <strong>and</strong> operator returns the first argument when the first argument is <strong>false</strong>or</strong>nil**; otherwise, <strong>and</strong> returns the second argument. or <strong>or</strong> operator returns the first parameter when the first parameter is neither <strong>nil</strong>nor<strong>false</strong>, otherwise returns the second parameter. <strong>and</strong>and<strong>or</strong> both follow the short-circuit rule; that is, the second operand is evaluated only when needed. Here are some examples：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> 10 or 20            --&gt; 10
 10 or error()       --&gt; 10
 nil or "a"          --&gt; "a"
 nil and 10          --&gt; nil
 false and error()   --&gt; false
 false and nil       --&gt; false
 false or nil        --&gt; nil
 10 and 20           --&gt; 20
</pre></div>
</div>
<p>（In this manual, <code class="docutils literal notranslate"><span class="pre">--&gt;</span></code> refers to the result of the previous expression。）</p>
</section>
<section id="string-concatenation">
<h4>3.4.6 – String concatenation<a class="headerlink" href="#string-concatenation" title="Permalink to this headline">#</a></h4>
<p>Lua The join operator in the string is written as two dots (‘’..’’). If both operands are strings or numbers, the concatenation operation will convert them to strings according to the rules mentioned in <span class="xref myst">§ 3.4.3</span>. Otherwise, the meta-method ‘__concat’ is called (cf. <span class="xref myst">§2.4</span>）。</p>
</section>
<section id="take-length-operator">
<h4>3.4.7 – take length operator<a class="headerlink" href="#take-length-operator" title="Permalink to this headline">#</a></h4>
<p>Take the length operator to write the unary prefix <code class="docutils literal notranslate"><span class="pre">#</span></code>. The length of a string is its number of bytes (that is, the length of the string calculated in one character by one byte.）。</p>
<p>The <code class="docutils literal notranslate"><span class="pre">__len</span></code> meta-method (see <span class="xref myst">§ 2.4</span>) can be used to modify the behavior of the length operation on any value outside of the string type.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">__len</span></code> meta-method is not given, the length of table <code class="docutils literal notranslate"><span class="pre">t</span></code> is only defined when the table is a_sequence. A sequence refers to a table with a positive set of keys equal to_{1 .. n }_, where_n_is a non-negative integer. In this case,_n_is the length of the table. Note that such a table</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> {10, 20, nil, 40}
</pre></div>
</div>
<p>is not a sequence because it has bond <code class="docutils literal notranslate"><span class="pre">4</span></code> but no bond <code class="docutils literal notranslate"><span class="pre">3</span> </code>. (Therefore, the set of positive integer keys for the table is not equal to the_{1 .. n}<em>set, so there is no_n</em>.) Note that whether a table is a sequence has nothing to do with its non-numeric keys.</p>
</section>
<section id="priority">
<h4>3.4.8 – Priority<a class="headerlink" href="#priority" title="Permalink to this headline">#</a></h4>
<p>Lua The priorities of the operators in are written in the following table, sorted from low to high priority.：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> or
 and
 &lt;     &gt;     &lt;=    &gt;=    ~=    ==
 |
 ~
 &amp;
 &lt;&lt;    &gt;&gt;
 ..
 +     -
 \*     /     //    %
 unary operators (not   #     -     ~)
 ^
</pre></div>
</div>
<p>Usually, you can use parentheses to change the order of operations. The join operator (<code class="docutils literal notranslate"><span class="pre">..</span></code>) and the power operation (<code class="docutils literal notranslate"><span class="pre">^</span></code>) are right-to-left. All other operations are from left to right.</p>
</section>
<section id="table-construction">
<h4>3.4.9 – Table Construction<a class="headerlink" href="#table-construction" title="Permalink to this headline">#</a></h4>
<p>A table constructor is an expression that constructs a table. Each time the constructor is executed, a new table is constructed. Constructors can be used to construct an empty table, or they can be used to construct a table and initialize some of its fields. The general constructor syntax is as follows</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>tableconstructor ::= ‘**{**’ \[fieldlist\] ‘**}**’
fieldlist ::= field {fieldsep field} \[fieldsep\]
field ::= ‘**\[**’ exp ‘**\]**’ ‘**\=**’ exp | Name ‘**\=**’ exp | exp
fieldsep ::= ‘**,**’ | ‘**;**’
</pre></div>
</div>
<p>Each field of the shape <code class="docutils literal notranslate"><span class="pre">[exp1]</span> <span class="pre">=</span> <span class="pre">exp2</span></code> adds a new item to the table with the key <code class="docutils literal notranslate"><span class="pre">exp1</span></code> and the value <code class="docutils literal notranslate"><span class="pre">exp2</span></code>. A field of the shape <code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">=</span> <span class="pre">exp</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">["name"]</span> <span class="pre">=</span> <span class="pre">exp</span></code>. Finally, a field of the shape <code class="docutils literal notranslate"><span class="pre">exp</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">[I]</span> <span class="pre">=</span> <span class="pre">exp</span></code>, where<code class="docutils literal notranslate"><span class="pre">I</span></code>is a growing number starting at 1. Other fields in this format do not break their notation. Take an example：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> a = { \[f(1)\] = g; "x", "y"; x = 1, f(x), \[30\] = 23; 45 }
</pre></div>
</div>
<p>equivalent</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> do
   local t = {}
   t\[f(1)\] = g
   t\[1\] = "x"         -- 1st exp
   t\[2\] = "y"         -- 2nd exp
   t.x = 1            -- t\["x"\] = 1
   t\[3\] = f(x)        -- 3rd exp
   t\[30\] = 23
   t\[4\] = 45          -- 4th exp
   a = t
 end
</pre></div>
</div>
<p>The order of assignments in the constructor is undefined. (The order problem will only affect the situation when those keys are repeated.。）</p>
<p>If the last field in the form is in the form of <code class="docutils literal notranslate"><span class="pre">exp</span></code> and its expression is a function call or a variable parameter, then all the return values of this expression will go into the list in turn (see <span class="xref myst">§3.4.10</span>）。</p>
<p>The initialization domain table can have one more separator at the end, so that the design can be easily generated by the machine.</p>
</section>
<section id="function-call">
<h4>3.4.10 – function call<a class="headerlink" href="#function-call" title="Permalink to this headline">#</a></h4>
<p>Lua The syntax for the function call in is as follows：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>functioncall ::= prefixexp args
</pre></div>
</div>
<p>In the first step of a function call, prefixexp and args are evaluated first. If the type of the prefixexp value is_function_, then the function is called with the given arguments. Otherwise the prefixexp meta-method “call” is called, the first parameter is the prefixexp value, followed by the original call parameter (cf. <span class="xref myst">§2.4</span>）。</p>
<p>such a form</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>functioncall ::= prefixexp ‘**:**’ Name args
</pre></div>
</div>
<p>Can be used to call a “method”. This is a syntactic sugar supported by Lua. Like <code class="docutils literal notranslate"><span class="pre">v:name(args)</span></code>, it is interpreted as <code class="docutils literal notranslate"><span class="pre">v.name(v,args)</span></code>, where <code class="docutils literal notranslate"><span class="pre">v</span></code> is evaluated only once.</p>
<p>The syntax of the parameter is as follows：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>args ::= ‘**(**’ \[explist\] ‘**)**’
args ::= tableconstructor
args ::= LiteralString
</pre></div>
</div>
<p>All argument expressions are evaluated before the function call. The call form <code class="docutils literal notranslate"><span class="pre">f{fields}</span></code>is a syntactic sugar for <code class="docutils literal notranslate"><span class="pre">f({fields})</span></code>; here the argument list is a newly created list. The form <code class="docutils literal notranslate"><span class="pre">f</span></code><em>string</em>``(or <code class="docutils literal notranslate"><span class="pre">f"_string_"</span></code>or <code class="docutils literal notranslate"><span class="pre">f[[_string_]]</span></code>) is also syntactic sugar for <code class="docutils literal notranslate"><span class="pre">f(</span></code><em>string</em><code class="docutils literal notranslate"><span class="pre">)</span></code>; the argument list is a single string.</p>
<p><code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">_functioncall_</span></code> Such a call form will trigger a_tail call_. Lua implements_full tail call_(or_full tail recursion_): In a tail call, the called function reuses the stack items of the calling function. Thus, there is no limit to the number of layers of nested tail calls that a program executes. However, the tail call will remove any debug information for the function that called it. Note that tail calls only occur under a specific syntax, only if <strong>return</strong> has only a single function call as an argument; this syntax allows all results of the calling function to be returned in its entirety. Therefore, the following examples are not tail calls.：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> return (f(x))        -- The return value is adjusted to a
 return 2 \* f(x)
 return x, f(x)       -- Append several return values
 f(x); return         -- All return values are discarded
 return x or f(x)     -- The return value is adjusted to a
</pre></div>
</div>
</section>
<section id="function-definition">
<h4>3.4.11 – Function Definition<a class="headerlink" href="#function-definition" title="Permalink to this headline">#</a></h4>
<p>The syntax for a function definition is as follows：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>functiondef ::= **function** funcbody
funcbody ::= ‘**(**’ \[parlist\] ‘**)**’ block **end**
</pre></div>
</div>
<p>In addition, some syntactic sugar is defined to simplify the writing of function definitions.：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>stat ::= **function** funcname funcbody
stat ::= **local** **function** Name funcbody
funcname ::= Name {‘**.**’ Name} \[‘**:**’ Name\]
</pre></div>
</div>
<p>The statement</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> function f () _body_ end
</pre></div>
</div>
<p>be translated</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> f = function () _body_ end
</pre></div>
</div>
<p>The statement</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> function t.a.b.c.f () _body_ end
</pre></div>
</div>
<p>be translated</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> t.a.b.c.f = function () _body_ end
</pre></div>
</div>
<p>The statement</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> local function f () _body_ end
</pre></div>
</div>
<p>be translated</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> local f; f = function () _body_ end
</pre></div>
</div>
<p>instead</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> local f = function () _body_ end
</pre></div>
</div>
<p>（This difference only exists when the function body needs to reference <code class="docutils literal notranslate"><span class="pre">f</span></code>。）</p>
<p>A function definition is an executable expression whose result is a value of type_function. When Lua precompiles a code block, the code block acts as a function, and the entire function body is precompiled. So, whenever Lua executes a function definition, the function itself is_instantiated_(or_closed_). The instance (or_closure_) of this function is the final value of the expression.</p>
<p>A formal parameter is treated as some local variable that will be initialized by the value of the argument：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>parlist ::= namelist \[‘**,**’ ‘**...**’\] | ‘**...**’
</pre></div>
</div>
<p>When a function is called, if the function is not a_variable parameter function_, that is, three points (‘’…’’) are noted at the end of the formal parameter list, then the argument list is adjusted to the length of the formal parameter list. The variable-length parameter function does not adjust the argument list; instead, it will put all the extra arguments together and pass them to the function through the variable-length parameter expression, which is still written as three points. The value of this expression is a list of argument values, which looks like a function that can return multiple results. If a variable-length argument expression is used in another expression, or in the middle of another string of expressions, its return value is adjusted to a single value. If this expression is placed at the end of a series of expressions, no adjustment will be made (unless this last argument is enclosed in parentheses）。</p>
<p>Let’s make the following definition first, and then look at an example.：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> function f(a, b) end
 function g(a, b, ...) end
 function r() return 1,2,3 end
</pre></div>
</div>
<p>Let’s look at the mapping of real parameters to shape parameters and variable length parameters.：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> CALL            PARAMETERS

 f(3)             a=3, b=nil
 f(3, 4)          a=3, b=4
 f(3, 4, 5)       a=3, b=4
 f(r(), 10)       a=1, b=10
 f(r())           a=1, b=2

 g(3)             a=3, b=nil, ... --&gt;  (nothing)
 g(3, 4)          a=3, b=4,   ... --&gt;  (nothing)
 g(3, 4, 5, 8)    a=3, b=4,   ... --&gt;  5  8
 g(5, r())        a=5, b=1,   ... --&gt;  2  3
</pre></div>
</div>
<p>The result is returned by <strong>return</strong> (see <span class="xref myst">§ 3.3.4</span>). If you execute to the end of the function without encountering any <strong>return</strong> statements, the function will not return any results.</p>
<p>The limit on the number of values a function can return is system-dependent. This limit must be greater 1000 。</p>
<p>_ The colon_syntax can be used to define_method_, that is, a function can have an implicit parameter <code class="docutils literal notranslate"><span class="pre">self</span> </code>. Therefore, the following statement</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> function t.a.b.c:f (_params_) _body_ end
</pre></div>
</div>
<p>is the grammatical sugar of such a way of writing</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> t.a.b.c.f = function (self, _params_) _body_ end
</pre></div>
</div>
</section>
</section>
<section id="visibility-rules">
<h3>3.5 – Visibility Rules<a class="headerlink" href="#visibility-rules" title="Permalink to this headline">#</a></h3>
<p>Lua Language has lexical scope. The scope of variables begins with the first statement segment after they are declared and ends with the last non-empty statement of the innermost statement block containing the declaration. Look at these examples below：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> x = 10                -- global variable
 do                    -- New statement block
   local x = x         -- A new 'x' whose value is now 10
   print(x)            --&gt; 10
   x = x+1
   do                  -- Another statement block
     local x = x+1     -- yet another one 'x'
     print(x)          --&gt; 12
   end
   print(x)            --&gt; 11
 end
 print(x)              --&gt; 10 （Which one is the global one）
</pre></div>
</div>
<p>Note here that for statements like <code class="docutils literal notranslate"><span class="pre">local</span> <span class="pre">x</span> <span class="pre">=</span> <span class="pre">x</span></code>, the new <code class="docutils literal notranslate"><span class="pre">x</span></code> is being declared, but has not yet entered its scope, so the second <code class="docutils literal notranslate"><span class="pre">x</span></code> points to a variable from an outer layer.</p>
<p>Because there is such a lexical scoping rule, a local variable can be used freely by functions defined within its scope. When a local variable is used by the inner function, it is called the_upper value_, or_outer local variable by the inner function._。</p>
<p>Note that each execution of a <strong>local</strong> statement defines a new local variable. Look at such an example：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> a = {}
 local x = 20
 for i=1,10 do
   local y = 0
   a\[i\] = function () y=y+1; return x+y end
 end
</pre></div>
</div>
<p>This loop creates ten closures (this means ten instances of anonymous functions). Each of these closures uses a different <code class="docutils literal notranslate"><span class="pre">y</span></code> variable, and they share the same <code class="docutils literal notranslate"><span class="pre">x</span></code>。</p>
</section>
</section>
<section id="programming-interface">
<h2>4 – Programming Interface<a class="headerlink" href="#programming-interface" title="Permalink to this headline">#</a></h2>
<p>This section describes Lua<code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">C</span> <span class="pre">API,</span> <span class="pre">a</span> <span class="pre">set</span> <span class="pre">of</span> <span class="pre">C</span> <span class="pre">functions</span> <span class="pre">that</span> <span class="pre">the</span> <span class="pre">host</span> <span class="pre">program</span> <span class="pre">uses</span> <span class="pre">to</span> <span class="pre">communicate</span> <span class="pre">with</span> <span class="pre">Lua.</span> <span class="pre">All</span> <span class="pre">API</span> <span class="pre">functions</span> <span class="pre">are</span> <span class="pre">declared</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">header</span> <span class="pre">file</span> </code>lua.h` with their associated types and constants.</p>
<p>Although we are talking about “functions”, part of the simple API is provided in the form of macros. Unless otherwise noted, all of these macros use their arguments only once (except for the first argument, which must be the Lua state), so you don’t have to worry about the side effects of expanding these macros.</p>
<p>C All Lua API functions in the library do not check whether the parameters are compatible and valid. However, you can change this behavior by adding a macro switch `LUA_USE_APICHECK when compiling Lua.</p>
<section id="stack">
<h3>4.1 – Stack<a class="headerlink" href="#stack" title="Permalink to this headline">#</a></h3>
<p>Lua Use a_virtual stack_to pass values to and from C. Each element on the stack is a Lua value (<strong>nil</strong>, number, string, etc.）。</p>
<p>Whenever Lua calls C, the called function gets a new stack, which is independent of the stack of the C function itself and of the previous Lua stack. It contains all the parameters Lua passes to the C function, and the C function puts the result to be returned into this stack to return to the caller (see <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_CFunction</span></code></span>）。</p>
<p>For convenience, all API query operations on the stack do not strictly follow the stack’s operating rules. Instead, you can use an_index_to point to any element on the stack: a positive index refers to the absolute position on the stack (starting at 1); a negative index refers to the offset from the top of the stack. In terms of expansion, if the stack has_n_elements, then index 1 represents the first element (that is, the element that is pushed first) and index_n_refers to the last element; Index -1 also refers to the last element (that is, the element at the top of the stack), and index_-n_refers to the first element.</p>
</section>
<section id="stack-size">
<h3>4.2 – Stack Size<a class="headerlink" href="#stack-size" title="Permalink to this headline">#</a></h3>
<p>When you use the Lua API, you are responsible for making the appropriate calls. In particular, it is your responsibility to control the stack overflow_. You can use the <span class="xref myst">lua_checkstack</span> function to increase the size of the available stack.</p>
<p>Whenever Lua calls C, it only guarantees that there is at least LUA_MINSTACK so much stack space available. LUA_MINSTACK is generally defined as 20, so as long as you<code class="docutils literal notranslate"><span class="pre">re</span> <span class="pre">not</span> <span class="pre">constantly</span> <span class="pre">stacking</span> <span class="pre">data,</span> <span class="pre">you</span> <span class="pre">don</span></code>t usually care about stack size.</p>
<p>When you call a Lua function without specifying how many return values to receive (see <span class="xref myst">lua_call</span>), Lua guarantees that there will be enough space on the stack to receive all the return values, but there is no guarantee that there will be extra space. Therefore, after making such a call, if you need to continue to push the stack, you need to use <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_checkstack</span></code></span>。</p>
</section>
<section id="valid-and-acceptable-indexes">
<h3>4.3 – Valid and Acceptable Indexes<a class="headerlink" href="#valid-and-acceptable-indexes" title="Permalink to this headline">#</a></h3>
<p>API If the function in needs to pass in the stack index, this index must be a valid index or an acceptable index._。</p>
<p>_ Valid index_refers to the index of the real position in the stack; that is, the position between 1 and the top of the stack (<code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">≤</span> <span class="pre">abs(index)</span> <span class="pre">≤</span> <span class="pre">top</span></code>). Typically, a function that might modify the value at that location needs to pass in a valid index.</p>
<p>Unless otherwise noted, any function that can accept a valid index also accepts a_pseudo-index_. Pseudo-indexes refer to Lua values that can be accessed by C code, but they are not on the stack. This is used to access the registry as well as the upper value of the C function (see <span class="xref myst">§4.4</span>）。</p>
<p>For functions that only need values in the stack (such as query functions) and do not need to specify a stack location, they can be called with an acceptable index. The acceptable index can be not only any valid index including a pseudo index, but also any positive index that exceeds the top of the stack but falls within the space allocated for the stack. (Note that 0 is never an acceptable index.) Unless otherwise noted, functions in the API accept acceptable indexes.</p>
<p>Acceptable indexes are allowed to avoid additional checks for queries outside the top of the stack. For example, a C function can directly query the third parameter passed to it without first checking whether there is a third parameter, that is, there is no need to check whether 3 is a valid index.</p>
<p>For functions that can accept index calls, the invalid index is considered to contain a value of virtual type LUA_TNONE, which behaves the same as nil.</p>
</section>
<section id="c-closure">
<h3>4.4 – C closure<a class="headerlink" href="#c-closure" title="Permalink to this headline">#</a></h3>
<p>When a C function is created, it is possible to associate some values together, I .e. create a_C closure_(see <span class="xref myst">lua_pushcclosure</span>); these associated values are called_upper values_, and they can be accessed when the function is called.</p>
<p>Whenever a C function is called, the upper value of the function can be located with a pseudo index. We can use the <span class="xref myst">lua_upvalueindex</span> macro to generate these pseudo-indexes. The first value associated with the function is placed in the lua_upvalueindex(1) position, and so on. When using <code class="docutils literal notranslate"><span class="pre">lua_upvalueindex(_n_)</span></code>, if_n_is greater than the total number of upper values of the current function (but cannot be greater than 256), it will produce an acceptable but invalid index.</p>
</section>
<section id="registry">
<h3>4.5 – Registry<a class="headerlink" href="#registry" title="Permalink to this headline">#</a></h3>
<p>Lua A_registry_is provided, which is a predefined table that can be used to hold any Lua value that C code wants to hold. This table can be located with a valid pseudo-index LUA_REGISTRYINDEX. Any C library can store data in this table. To prevent conflicts, you need to choose the key names carefully. The general usage is that you can use a string containing your library name as the key name, or take the address of your own C object as the key in the form of lightweight user data, or use any Lua object created by your code as the key. Regarding the variable name, the name of the string key name with the underlined letter is reserved by Lua.</p>
<p>Integer keys in the registry are used for the reference mechanism (see <span class="xref myst">luaL_ref</span>), as well as some predefined values. Therefore, integer keys should not be used for other purposes.</p>
<p>When you create a new Lua state machine, several values are predefined in the registry. These predefined values can be indexed to by integers, which are defined in the form of constants in `lua.h. have the following constants：</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_RIDX_MAINTHREAD</span></code>:</strong> Under this index in the registry is the main thread of the state machine. (The main thread and the state machine are created at the same time.。）</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_RIDX_GLOBALS</span></code>:</strong> Under this index of the registry is the global environment.</p></li>
</ul>
</section>
<section id="c-error-handling-in">
<h3>4.6 – C Error handling in<a class="headerlink" href="#c-error-handling-in" title="Permalink to this headline">#</a></h3>
<p>In its internal implementation, Lua uses C<code class="docutils literal notranslate"><span class="pre">s</span> </code>longjmp<code class="docutils literal notranslate"><span class="pre">mechanism</span> <span class="pre">to</span> <span class="pre">handle</span> <span class="pre">errors.</span> <span class="pre">(If</span> <span class="pre">you</span> <span class="pre">compile</span> <span class="pre">in</span> <span class="pre">C,</span> <span class="pre">Lua</span> <span class="pre">will</span> <span class="pre">replace</span> <span class="pre">it</span> <span class="pre">with</span> <span class="pre">an</span> <span class="pre">exception;</span> <span class="pre">search</span> <span class="pre">for</span></code>LUAI_THROW in the source code for details.) When Lua encounters any errors (such as memory allocation errors, type errors, syntax errors, and runtime errors) it will throw out an error; that is, call a long jump. In the_protected environment, Lua uses <code class="docutils literal notranslate"><span class="pre">setjmp</span></code> to set a recovery point; any errors that occur will jump to the nearest recovery point.</p>
<p>If the error occurs outside the protected environment, Lua will first call the_panic function_(see <span class="xref myst">lua_atpanic</span>) and then call <code class="docutils literal notranslate"><span class="pre">abort</span></code> to exit the host program. Your panic function can not exit the program as long as it does not return (for example, long jump to the recovery point you set yourself outside Lua).</p>
<p>panic The function operates as an error message handler (see <span class="xref myst">§ 2.3</span>); the error message is at the top of the stack. The difference is that it does not guarantee stack space. Before doing any stack pressing, the panic function must first check whether there is enough space (see <span class="xref myst">§4.2</span>）。</p>
<p>Most API functions have the potential to throw errors, such as when there is a memory allocation error. The documentation for each function notes whether it might throw an error.</p>
<p>Inside a C function, you can throw an error by calling <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_error</span></code></span>.</p>
</section>
<section id="c-give-up-processing-in">
<h3>4.7 – C Give-up processing in<a class="headerlink" href="#c-give-up-processing-in" title="Permalink to this headline">#</a></h3>
<p>Lua Internally use C<code class="docutils literal notranslate"><span class="pre">s</span> </code>longjmp<code class="docutils literal notranslate"> <span class="pre">mechanism</span> <span class="pre">to</span> <span class="pre">give</span> <span class="pre">up</span> <span class="pre">a</span> <span class="pre">coroutation.</span> <span class="pre">Therefore,</span> <span class="pre">if</span> <span class="pre">a</span> <span class="pre">C</span> <span class="pre">function</span></code> foo<code class="docutils literal notranslate"><span class="pre">calls</span> <span class="pre">an</span> <span class="pre">API</span> <span class="pre">function,</span> <span class="pre">and</span> <span class="pre">the</span> <span class="pre">API</span> <span class="pre">function</span> <span class="pre">gives</span> <span class="pre">up</span> <span class="pre">(directly</span> <span class="pre">or</span> <span class="pre">indirectly</span> <span class="pre">calls</span> <span class="pre">the</span> <span class="pre">give-out</span> <span class="pre">function).</span> <span class="pre">Since</span></code>longjmp<code class="docutils literal notranslate"><span class="pre">removes</span> <span class="pre">the</span> <span class="pre">stack</span> <span class="pre">frame</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">C</span> <span class="pre">stack,</span> <span class="pre">Lua</span> <span class="pre">cannot</span> <span class="pre">return</span> <span class="pre">to</span></code>foo.</p>
<p>In order to avoid this kind of problem, when calling out in API calls, in addition to those API that throw errors, three functions are provided: <span class="xref myst">lua_yieldk</span>, <span class="xref myst">lua_callk</span>, and <span class="xref myst">lua_pcallk</span>. They can continue to run from the_continuation function_(parameter named <code class="docutils literal notranslate"><span class="pre">k</span></code>) passed in when the yield occurs.</p>
<p>We need to presuppose some terms to explain the continuation point. For C functions called from Lua, we call them_primitive_. The three C API functions described above that are called from this primitive function are called_called functions_. The called function can make the current thread give way. (yield occurs when the called function is <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_yieldk</span></code></span>, or the function passed into <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_callk</span></code></span> or <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_pcallk</span></code></span> calls yield。）</p>
<p>Suppose the running thread gives up when executing the called function. When the thread is continued again, it wants to continue the function being called. However, the called function cannot be returned to the original function. This is because the previous yield operation destroyed the stack frame of the C stack. As an alternative, Lua calls the_continuation function_given as an argument to the called function_. As the name suggests, a continuation function will continue the task of the original function.</p>
<p>The following function will do a description：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> int original\_function (lua\_State \*L) {
   ...     /\* code 1 \*/
   status = lua\_pcall(L, n, m, h);  /\* calls Lua \*/
   ...     /\* code 2 \*/
 }
</pre></div>
</div>
<p>Now we want to allow Lua code that is run by <span class="xref myst">lua_pcall</span> to give up. First, we rewrite the function like this.：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> int k (lua\_State \*L, int status, lua\_KContext ctx) {
   ...  /\* code 2 \*/
 }

 int original\_function (lua\_State \*L) {
   ...     /\* code 1 \*/
   return k(L, lua\_pcall(L, n, m, h), ctx);
 }
</pre></div>
</div>
<p>In the above code, the new function <code class="docutils literal notranslate"><span class="pre">k</span></code> is a_continuation function_(the function type is <span class="xref myst">lua_KFunction</span>). Its job is what it does after the call to <span class="xref myst">lua_pcall</span> in the original function. Now we must inform Lua that you must continue to call <code class="docutils literal notranslate"><span class="pre">k</span></code> after the Lua code executed by <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_pcall</span></code></span> has been interrupted (error or yield) <code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">So</span> <span class="pre">we</span> <span class="pre">have</span> <span class="pre">to</span> <span class="pre">continue</span> <span class="pre">to</span> <span class="pre">rewrite</span> <span class="pre">this</span> <span class="pre">code</span> <span class="pre">and</span> <span class="pre">replace</span> <span class="pre">[</span></code>lua_pcall<code class="docutils literal notranslate"><span class="pre">](#lua_pcall)</span> <span class="pre">[</span></code>lua_pcallk`](#lua_pcallk)：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> int original\_function (lua\_State \*L) {
   ...     /\* code 1 \*/
   return k(L, lua\_pcallk(L, n, m, h, ctx2, k), ctx1);
 }
</pre></div>
</div>
<p>Note the additional explicit call to the continuation function here: Lua calls the continuation function only when it is needed, which may be caused by an error, or it may be due to a concession that needs to continue running. If no yield has occurred and the called function returns normally, then <span class="xref myst">lua_pcallk</span> (and <span class="xref myst">lua_callk</span>) will also return normally. (Of course, in this example, you can also not call the continuation function later, but write the work that needs to be done directly after the call of the original function.。）</p>
<p>In addition to the Lua state, the continuation function has two parameters: one is the last state code of the call, and the other is the context (<code class="docutils literal notranslate"><span class="pre">ctx</span></code>) initially passed in by <span class="xref myst">lua_pcallk</span>. (Lua does not use this value itself; it simply forwards the value from the original function to the continuation function.) For <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_pcallk</span></code></span>, the status code and <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_pcallk</span></code></span> should return the same value, except that the status code is <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">LUA_YIELD</span></code></span>(instead of [<code class="docutils literal notranslate"><span class="pre">LUA_OK</span> </code>](#pdf-LUA_ OK)) when the execution is completed after a release. For <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_yieldk</span></code></span> and <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_callk</span></code></span>, the status code passed in by calling the continuation function must be <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">LUA_YIELD</span></code></span>. (For these two functions, Lua does not call continuation functions for any errors, because they do not handle errors.) Similarly, when you use <span class="xref myst">lua_callk</span>, you should use [<code class="docutils literal notranslate"><span class="pre">LUA_OK</span> </code>](#pdf-LUA_ OK) as the status code to call the continuation function. (For <span class="xref myst">lua_yieldk</span>, there is almost no place to call the continuation function directly, because <span class="xref myst">lua_yieldk</span> itself does not return。）</p>
<p>Lua Will treat the continuation function as the original function. The continuation function will receive the same Lua stack as the original function, and the lua state it receives is also consistent with the state the called function should have after returning. (For example, after the <span class="xref myst">lua_callk</span> call, previously pushed functions and call parameters on the stack are replaced by the return value generated by the call.) It also has the same upper value. When it returns, Lua will treat it as the return of the original function to operate.</p>
</section>
<section id="functions-and-types">
<h3>4.8 – Functions and Types<a class="headerlink" href="#functions-and-types" title="Permalink to this headline">#</a></h3>
<p>Here is an alphabetical list of all the functions and types in the C API. Each function has a hint like this： [-o, +p, <em>x</em>]</p>
<p>For the first field, ‘o’ refers to how many elements the function will pop from the stack. The second field, ‘p’, refers to how many elements the function will stack. (All functions will pop the parameters and then push the results on the stack.) The field of the form ‘x | y’ indicates that the function may push (or pop) ‘x’ or ‘y’ elements depending on the situation; the question mark ‘’?’’ indicates that we cannot know how many elements the function will pop/push (for example, the number depends on what is on the stack) just by the argument. The third field, ‘x’, explains whether the function will throw an error: ‘’-’’ means that the function will never throw an error; ‘’e’’ means that the function may throw an error; ‘’v’’ means that the function may throw a meaningful error.</p>
<hr class="docutils"/>
<section id="lua-absindex">
<h4><code class="docutils literal notranslate"><span class="pre">lua_absindex</span></code><a class="headerlink" href="#lua-absindex" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_absindex (lua_State *L, int idx);</p>
<p>Convert an acceptable index <code class="docutils literal notranslate"><span class="pre">idx</span></code> to an absolute index (that is, a value that does not depend on where the top of the stack is）。</p>
</section>
<hr class="docutils"/>
<section id="lua-alloc">
<h4><code class="docutils literal notranslate"><span class="pre">lua_Alloc</span></code><a class="headerlink" href="#lua-alloc" title="Permalink to this headline">#</a></h4>
<p>typedef void * (*lua_Alloc) (void *ud,
void *ptr,
size_t osize,
size_t nsize);</p>
<p>Lua The type of memory allocator function used in the state machine. The memory allocation function must provide a function similar to <code class="docutils literal notranslate"><span class="pre">realloc</span></code> but not identical. Its parameters are <code class="docutils literal notranslate"><span class="pre">ud</span></code>, a pointer passed to it by <span class="xref myst">lua_newstate</span>; <code class="docutils literal notranslate"><span class="pre">ptr</span></code>, a pointer to a memory block that has been allocated/will be reallocated/to be freed; <code class="docutils literal notranslate"><span class="pre">Osize</span></code>, the original size of the memory block or a code about what will be allocated; <code class="docutils literal notranslate"><span class="pre">nsize</span></code>, the size of the new memory block.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">ptr</span></code> is not <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, <code class="docutils literal notranslate"><span class="pre">osize</span></code> is the size of the memory block pointed to by <code class="docutils literal notranslate"><span class="pre">ptr</span></code>, that is, the size of the memory block originally allocated or reallocated.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">ptr</span></code> is <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, <code class="docutils literal notranslate"><span class="pre">osize</span></code> is the encoding of the type of object Lua is about to assign. When (and only if) Lua creates a new object of the corresponding type, <code class="docutils literal notranslate"><span class="pre">osize</span></code> is one of <span class="xref myst">LUA_TSTRING</span>, <span class="xref myst">LUA_TTABLE</span>, <span class="xref myst">LUA_TFUNCTION</span>, <span class="xref myst">LUA_TUSERDATA</span>, or <span class="xref myst">LUA_TTHREAD</span>. If <code class="docutils literal notranslate"><span class="pre">osize</span></code> is something else, Lua will allocate memory for something else.</p>
<p>Lua The allocator function is assumed to follow the following behavior：</p>
<p>When <code class="docutils literal notranslate"><span class="pre">nsize</span></code> is zero, the allocator must behave like <code class="docutils literal notranslate"><span class="pre">free</span></code> and return <code class="docutils literal notranslate"><span class="pre">NULL</span></code>。</p>
<p>When <code class="docutils literal notranslate"><span class="pre">nsize</span></code> is not zero, the allocator must behave like <code class="docutils literal notranslate"><span class="pre">realloc.</span> <span class="pre">If</span> <span class="pre">the</span> <span class="pre">allocator</span> <span class="pre">cannot</span> <span class="pre">complete</span> <span class="pre">the</span> <span class="pre">request,</span> <span class="pre">it</span> <span class="pre">returns</span> </code>NULL <code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">Lua</span> <span class="pre">assumes</span> <span class="pre">that</span> <span class="pre">the</span> <span class="pre">allocator</span> <span class="pre">will</span> <span class="pre">never</span> <span class="pre">fail</span> <span class="pre">if</span> </code>osize &gt;= nsize` holds.</p>
<p>Here is a simple implementation of the allocator function. This implementation is placed in the supplemental library for use by <span class="xref myst">luaL_newstate</span>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> static void \*l\_alloc (void \*ud, void \*ptr, size\_t osize,
                                            size\_t nsize) {
   (void)ud;  (void)osize;  /\* not used \*/
   if (nsize == 0) {
     free(ptr);
     return NULL;
   }
   else
     return realloc(ptr, nsize);
 }
</pre></div>
</div>
<p>Note that standard C ensures that <code class="docutils literal notranslate"><span class="pre">free(NULL)</span></code>has no side effects and that <code class="docutils literal notranslate"><span class="pre">realloc(NULL,size)</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">malloc(size)</span></code>. This code assumes that <code class="docutils literal notranslate"><span class="pre">realloc</span></code> will not fail when reducing the block length. (Although standard C does not guarantee this behavior, this seems to be a safe assumption。）</p>
</section>
<hr class="docutils"/>
<section id="lua-arith">
<h4><code class="docutils literal notranslate"><span class="pre">lua_arith</span></code><a class="headerlink" href="#lua-arith" title="Permalink to this headline">#</a></h4>
<p>[-(2|1), +1, <em>e</em>]</p>
<p>void lua_arith (lua_State *L, int op);</p>
<p>Do a mathematical or bit operation on the top two values (or one, say, inverted) of the stack. where the value at the top of the stack is the second operand. It pops the pushed value and puts the result on top of the stack. This function follows Lua’s corresponding operator arithmetic rules (I. e., it is possible to trigger meta-methods.）。</p>
<p><code class="docutils literal notranslate"><span class="pre">op</span></code> The value of must be one of the following constants：</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_OPADD</span></code>:</strong> Addition (<code class="docutils literal notranslate"><span class="pre">+</span></code>)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_OPSUB</span></code>:</strong> subtraction (<code class="docutils literal notranslate"><span class="pre">-</span></code>)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_OPMUL</span></code>:</strong> Multiplication (<code class="docutils literal notranslate"><span class="pre">*</span></code>)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_OPDIV</span></code>:</strong> floating point division (<code class="docutils literal notranslate"><span class="pre">/</span></code>)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_OPIDIV</span></code>:</strong> Division with round down (<code class="docutils literal notranslate"><span class="pre">//</span></code>)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_OPMOD</span></code>:</strong> Modulus (<code class="docutils literal notranslate"><span class="pre">%</span></code>)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_OPPOW</span></code>:</strong> power (<code class="docutils literal notranslate"><span class="pre">^</span></code>)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_OPUNM</span></code>:</strong> take negative (one yuan <code class="docutils literal notranslate"><span class="pre">-</span></code>)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_OPBNOT</span></code>:</strong> bitwise inversion (<code class="docutils literal notranslate"><span class="pre">~</span></code>)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_OPBAND</span></code>:</strong> Bits and (<code class="docutils literal notranslate"><span class="pre">&amp;</span></code>)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_OPBOR</span></code>:</strong> Bits or (<code class="docutils literal notranslate"><span class="pre">|</span></code>)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_OPBXOR</span></code>:</strong> bitwise exclusive or (<code class="docutils literal notranslate"><span class="pre">~</span></code>)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_OPSHL</span></code>:</strong> Move left (<code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code>)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_OPSHR</span></code>:</strong> Move Right (<code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code>)</p></li>
</ul>
</section>
<hr class="docutils"/>
<section id="lua-atpanic">
<h4><code class="docutils literal notranslate"><span class="pre">lua_atpanic</span></code><a class="headerlink" href="#lua-atpanic" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>lua_CFunction lua_atpanic (lua_State *L, lua_CFunction panicf);</p>
<p>Set a new panic function and return the one you set previously. (See <span class="xref myst">§4.6</span>）。</p>
</section>
<hr class="docutils"/>
<section id="lua-call">
<h4><code class="docutils literal notranslate"><span class="pre">lua_call</span></code><a class="headerlink" href="#lua-call" title="Permalink to this headline">#</a></h4>
<p>[-(nargs+1), +nresults, <em>e</em>]</p>
<p>void lua_call (lua_State *L, int nargs, int nresults);</p>
<p>Call a function.</p>
<p>To call a function, please follow the following protocol: first, the function to be called should be pushed onto the stack. Finally, call <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_call</span></code></span>; <code class="docutils literal notranslate"><span class="pre">nargs</span></code> is the number of parameters you pushed onto the stack. When the function call is completed, all the parameters and the function itself will be out of the stack. The return value of the function is then pushed on the stack. The number of returned values will be adjusted to <code class="docutils literal notranslate"><span class="pre">nresults</span></code> unless <code class="docutils literal notranslate"><span class="pre">nresults</span></code> is set to LUA_MULTRET `. In this case, all return values are pushed onto the stack. Lua will ensure that the return value is placed in the stack space. Function return values will be pushed in positive order (the first return value is pushed first), so after the call, the last return value will be placed on the top of the stack.</p>
<p>Errors that occur within the called function will always be thrown up (via <code class="docutils literal notranslate"><span class="pre">longjmp</span></code>).</p>
<p>In the following example, this line of Lua code is equivalent to doing some work in C code in the host program.：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> a = f("how", t.x, 14)
</pre></div>
</div>
<p>Here is the code in C.：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> lua\_getglobal(L, "f");                  /\* function to be called \*/
 lua\_pushliteral(L, "how");                       /\* 1st argument \*/
 lua\_getglobal(L, "t");                    /\* table to be indexed \*/
 lua\_getfield(L, -1, "x");        /\* push result of t.x (2nd arg) \*/
 lua\_remove(L, -2);                  /\* remove 't' from the stack \*/
 lua\_pushinteger(L, 14);                          /\* 3rd argument \*/
 lua\_call(L, 3, 1);     /\* call 'f' with 3 arguments and 1 result \*/
 lua\_setglobal(L, "a");                         /\* set global 'a' \*/
</pre></div>
</div>
<p>Note that the above code is balanced: at the end, the stack is restored to its original configuration. This is a good programming practice.</p>
</section>
<hr class="docutils"/>
<section id="lua-callk">
<h4><code class="docutils literal notranslate"><span class="pre">lua_callk</span></code><a class="headerlink" href="#lua-callk" title="Permalink to this headline">#</a></h4>
<p>[-(nargs + 1), +nresults, <em>e</em>]</p>
<p>void lua_callk (lua_State *L,
int nargs,
int nresults,
lua_KContext ctx,
lua_KFunction k);</p>
<p>The behavior of this function is exactly the same as <span class="xref myst">lua_call</span>, except that it also allows the called function to give up (cf. <span class="xref myst">§4.7</span>）。</p>
</section>
<hr class="docutils"/>
<section id="lua-cfunction">
<h4><code class="docutils literal notranslate"><span class="pre">lua_CFunction</span></code><a class="headerlink" href="#lua-cfunction" title="Permalink to this headline">#</a></h4>
<p>typedef int (*lua_CFunction) (lua_State *L);</p>
<p>C The type of the function.</p>
<p>In order to communicate properly with Lua, C functions must use the following protocols. This protocol defines the method of passing parameters and return values: C functions accept parameters through the stack in Lua, and the parameters are stacked in positive order (the first parameter is stacked first). Therefore, when the function starts, lua_gettop(L) returns the number of arguments received by the function. The first parameter (if any) is at index 1, and the last parameter is at index lua_gettop(L). When returning values to Lua, the C function only needs to push them onto the stack in positive order (the first return value is pushed first), and then return the number of these return values. Below these return values, everything on the stack is dropped by Lua. Like Lua functions, calling C functions from Lua can have many return values.</p>
<p>The function in the following example takes several numeric arguments and returns their average and sum.：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> static int foo (lua\_State \*L) {
   int n = lua\_gettop(L);    /\* Number of parameters \*/
   lua\_Number sum = 0.0;
   int i;
   for (i = 1; i &lt;= n; i++) {
     if (!lua\_isnumber(L, i)) {
       lua\_pushliteral(L, "incorrect argument");
       lua\_error(L);
     }
     sum += lua\_tonumber(L, i);
   }
   lua\_pushnumber(L, sum/n);        /\* First Return Value \*/
   lua\_pushnumber(L, sum);         /\* Second Return Value \*/
   return 2;                   /\* Number of return values \*/
 }
</pre></div>
</div>
</section>
<hr class="docutils"/>
<section id="lua-checkstack">
<h4><code class="docutils literal notranslate"><span class="pre">lua_checkstack</span></code><a class="headerlink" href="#lua-checkstack" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_checkstack (lua_State *L, int n);</p>
<p>Make sure there are at least <code class="docutils literal notranslate"><span class="pre">n</span></code> extra spaces on the stack. If the stack cannot be expanded to the appropriate size, the function returns false. Reasons for failure include expanding the stack to more than the fixed maximum size (at least a few thousand elements) or failing to allocate memory. This function never shrinks the stack; if the stack is already larger than needed, it stays the same.</p>
</section>
<hr class="docutils"/>
<section id="lua-close">
<h4><code class="docutils literal notranslate"><span class="pre">lua_close</span></code><a class="headerlink" href="#lua-close" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>void lua_close (lua_State *L);</p>
<p>Destroys all objects in the specified Lua state machine (garbage collection-related meta methods, if any, are called) and frees all dynamic memory used in the state machine. On some platforms, you don’t need to call this function, because when the host program ends, all resources are naturally released. On the other hand, a long-running program, such as a background program or a web server, creates multiple Lua state machines. Then you should quickly close them when you don’t need them.</p>
</section>
<hr class="docutils"/>
<section id="lua-compare">
<h4><code class="docutils literal notranslate"><span class="pre">lua_compare</span></code><a class="headerlink" href="#lua-compare" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>e</em>]</p>
<p>int lua_compare (lua_State *L, int index1, int index2, int op);</p>
<p>Compares two Lua values. When the value at index <code class="docutils literal notranslate"><span class="pre">index1</span></code> is compared with the value at index <code class="docutils literal notranslate"><span class="pre">index2</span></code> by <code class="docutils literal notranslate"><span class="pre">op</span></code>, the function returns 1. This function follows Lua`s corresponding operation rules (I. e., it is possible to trigger meta methods). Otherwise, the function returns 0. When either index is invalid, the function also returns 0 。</p>
<p><code class="docutils literal notranslate"><span class="pre">op</span></code> value must be one of the following constants：</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_OPEQ</span></code>:</strong> Comparison of equality (<code class="docutils literal notranslate"><span class="pre">==</span></code>)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_OPLT</span></code>:</strong> Less Than Compare (<code class="docutils literal notranslate"><span class="pre">&lt;</span></code>)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_OPLE</span></code>:</strong> Less than or equal to comparison (<code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>)</p></li>
</ul>
</section>
<hr class="docutils"/>
<section id="lua-concat">
<h4><code class="docutils literal notranslate"><span class="pre">lua_concat</span></code><a class="headerlink" href="#lua-concat" title="Permalink to this headline">#</a></h4>
<p>[-n, +1, <em>e</em>]</p>
<p>void lua_concat (lua_State *L, int n);</p>
<p>Connect the <code class="docutils literal notranslate"><span class="pre">n</span></code> values at the top of the stack, then pull these values off the stack and put the result on the top of the stack. If <code class="docutils literal notranslate"><span class="pre">n</span></code> is 1, the result is that value on the stack (I. e., the function does nothing); if <code class="docutils literal notranslate"><span class="pre">n</span></code> is 0, the result is an empty string. The connection is done according to the usual semantics in Lua (see. <span class="xref myst">§3.4.6</span> ）。</p>
</section>
<hr class="docutils"/>
<section id="lua-copy">
<h4><code class="docutils literal notranslate"><span class="pre">lua_copy</span></code><a class="headerlink" href="#lua-copy" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>void lua_copy (lua_State *L, int fromidx, int toidx);</p>
<p>Copy a value from index <code class="docutils literal notranslate"><span class="pre">fromidx</span></code> to a valid index <code class="docutils literal notranslate"><span class="pre">toidx</span></code>, overwriting the original value there. Values in other locations are not affected.</p>
</section>
<hr class="docutils"/>
<section id="lua-createtable">
<h4><code class="docutils literal notranslate"><span class="pre">lua_createtable</span></code><a class="headerlink" href="#lua-createtable" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>void lua_createtable (lua_State *L, int narr, int nrec);</p>
<p>Creates a new empty table pressure stack. The parameter <code class="docutils literal notranslate"><span class="pre">narr</span></code> suggests how many elements the table will have when used as a sequence; the parameter <code class="docutils literal notranslate"><span class="pre">nrec</span></code> suggests how many elements outside the sequence the table may have. Lua will use these suggestions to pre-allocate the new table. If you know more about the purpose of this table, pre-allocation can improve performance. Otherwise, you can use the function <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_newtable</span></code></span> 。</p>
</section>
<hr class="docutils"/>
<section id="lua-dump">
<h4><code class="docutils literal notranslate"><span class="pre">lua_dump</span></code><a class="headerlink" href="#lua-dump" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>e</em>]</p>
<p>int lua_dump (lua_State *L,
lua_Writer writer,
void *data,
int strip);</p>
<p>Export the function as a block of binary code. The function receives the Lua function at the top of the stack as an argument and then generates its binary code block. If the exported thing is loaded again, the result of the load is equivalent to the original function. When it generates a code block, <span class="xref myst">lua_dump</span> writes data by calling the function <code class="docutils literal notranslate"><span class="pre">writer</span></code> (see <span class="xref myst">lua_Writer</span> ), followed by the <code class="docutils literal notranslate"><span class="pre">data</span></code> parameter. <code class="docutils literal notranslate"><span class="pre">writer</span></code> 。</p>
<p>If <code class="docutils literal notranslate"><span class="pre">strip</span></code> is true, the binary code block will not contain debugging information for the function.</p>
<p>The last return value from <code class="docutils literal notranslate"><span class="pre">writer</span></code> will be returned as the return value of this function; 0 means there is no error.</p>
<p>This function does not pop Lua functions off the stack.</p>
</section>
<hr class="docutils"/>
<section id="lua-error">
<h4><code class="docutils literal notranslate"><span class="pre">lua_error</span></code><a class="headerlink" href="#lua-error" title="Permalink to this headline">#</a></h4>
<p>[-1, +0, <em>v</em>]</p>
<p>int lua_error (lua_State *L);</p>
<p>Throws a Lua error with the value at the top of the stack as the error object. This function will do a long jump, so it must not return (cf. <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">luaL_error</span></code></span>）。</p>
</section>
<hr class="docutils"/>
<section id="lua-gc">
<h4><code class="docutils literal notranslate"><span class="pre">lua_gc</span></code><a class="headerlink" href="#lua-gc" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>e</em>]</p>
<p>int lua_gc (lua_State *L, int what, int data);</p>
<p>Controls the garbage collector.</p>
<p>This function initiates several different tasks depending on its parameter <code class="docutils literal notranslate"><span class="pre">what</span></code>：</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_GCSTOP</span></code>:</strong> Stop the garbage collector.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_GCRESTART</span></code>:</strong> Restart the garbage collector.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_GCCOLLECT</span></code>:</strong> Initiate a full garbage collection cycle.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_GCCOUNT</span></code>:</strong> Returns the total amount of memory used by Lua (in K bytes）。</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_GCCOUNTB</span></code>:</strong> Returns the remainder of the current memory usage divided by the 1024.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_GCSTEP</span></code>:</strong> Initiates one-step incremental garbage collection.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_GCSETPAUSE</span></code>:</strong> Set <code class="docutils literal notranslate"><span class="pre">data</span></code> to_garbage collector intermittent rate_(see <span class="xref myst">§ 2.5</span>) and return to the previously set value.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_GCSETSTEPMUL</span></code>:</strong> Set <code class="docutils literal notranslate"><span class="pre">data</span></code> to_garbage collector step factor_(see <span class="xref myst">§ 2.5</span>) and return to the previously set value.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_GCISRUNNING</span></code>:</strong> Returns whether the collector is running (I. e. not stopped）。</p></li>
</ul>
<p>For details on these options, see <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">collectgarbage</span></code></span> 。</p>
</section>
<hr class="docutils"/>
<section id="lua-getallocf">
<h4><code class="docutils literal notranslate"><span class="pre">lua_getallocf</span></code><a class="headerlink" href="#lua-getallocf" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>lua_Alloc lua_getallocf (lua_State *L, void **ud);</p>
<p>Returns the memory allocator function for the given state machine. If <code class="docutils literal notranslate"><span class="pre">ud</span></code> is not <code class="docutils literal notranslate"><span class="pre">NULL</span></code> , Lua puts the pointer set when setting the memory allocation function <code class="docutils literal notranslate"><span class="pre">*ud</span></code> 。</p>
</section>
<hr class="docutils"/>
<section id="lua-getfield">
<h4><code class="docutils literal notranslate"><span class="pre">lua_getfield</span></code><a class="headerlink" href="#lua-getfield" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>int lua_getfield (lua_State *L, int index, const char *k);</p>
<p>Stack the value of<code class="docutils literal notranslate"><span class="pre">t[k]</span></code>, where <code class="docutils literal notranslate"><span class="pre">t</span></code> is the value pointed to by the index. In Lua, this function may trigger the meta-method corresponding to the “index” event (see <span class="xref myst">§2.4</span> ）。</p>
<p>function returns the type of the pushed value.</p>
</section>
<hr class="docutils"/>
<section id="lua-getextraspace">
<h4><code class="docutils literal notranslate"><span class="pre">lua_getextraspace</span></code><a class="headerlink" href="#lua-getextraspace" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>void *lua_getextraspace (lua_State *L);</p>
<p>Returns a pointer to the associated memory block in the Lua state machine. Programs can use this memory for any purpose; Lua won’t use it.</p>
<p>Each new thread carries a piece of memory, initialized as a copy of that memory for the main thread.</p>
<p>By default, the size of this memory is the size of a null pointer. However you can recompile Lua to set this piece of memory to a different size. (See in <code class="docutils literal notranslate"><span class="pre">luaconf.h</span></code> <code class="docutils literal notranslate"><span class="pre">LUA_EXTRASPACE</span></code>。）</p>
</section>
<hr class="docutils"/>
<section id="lua-getglobal">
<h4><code class="docutils literal notranslate"><span class="pre">lua_getglobal</span></code><a class="headerlink" href="#lua-getglobal" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>int lua_getglobal (lua_State *L, const char *name);</p>
<p>Stacks the value in the global variable name and returns the type of the value.</p>
</section>
<hr class="docutils"/>
<section id="lua-geti">
<h4><code class="docutils literal notranslate"><span class="pre">lua_geti</span></code><a class="headerlink" href="#lua-geti" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>int lua_geti (lua_State *L, int index, lua_Integer i);</p>
<p>Stacks the value of<code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">[I]</span> </code>, where <code class="docutils literal notranslate"><span class="pre">t</span></code> refers to the value referred to by the given index. As in Lua, this function may trigger the meta-method of the “index” event (see <span class="xref myst">§2.4</span>）。</p>
<p>Returns the type of the pushed value.</p>
</section>
<hr class="docutils"/>
<section id="lua-getmetatable">
<h4><code class="docutils literal notranslate"><span class="pre">lua_getmetatable</span></code><a class="headerlink" href="#lua-getmetatable" title="Permalink to this headline">#</a></h4>
<p>[-0, +(0|1), –]</p>
<p>int lua_getmetatable (lua_State *L, int index);</p>
<p>If the value at the index has a meta table, the meta table is stacked and 1 is returned. Otherwise nothing will be put on the stack, return 0 。</p>
</section>
<hr class="docutils"/>
<section id="lua-gettable">
<h4><code class="docutils literal notranslate"><span class="pre">lua_gettable</span></code><a class="headerlink" href="#lua-gettable" title="Permalink to this headline">#</a></h4>
<p>[-1, +1, <em>e</em>]</p>
<p>int lua_gettable (lua_State *L, int index);</p>
<p>Stacks the value of<code class="docutils literal notranslate"><span class="pre">t[k]</span></code>, where <code class="docutils literal notranslate"><span class="pre">t</span></code> refers to the value pointed to by the index, and<code class="docutils literal notranslate"> <span class="pre">k</span></code> is the value placed at the top of the stack.</p>
<p>This function pops the key on the stack and puts the result in the same position on the stack. As in Lua, this function may trigger a meta-method corresponding to the “index” event (see <span class="xref myst">§2.4</span> ）。</p>
<p>Returns the type of the pushed value.</p>
</section>
<hr class="docutils"/>
<section id="lua-gettop">
<h4><code class="docutils literal notranslate"><span class="pre">lua_gettop</span></code><a class="headerlink" href="#lua-gettop" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_gettop (lua_State *L);</p>
<p>Returns the index of the element at the top of the stack. Because the index is numbered from 1, this result is equal to the number of elements on the stack; specifically, 0 means the stack is empty.</p>
</section>
<hr class="docutils"/>
<section id="lua-getuservalue">
<h4><code class="docutils literal notranslate"><span class="pre">lua_getuservalue</span></code><a class="headerlink" href="#lua-getuservalue" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, –]</p>
<p>int lua_getuservalue (lua_State *L, int index);</p>
<p>Stacks the Lua value associated with the user data at a given index.</p>
<p>Returns the type of the pushed value.</p>
</section>
<hr class="docutils"/>
<section id="lua-insert">
<h4><code class="docutils literal notranslate"><span class="pre">lua_insert</span></code><a class="headerlink" href="#lua-insert" title="Permalink to this headline">#</a></h4>
<p>[-1, +1, –]</p>
<p>void lua_insert (lua_State *L, int index);</p>
<p>Move the top element of the stack to the specified valid index, and then move the elements above this index. Do not call this function with a pseudo-index, because the pseudo-index does not really point to a location on the stack.</p>
</section>
<hr class="docutils"/>
<section id="lua-integer">
<h4><code class="docutils literal notranslate"><span class="pre">lua_Integer</span></code><a class="headerlink" href="#lua-integer" title="Permalink to this headline">#</a></h4>
<p>typedef … lua_Integer;</p>
<p>Lua The integer type in.</p>
<p>When missing, this is<code class="docutils literal notranslate"> <span class="pre">long</span> <span class="pre">long</span></code> (usually a 64-bit integer with two as its complement), or it can be modified to<code class="docutils literal notranslate"> <span class="pre">long</span></code> or<code class="docutils literal notranslate"> <span class="pre">int</span></code> (usually a 32-bit integer with two as its complement). (See in <code class="docutils literal notranslate"><span class="pre">luaconf.h</span></code> <code class="docutils literal notranslate"><span class="pre">LUA_INT</span></code> 。）</p>
<p>Lua Two constants are defined: LUA_MININTEGER and LUA_MAXINTEGER to represent the minimum and maximum values that this type can represent.</p>
</section>
<hr class="docutils"/>
<section id="lua-isboolean">
<h4><code class="docutils literal notranslate"><span class="pre">lua_isboolean</span></code><a class="headerlink" href="#lua-isboolean" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_isboolean (lua_State *L, int index);</p>
<p>Returns 1 when the value of the given index is a boolean, otherwise 0 。</p>
</section>
<hr class="docutils"/>
<section id="lua-iscfunction">
<h4><code class="docutils literal notranslate"><span class="pre">lua_iscfunction</span></code><a class="headerlink" href="#lua-iscfunction" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_iscfunction (lua_State *L, int index);</p>
<p>Returns 1 when the value of the given index is a C function, otherwise 0 。</p>
</section>
<hr class="docutils"/>
<section id="lua-isfunction">
<h4><code class="docutils literal notranslate"><span class="pre">lua_isfunction</span></code><a class="headerlink" href="#lua-isfunction" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_isfunction (lua_State *L, int index);</p>
<p>Returns 1 when the value of the given index is a function (either a C or Lua function), otherwise it returns 0 。</p>
</section>
<hr class="docutils"/>
<section id="lua-isinteger">
<h4><code class="docutils literal notranslate"><span class="pre">lua_isinteger</span></code><a class="headerlink" href="#lua-isinteger" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_isinteger (lua_State *L, int index);</p>
<p>Returns 1 when the value of the given index is an integer (its value is a number and is stored internally as an integer), otherwise it returns 0 。</p>
</section>
<hr class="docutils"/>
<section id="lua-islightuserdata">
<h4><code class="docutils literal notranslate"><span class="pre">lua_islightuserdata</span></code><a class="headerlink" href="#lua-islightuserdata" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_islightuserdata (lua_State *L, int index);</p>
<p>Returns 1 when the value of the given index is a lightweight user data, otherwise 0 。</p>
</section>
<hr class="docutils"/>
<section id="lua-isnil">
<h4><code class="docutils literal notranslate"><span class="pre">lua_isnil</span></code><a class="headerlink" href="#lua-isnil" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_isnil (lua_State *L, int index);</p>
<p>Returns 1 when the value of the given index is <strong>nil</strong>, otherwise 0 。</p>
</section>
<hr class="docutils"/>
<section id="lua-isnone">
<h4><code class="docutils literal notranslate"><span class="pre">lua_isnone</span></code><a class="headerlink" href="#lua-isnone" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_isnone (lua_State *L, int index);</p>
<p>Returns 1 when the given index is invalid, otherwise 0 。</p>
</section>
<hr class="docutils"/>
<section id="lua-isnoneornil">
<h4><code class="docutils literal notranslate"><span class="pre">lua_isnoneornil</span></code><a class="headerlink" href="#lua-isnoneornil" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_isnoneornil (lua_State *L, int index);</p>
<p>Returns 1 when the given index is invalid or its value is <strong>nil</strong>, otherwise 0 。</p>
</section>
<hr class="docutils"/>
<section id="lua-isnumber">
<h4><code class="docutils literal notranslate"><span class="pre">lua_isnumber</span></code><a class="headerlink" href="#lua-isnumber" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_isnumber (lua_State *L, int index);</p>
<p>Returns 1 when the value of the given index is a number or a string that can be converted to a number, otherwise 0 。</p>
</section>
<hr class="docutils"/>
<section id="lua-isstring">
<h4><code class="docutils literal notranslate"><span class="pre">lua_isstring</span></code><a class="headerlink" href="#lua-isstring" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_isstring (lua_State *L, int index);</p>
<p>Returns 1 when the value of the given index is a string or a number (a number can always be converted to a string), otherwise 0 。</p>
</section>
<hr class="docutils"/>
<section id="lua-istable">
<h4><code class="docutils literal notranslate"><span class="pre">lua_istable</span></code><a class="headerlink" href="#lua-istable" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_istable (lua_State *L, int index);</p>
<p>Returns 1 when the value of the given index is a table, otherwise 0 。</p>
</section>
<hr class="docutils"/>
<section id="lua-isthread">
<h4><code class="docutils literal notranslate"><span class="pre">lua_isthread</span></code><a class="headerlink" href="#lua-isthread" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_isthread (lua_State *L, int index);</p>
<p>Returns 1 when the value of the given index is a thread, otherwise 0 。</p>
</section>
<hr class="docutils"/>
<section id="lua-isuserdata">
<h4><code class="docutils literal notranslate"><span class="pre">lua_isuserdata</span></code><a class="headerlink" href="#lua-isuserdata" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_isuserdata (lua_State *L, int index);</p>
<p>Returns 1 when the value of the given index is a user data (whether full or lightweight), otherwise 0 。</p>
</section>
<hr class="docutils"/>
<section id="lua-isyieldable">
<h4><code class="docutils literal notranslate"><span class="pre">lua_isyieldable</span></code><a class="headerlink" href="#lua-isyieldable" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_isyieldable (lua_State *L);</p>
<p>If the given coroutine can be conceded, return 1, otherwise return 0 。</p>
</section>
<hr class="docutils"/>
<section id="lua-kcontext">
<h4><code class="docutils literal notranslate"><span class="pre">lua_KContext</span></code><a class="headerlink" href="#lua-kcontext" title="Permalink to this headline">#</a></h4>
<p>typedef … lua_KContext;</p>
<p>The type of the continuation function context parameter. This must be a numeric type. When there is a intptr_t, it is defined as a intptr_t, so it can also hold a pointer. Otherwise, it is defined <code class="docutils literal notranslate"><span class="pre">ptrdiff_t</span></code>。</p>
</section>
<hr class="docutils"/>
<section id="lua-kfunction">
<h4><code class="docutils literal notranslate"><span class="pre">lua_KFunction</span></code><a class="headerlink" href="#lua-kfunction" title="Permalink to this headline">#</a></h4>
<p>typedef int (*lua_KFunction) (lua_State *L, int status, lua_KContext ctx);</p>
<p>types of continuation functions (cf. <span class="xref myst">§4.7</span> ）。</p>
</section>
<hr class="docutils"/>
<section id="lua-len">
<h4><code class="docutils literal notranslate"><span class="pre">lua_len</span></code><a class="headerlink" href="#lua-len" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>void lua_len (lua_State *L, int index);</p>
<p>Returns the length of the value at the given index. It is equivalent to the <code class="docutils literal notranslate"><span class="pre">#</span></code> operator in Lua (see <span class="xref myst">§ 3.4.7</span>). It is possible to trigger the meta-method corresponding to the “length” event (see <span class="xref myst">§ 2.4</span> ). The result is stacked.</p>
</section>
<hr class="docutils"/>
<section id="lua-load">
<h4><code class="docutils literal notranslate"><span class="pre">lua_load</span></code><a class="headerlink" href="#lua-load" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, –]</p>
<p>int lua_load (lua_State *L,
lua_Reader reader,
void *data,
const char *chunkname,
const char *mode);</p>
<p>Loads a block of Lua code, but does not run it. If there are no errors, lua_load push a compiled block of code to the top of the stack as a Lua function. Otherwise, push the error message.</p>
<p><code class="docutils literal notranslate"><span class="pre">lua_load</span></code> The return value of can be：</p>
<ul class="simple">
<li><p><strong><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">LUA_OK</span></code></span>:</strong> No error；</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_ERRSYNTAX</span></code>:</strong> Syntax errors encountered during precompilation；</p></li>
<li><p><strong><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">LUA_ERRMEM</span></code></span>:</strong> Memory allocation error；</p></li>
<li><p><strong><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">LUA_ERRGCMM</span></code></span>:</strong> An error occurred while running the <code class="docutils literal notranslate"><span class="pre">__gc</span></code> meta-method. (This error has nothing to do with the code block loading process, it is caused by the garbage collector.。）</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">lua_load</span></code> function uses a user-supplied <code class="docutils literal notranslate"><span class="pre">reader</span></code> function to read a block of code (see <span class="xref myst">lua_Reader</span> ). The <code class="docutils literal notranslate"><span class="pre">data</span></code> parameter is passed into the <code class="docutils literal notranslate"><span class="pre">reader</span></code> function.</p>
<p><code class="docutils literal notranslate"><span class="pre">chunkname</span></code> This parameter can be given a name to the code block, which is used for error information and debugging information (see. <span class="xref myst">§4.9</span>）。</p>
<p><code class="docutils literal notranslate"><span class="pre">lua_load</span></code> It will automatically detect whether the code block is text or binary, and then do the corresponding loading operation (see program <code class="docutils literal notranslate"><span class="pre">luac</span></code>). The string <code class="docutils literal notranslate"><span class="pre">mode</span></code> is the same as the function <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">load</span></code></span>. It can also be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> equivalent to a string “<code class="docutils literal notranslate"><span class="pre">bt</span></code>”。</p>
<p><code class="docutils literal notranslate"><span class="pre">lua_load</span></code> The stack is used internally, so the reader function must always leave the stack as it is each time it returns.</p>
<p>If the returned function has an upper value, the first upper value is set to the global context stored at the LUA_RIDX_GLOBALS index in the registry (see <span class="xref myst">§ 4.5</span>). When the main code block is loaded, this upper value is the <code class="docutils literal notranslate"><span class="pre">_ENV</span></code> variable (see <span class="xref myst">§ 2.2</span>). All other upper values are initialized <strong>nil</strong>。</p>
</section>
<hr class="docutils"/>
<section id="lua-newstate">
<h4><code class="docutils literal notranslate"><span class="pre">lua_newstate</span></code><a class="headerlink" href="#lua-newstate" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>lua_State *lua_newstate (lua_Alloc f, void *ud);</p>
<p>Create a thread that runs in a new independent state machine. Returns <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if the thread or state machine cannot be created (due to limited memory) <code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">Parameter</span> </code>f<code class="docutils literal notranslate"><span class="pre">is</span> <span class="pre">an</span> <span class="pre">allocator</span> <span class="pre">function;</span> <span class="pre">Lua</span> <span class="pre">will</span> <span class="pre">use</span> <span class="pre">this</span> <span class="pre">function</span> <span class="pre">to</span> <span class="pre">do</span> <span class="pre">all</span> <span class="pre">memory</span> <span class="pre">allocation</span> <span class="pre">operations</span> <span class="pre">within</span> <span class="pre">the</span> <span class="pre">state</span> <span class="pre">machine.</span> <span class="pre">The</span> <span class="pre">second</span> <span class="pre">parameter</span></code>ud`, this pointer will be transferred in each call to the allocator.</p>
</section>
<hr class="docutils"/>
<section id="lua-newtable">
<h4><code class="docutils literal notranslate"><span class="pre">lua_newtable</span></code><a class="headerlink" href="#lua-newtable" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>void lua_newtable (lua_State *L);</p>
<p>Create an empty table and stack it. It is equivalent <code class="docutils literal notranslate"><span class="pre">lua_createtable(L,</span> <span class="pre">0,</span> <span class="pre">0)</span></code> 。</p>
</section>
<hr class="docutils"/>
<section id="lua-newthread">
<h4><code class="docutils literal notranslate"><span class="pre">lua_newthread</span></code><a class="headerlink" href="#lua-newthread" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>lua_State *lua_newthread (lua_State *L);</p>
<p>Creates a new thread, pushes it on the stack, and returns the <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_State</span></code></span> pointer that maintains this thread. The new thread returned by this function shares the global context of the original thread, but it has a separate run stack.</p>
<p>There is no explicit function to close or destroy a thread. A thread is one of the garbage collected items like any other Lua object.</p>
</section>
<hr class="docutils"/>
<section id="lua-newuserdata">
<h4><code class="docutils literal notranslate"><span class="pre">lua_newuserdata</span></code><a class="headerlink" href="#lua-newuserdata" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>void *lua_newuserdata (lua_State *L, size_t size);</p>
<p>This function allocates a memory block of the specified size, uses the memory block address as a full user data stack, and returns this address. The host program is free to use this memory.</p>
</section>
<hr class="docutils"/>
<section id="lua-next">
<h4><code class="docutils literal notranslate"><span class="pre">lua_next</span></code><a class="headerlink" href="#lua-next" title="Permalink to this headline">#</a></h4>
<p>[-1, +(2|0), <em>e</em>]</p>
<p>int lua_next (lua_State *L, int index);</p>
<p>Pop a key from the top of the stack, and then push a key-value pair in the table specified by the index (the “next” pair after the popped key). If there are no more elements in the table, then <span class="xref myst">lua_next</span> will return 0 (nothing is pushed on the stack）。</p>
<p>The typical traversal method is like this：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> /\*  Table placed at index't' \*/
 lua\_pushnil(L);  /\* First Key \*/
 while (lua\_next(L, t) != 0) {
   /\* Use 'key' (at index -2) and 'value' (at index -1）\*/
   printf("%s - %s\\n",
          lua\_typename(L, lua\_type(L, -2)),
          lua\_typename(L, lua\_type(L, -1)));
   /\* Remove 'value'; keep 'key' for next iteration \*/
   lua\_pop(L, 1);
 }
</pre></div>
</div>
<p>When traversing a table, do not call <span class="xref myst">lua_tolstring</span> directly on the key, unless you know that the key must be a string. The call to <span class="xref myst">lua_tolstring</span> has the potential to change the value of a given index position; this will affect the next call to <span class="xref myst">lua_next</span>.</p>
<p>See the <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">next</span></code></span> function for a note on modifying the table being iterated during the iteration.</p>
</section>
<hr class="docutils"/>
<section id="lua-number">
<h4><code class="docutils literal notranslate"><span class="pre">lua_Number</span></code><a class="headerlink" href="#lua-number" title="Permalink to this headline">#</a></h4>
<p>typedef double lua_Number;</p>
<p>Lua The type of the floating-point number in.</p>
<p>Lua The type of the number in. The default is double, but you can change it to float. (See in <code class="docutils literal notranslate"><span class="pre">luaconf.h</span></code> <code class="docutils literal notranslate"><span class="pre">LUA_REAL</span></code> 。）</p>
</section>
<hr class="docutils"/>
<section id="lua-numbertointeger">
<h4><code class="docutils literal notranslate"><span class="pre">lua_numbertointeger</span></code><a class="headerlink" href="#lua-numbertointeger" title="Permalink to this headline">#</a></h4>
<p>int lua_numbertointeger (lua_Number n, lua_Integer *p);</p>
<p>Converts a Lua floating-point number to a Lua integer. This macro assumes that <code class="docutils literal notranslate"><span class="pre">n</span></code> has a corresponding integer value. If the value is in the range of Lua integer representation, it is converted to an integer and assigned to <code class="docutils literal notranslate"><span class="pre">*</span> <span class="pre">p</span></code>. The result of the macro is a Boolean quantity that indicates whether the conversion was successful. (Note that due to rounding, this range test is difficult to do correctly without this macro。）</p>
<p>The macro may take multiple values for its parameters.</p>
</section>
<hr class="docutils"/>
<section id="lua-pcall">
<h4><code class="docutils literal notranslate"><span class="pre">lua_pcall</span></code><a class="headerlink" href="#lua-pcall" title="Permalink to this headline">#</a></h4>
<p>[-(nargs + 1), +(nresults|1), –]</p>
<p>int lua_pcall (lua_State *L, int nargs, int nresults, int msgh);</p>
<p>Call a function in protected mode.</p>
<p><code class="docutils literal notranslate"><span class="pre">nargs</span></code> and <code class="docutils literal notranslate"><span class="pre">nresults</span></code> have the same meaning as in <span class="xref myst">lua_call</span>. If no error occurs during the call, <span class="xref myst">lua_pcall</span> behaves exactly the same as <span class="xref myst">lua_call</span>. However, if an error occurs, <span class="xref myst">lua_pcall</span> will catch it, then push the unique value (error message) on the stack, and return the error code. Like <span class="xref myst">lua_call</span>, <span class="xref myst">lua_pcall</span> always removes the function itself and its arguments from the stack.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">msgh</span></code> is 0, the error message returned at the top of the stack is exactly the same as the original error message. Otherwise, <code class="docutils literal notranslate"><span class="pre">msgh</span></code> is treated as the index position of the_error handler_on the stack. (In the current implementation, this index cannot be a pseudo-index.) When a runtime error occurs, this function is called and the parameter is the error message. The return value of the error handling function will be returned on the stack as an error message by <span class="xref myst">lua_pcall</span>.</p>
<p>In typical usage, error handling functions are used to add more debugging information, such as stack trace information, to the error message. After <span class="xref myst">lua_pcall</span> returns, this information cannot be collected because the stack is already expanded.</p>
<p><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_pcall</span></code></span> function returns one of the following constants (defined in <code class="docutils literal notranslate"><span class="pre">lua.h</span></code>)：</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_OK</span></code> (0):</strong> Success.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_ERRRUN</span></code>:</strong> Runtime error.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_ERRMEM</span></code>:</strong> Memory allocation error. For such errors, Lua does not call the error handling function.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_ERRERR</span></code>:</strong> The error that occurred when the error handling function was run.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LUA_ERRGCMM</span></code>:</strong> Error occurred while running the <code class="docutils literal notranslate"><span class="pre">__gc</span></code> meta-method. (This error has nothing to do with the function being called.。）</p></li>
</ul>
</section>
<hr class="docutils"/>
<section id="lua-pcallk">
<h4><code class="docutils literal notranslate"><span class="pre">lua_pcallk</span></code><a class="headerlink" href="#lua-pcallk" title="Permalink to this headline">#</a></h4>
<p>[-(nargs + 1), +(nresults|1), –]</p>
<p>int lua_pcallk (lua_State *L,
int nargs,
int nresults,
int msgh,
lua_KContext ctx,
lua_KFunction k);</p>
<p>The behavior of this function is exactly the same as <span class="xref myst">lua_pcall</span>, except that it also allows the called function to give up (cf. <span class="xref myst">§4.7</span>）。</p>
</section>
<hr class="docutils"/>
<section id="lua-pop">
<h4><code class="docutils literal notranslate"><span class="pre">lua_pop</span></code><a class="headerlink" href="#lua-pop" title="Permalink to this headline">#</a></h4>
<p>[-n, +0, –]</p>
<p>void lua_pop (lua_State *L, int n);</p>
<p>Pop <code class="docutils literal notranslate"><span class="pre">n</span></code> elements from the stack.</p>
</section>
<hr class="docutils"/>
<section id="lua-pushboolean">
<h4><code class="docutils literal notranslate"><span class="pre">lua_pushboolean</span></code><a class="headerlink" href="#lua-pushboolean" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, –]</p>
<p>void lua_pushboolean (lua_State *L, int b);</p>
<p>Put <code class="docutils literal notranslate"><span class="pre">B</span></code> as a Boolean quantity on the stack.</p>
</section>
<hr class="docutils"/>
<section id="lua-pushcclosure">
<h4><code class="docutils literal notranslate"><span class="pre">lua_pushcclosure</span></code><a class="headerlink" href="#lua-pushcclosure" title="Permalink to this headline">#</a></h4>
<p>[-n, +1, <em>e</em>]</p>
<p>void lua_pushcclosure (lua_State *L, lua_CFunction fn, int n);</p>
<p>Put a new C closure on the stack.</p>
<p>When you create a C function, you can associate some values with it, which is creating a C closure (see <span class="xref myst">§ 4.4</span>); these values can then be accessed by the function whenever the function is called. In order to associate some values to a C function, first these values need to be pushed onto the stack (if there are multiple values, the first one is pushed first). Next call <span class="xref myst">lua_pushcclosure</span> to create the closure and push the C function onto the stack. The parameter <code class="docutils literal notranslate"><span class="pre">n</span></code> indicates how many values the function has to associate with the function. <span class="xref myst">lua_pushcclosure</span> will also pop these values off the stack.</p>
<p><code class="docutils literal notranslate"><span class="pre">n</span></code> The maximum value of is 255 。</p>
<p>When <code class="docutils literal notranslate"><span class="pre">n</span></code> is zero, this function creates a lightweight C function, which is a pointer to a C function. In this case, it is not possible to throw a memory error.</p>
</section>
<hr class="docutils"/>
<section id="lua-pushcfunction">
<h4><code class="docutils literal notranslate"><span class="pre">lua_pushcfunction</span></code><a class="headerlink" href="#lua-pushcfunction" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, –]</p>
<p>void lua_pushcfunction (lua_State *L, lua_CFunction f);</p>
<p>Stacks a C function. This function takes a C function pointer and stacks a Lua value of type `function. When this value at the top of the stack is called, the corresponding C function is triggered.</p>
<p>Any function registered to Lua must follow the correct protocol to receive parameters and return values (see <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_CFunction</span></code></span> ）。</p>
<p><code class="docutils literal notranslate"><span class="pre">lua_pushcfunction</span></code> is present as a macro definition：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> #define lua\_pushcfunction(L,f)  lua\_pushcclosure(L,f,0)
</pre></div>
</div>
</section>
<hr class="docutils"/>
<section id="lua-pushfstring">
<h4><code class="docutils literal notranslate"><span class="pre">lua_pushfstring</span></code><a class="headerlink" href="#lua-pushfstring" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>const char *lua_pushfstring (lua_State *L, const char *fmt, …);</p>
<p>Stacks a formatted string and returns a pointer to the string. It is similar to the C function <code class="docutils literal notranslate"><span class="pre">sprintf</span></code>, but with some important differences.：</p>
<ul class="simple">
<li><p>You don’t need to allocate space for the result: the result is a Lua string, and Lua cares about its memory allocation (while freeing up memory through garbage collection.）。</p></li>
<li><p>This conversion is very limited. Symbol, width, precision are not supported. The converter only supports ‘’%%’(insert a character’%’), ‘%s’ (insert a string with zero terminator, no length limit), ‘%f’ (insert a <span class="xref myst">‘ lua_Number</span>), ‘%I’ (insert a <span class="xref myst">‘lua_Integer</span>), ‘%p’ (insert a pointer or a hexadecimal number), ‘’%d’’ (inserts an ‘int’), ‘’%c’’ (inserts a single-byte character denoted by ‘int’), and ‘’%U’’ (inserts a UTF-8 word denoted by ‘long int’）。</p></li>
</ul>
</section>
<hr class="docutils"/>
<section id="lua-pushglobaltable">
<h4><code class="docutils literal notranslate"><span class="pre">lua_pushglobaltable</span></code><a class="headerlink" href="#lua-pushglobaltable" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, –]</p>
<p>void lua_pushglobaltable (lua_State *L);</p>
<p>Stacks the global environment.</p>
</section>
<hr class="docutils"/>
<section id="lua-pushinteger">
<h4><code class="docutils literal notranslate"><span class="pre">lua_pushinteger</span></code><a class="headerlink" href="#lua-pushinteger" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, –]</p>
<p>void lua_pushinteger (lua_State *L, lua_Integer n);</p>
<p>Stacks an integer with the value `n.</p>
</section>
<hr class="docutils"/>
<section id="lua-pushlightuserdata">
<h4><code class="docutils literal notranslate"><span class="pre">lua_pushlightuserdata</span></code><a class="headerlink" href="#lua-pushlightuserdata" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, –]</p>
<p>void lua_pushlightuserdata (lua_State *L, void *p);</p>
<p>Stacks a lightweight user data.</p>
<p>The user data is the C value that is kept in Lua. _lightweight user data_represents a pointer <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span> </code>. It is a value like a number: you don<code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">need</span> <span class="pre">to</span> <span class="pre">create</span> <span class="pre">it</span> <span class="pre">specifically,</span> <span class="pre">it</span> <span class="pre">doesn</span></code>t have a separate meta table, and it won`t be collected (because it never needs to be created). As long as the C addresses represented are the same, the two lightweight user data are equal.</p>
</section>
<hr class="docutils"/>
<section id="lua-pushliteral">
<h4><code class="docutils literal notranslate"><span class="pre">lua_pushliteral</span></code><a class="headerlink" href="#lua-pushliteral" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>const char *lua_pushliteral (lua_State *L, const char *s);</p>
<p>This macro is equivalent to <span class="xref myst">lua_pushstring</span>, except that it can only be used if <code class="docutils literal notranslate"><span class="pre">s</span></code> is a literal. It will automatically give the length of the string.</p>
</section>
<hr class="docutils"/>
<section id="lua-pushlstring">
<h4><code class="docutils literal notranslate"><span class="pre">lua_pushlstring</span></code><a class="headerlink" href="#lua-pushlstring" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>const char *lua_pushlstring (lua_State *L, const char *s, size_t len);</p>
<p>Stacks the string of length <code class="docutils literal notranslate"><span class="pre">len</span></code> pointed to by pointer<code class="docutils literal notranslate"><span class="pre">s.</span> <span class="pre">Lua</span> <span class="pre">makes</span> <span class="pre">an</span> <span class="pre">internal</span> <span class="pre">copy</span> <span class="pre">of</span> <span class="pre">this</span> <span class="pre">string</span> <span class="pre">(or</span> <span class="pre">reuses</span> <span class="pre">a</span> <span class="pre">copy),</span> <span class="pre">so</span> <span class="pre">the</span> <span class="pre">memory</span> <span class="pre">at</span> </code>s` can be released or reused immediately after the function returns. Within the string can be any binary data, including zero characters.</p>
<p>Returns a pointer to the internal copy.</p>
</section>
<hr class="docutils"/>
<section id="lua-pushnil">
<h4><code class="docutils literal notranslate"><span class="pre">lua_pushnil</span></code><a class="headerlink" href="#lua-pushnil" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, –]</p>
<p>void lua_pushnil (lua_State *L);</p>
<p>Stacks a null value.</p>
</section>
<hr class="docutils"/>
<section id="lua-pushnumber">
<h4><code class="docutils literal notranslate"><span class="pre">lua_pushnumber</span></code><a class="headerlink" href="#lua-pushnumber" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, –]</p>
<p>void lua_pushnumber (lua_State *L, lua_Number n);</p>
<p>Stacks a floating point number with a value of `n.</p>
</section>
<hr class="docutils"/>
<section id="lua-pushstring">
<h4><code class="docutils literal notranslate"><span class="pre">lua_pushstring</span></code><a class="headerlink" href="#lua-pushstring" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>const char *lua_pushstring (lua_State *L, const char *s);</p>
<p>Stacks the zero-terminated string pointed to by pointer s. Lua makes an internal copy of this string (or reuses a copy), so the memory at <code class="docutils literal notranslate"><span class="pre">s</span></code> can be released or reused immediately after the function returns.</p>
<p>Returns a pointer to the internal copy.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">s</span></code> is <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, <strong>nil</strong> is pushed and returned <code class="docutils literal notranslate"><span class="pre">NULL</span></code>。</p>
</section>
<hr class="docutils"/>
<section id="lua-pushthread">
<h4><code class="docutils literal notranslate"><span class="pre">lua_pushthread</span></code><a class="headerlink" href="#lua-pushthread" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, –]</p>
<p>int lua_pushthread (lua_State *L);</p>
<p>Stacks the thread represented by `L. If this thread is the main thread of the current state machine, return 1 。</p>
</section>
<hr class="docutils"/>
<section id="lua-pushvalue">
<h4><code class="docutils literal notranslate"><span class="pre">lua_pushvalue</span></code><a class="headerlink" href="#lua-pushvalue" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, –]</p>
<p>void lua_pushvalue (lua_State *L, int index);</p>
<p>Stacks a copy of the element at a given index on the stack.</p>
</section>
<hr class="docutils"/>
<section id="lua-pushvfstring">
<h4><code class="docutils literal notranslate"><span class="pre">lua_pushvfstring</span></code><a class="headerlink" href="#lua-pushvfstring" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>const char *lua_pushvfstring (lua_State *L,
const char *fmt,
va_list argp);</p>
<p>Equivalent to <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_pushfstring</span></code></span>, but with <code class="docutils literal notranslate"><span class="pre">va_list</span></code> instead of a variable number of actual parameters.</p>
</section>
<hr class="docutils"/>
<section id="lua-rawequal">
<h4><code class="docutils literal notranslate"><span class="pre">lua_rawequal</span></code><a class="headerlink" href="#lua-rawequal" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_rawequal (lua_State *L, int index1, int index2);</p>
<p>Returns 1 if index <code class="docutils literal notranslate"><span class="pre">index1</span></code> is equal to the value at index <code class="docutils literal notranslate"><span class="pre">index2</span></code> itself (I. e. no meta method is called). Otherwise it returns 0. Also returns when either index is invalid 0 。</p>
</section>
<hr class="docutils"/>
<section id="lua-rawget">
<h4><code class="docutils literal notranslate"><span class="pre">lua_rawget</span></code><a class="headerlink" href="#lua-rawget" title="Permalink to this headline">#</a></h4>
<p>[-1, +1, –]</p>
<p>int lua_rawget (lua_State *L, int index);</p>
<p>Similar to <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_gettable</span></code></span>, but makes a direct access (does not trigger the meta method）。</p>
</section>
<hr class="docutils"/>
<section id="lua-rawgeti">
<h4><code class="docutils literal notranslate"><span class="pre">lua_rawgeti</span></code><a class="headerlink" href="#lua-rawgeti" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, –]</p>
<p>int lua_rawgeti (lua_State *L, int index, lua_Integer n);</p>
<p>Stacks the value of<code class="docutils literal notranslate"><span class="pre">t[n]</span></code>, where <code class="docutils literal notranslate"><span class="pre">t</span></code> refers to the table at the given index. This is a direct access; that is, it does not trigger the meta method.</p>
<p>Returns the type of the push value.</p>
</section>
<hr class="docutils"/>
<section id="lua-rawgetp">
<h4><code class="docutils literal notranslate"><span class="pre">lua_rawgetp</span></code><a class="headerlink" href="#lua-rawgetp" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, –]</p>
<p>int lua_rawgetp (lua_State *L, int index, const void *p);</p>
<p>Stack the value of<code class="docutils literal notranslate"><span class="pre">t[k]</span></code>, where <code class="docutils literal notranslate"><span class="pre">t</span></code> refers to the table at a given index, and <code class="docutils literal notranslate"><span class="pre">k</span></code> is the lightweight user data corresponding to the pointer `p. This is a direct access; that is, it does not trigger the meta method.</p>
<p>Returns the type of the push value.</p>
</section>
<hr class="docutils"/>
<section id="lua-rawlen">
<h4><code class="docutils literal notranslate"><span class="pre">lua_rawlen</span></code><a class="headerlink" href="#lua-rawlen" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>size_t lua_rawlen (lua_State *L, int index);</p>
<p>Returns the inherent “length” of the value at the given index: for strings, it refers to the length of the string; for tables, it refers to the value that the take length operation (‘’#’’) should get without triggering the meta-method; for user data, it refers to the size of the memory block allocated for that user data; for other values, it is 0 。</p>
</section>
<hr class="docutils"/>
<section id="lua-rawset">
<h4><code class="docutils literal notranslate"><span class="pre">lua_rawset</span></code><a class="headerlink" href="#lua-rawset" title="Permalink to this headline">#</a></h4>
<p>[-2, +0, <em>e</em>]</p>
<p>void lua_rawset (lua_State *L, int index);</p>
<p>Similar to <span class="xref myst">`lua_settable</span>, but does a direct assignment (does not trigger the meta method）。</p>
</section>
<hr class="docutils"/>
<section id="lua-rawseti">
<h4><code class="docutils literal notranslate"><span class="pre">lua_rawseti</span></code><a class="headerlink" href="#lua-rawseti" title="Permalink to this headline">#</a></h4>
<p>[-1, +0, <em>e</em>]</p>
<p>void lua_rawseti (lua_State *L, int index, lua_Integer i);</p>
<p>Equivalent to<code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">[I]</span> <span class="pre">=</span> <span class="pre">v</span></code>, where <code class="docutils literal notranslate"><span class="pre">t</span></code> refers to the table at the given index and <code class="docutils literal notranslate"><span class="pre">v</span></code> is the value at the top of the stack.</p>
<p>This function will pop the value off the stack. The assignment is straightforward; that is, the meta-method is not triggered.</p>
</section>
<hr class="docutils"/>
<section id="lua-rawsetp">
<h4><code class="docutils literal notranslate"><span class="pre">lua_rawsetp</span></code><a class="headerlink" href="#lua-rawsetp" title="Permalink to this headline">#</a></h4>
<p>[-1, +0, <em>e</em>]</p>
<p>void lua_rawsetp (lua_State *L, int index, const void *p);</p>
<p>Equivalent to<code class="docutils literal notranslate"><span class="pre">t[k]</span> <span class="pre">=</span> <span class="pre">v</span></code>, where <code class="docutils literal notranslate"><span class="pre">t</span></code> refers to the table at the given index and <code class="docutils literal notranslate"><span class="pre">k</span></code> is the lightweight user data corresponding to pointer <code class="docutils literal notranslate"><span class="pre">p.</span> <span class="pre">And</span> </code>v` is the value at the top of the stack.</p>
<p>This function will pop the value off the stack. The assignment is straightforward; that is, the meta-method is not triggered.</p>
</section>
<hr class="docutils"/>
<section id="lua-reader">
<h4><code class="docutils literal notranslate"><span class="pre">lua_Reader</span></code><a class="headerlink" href="#lua-reader" title="Permalink to this headline">#</a></h4>
<p>typedef const char * (*lua_Reader) (lua_State *L,
void *data,
size_t *size);</p>
<p><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_load</span></code></span> The reader function used, every time it needs a new block of code, <span class="xref myst">lua_load</span> calls the reader, passing in a parameter <code class="docutils literal notranslate"><span class="pre">data</span></code> each time <code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">The</span> <span class="pre">reader</span> <span class="pre">needs</span> <span class="pre">to</span> <span class="pre">return</span> <span class="pre">a</span> <span class="pre">pointer</span> <span class="pre">to</span> <span class="pre">a</span> <span class="pre">piece</span> <span class="pre">of</span> <span class="pre">memory</span> <span class="pre">containing</span> <span class="pre">the</span> <span class="pre">new</span> <span class="pre">code</span> <span class="pre">block</span> <span class="pre">and</span> <span class="pre">set</span> </code>size<code class="docutils literal notranslate"><span class="pre">to</span> <span class="pre">the</span> <span class="pre">size</span> <span class="pre">of</span> <span class="pre">that</span> <span class="pre">piece</span> <span class="pre">of</span> <span class="pre">memory.</span> <span class="pre">The</span> <span class="pre">memory</span> <span class="pre">block</span> <span class="pre">must</span> <span class="pre">exist</span> <span class="pre">until</span> <span class="pre">the</span> <span class="pre">next</span> <span class="pre">function</span> <span class="pre">is</span> <span class="pre">called.</span> <span class="pre">The</span> <span class="pre">reader</span> <span class="pre">may</span> <span class="pre">indicate</span> <span class="pre">the</span> <span class="pre">end</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">code</span> <span class="pre">block</span> <span class="pre">by</span> <span class="pre">returning</span></code>NULL<code class="docutils literal notranslate"><span class="pre">or</span> <span class="pre">setting</span></code>size` to 0. The reader may return multiple blocks, each of which may have an arbitrary size greater than zero.</p>
</section>
<hr class="docutils"/>
<section id="lua-register">
<h4><code class="docutils literal notranslate"><span class="pre">lua_register</span></code><a class="headerlink" href="#lua-register" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>e</em>]</p>
<p>void lua_register (lua_State *L, const char *name, lua_CFunction f);</p>
<p>Set C function <code class="docutils literal notranslate"><span class="pre">f</span></code> to global variable `name. It is defined by a macro：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> #define lua\_register(L,n,f) \\
        (lua\_pushcfunction(L, f), lua\_setglobal(L, n))
</pre></div>
</div>
</section>
<hr class="docutils"/>
<section id="lua-remove">
<h4><code class="docutils literal notranslate"><span class="pre">lua_remove</span></code><a class="headerlink" href="#lua-remove" title="Permalink to this headline">#</a></h4>
<p>[-1, +0, –]</p>
<p>void lua_remove (lua_State *L, int index);</p>
<p>Removes an element from a given valid index and removes all elements above that index to fill the gap. This function cannot be called with a pseudo index, because the pseudo index does not point to a real location on the stack.</p>
</section>
<hr class="docutils"/>
<section id="lua-replace">
<h4><code class="docutils literal notranslate"><span class="pre">lua_replace</span></code><a class="headerlink" href="#lua-replace" title="Permalink to this headline">#</a></h4>
<p>[-1, +0, –]</p>
<p>void lua_replace (lua_State *L, int index);</p>
<p>The top-of-stack element is placed at a given position without moving other elements (thus overwriting the value at that position), and then the top-of-stack element is popped.</p>
</section>
<hr class="docutils"/>
<section id="lua-resume">
<h4><code class="docutils literal notranslate"><span class="pre">lua_resume</span></code><a class="headerlink" href="#lua-resume" title="Permalink to this headline">#</a></h4>
<p>[-?, +?, –]</p>
<p>int lua_resume (lua_State *L, lua_State *from, int nargs);</p>
<p>Start or continue a coroutation in a given thread 。</p>
<p>To start a coroutine, you need to push the main function and its required parameters into the thread stack. Then call <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_resume</span></code></span> and set <code class="docutils literal notranslate"><span class="pre">nargs</span></code> to the number of parameters. This call will return when the coroutine is suspended or when it finishes running. When the function returns, there will be all the values passed to <span class="xref myst">lua_yield</span> on the stack, or all the return values of the main function. When the coroutine gives up, <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_resume</span></code></span> returns <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">LUA_YIELD</span></code></span>, and if the coroutine ends running without any errors, it returns 0. Returns an error code if there is an error (see <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_pcall</span></code></span> ）。</p>
<p>In the event of an error, the stack is not unrolled, so you can use the debug API to handle it. The error message is placed at the top of the stack.</p>
<p>To continue a coroutine, you need to clear all the results left over from the last <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_yield</span></code></span>, you stack the value that needs to be passed to<code class="docutils literal notranslate"> <span class="pre">yield</span></code> as the result, and then call <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_resume</span></code></span> 。</p>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">from</span></code> indicates from which the coroutation continues <code class="docutils literal notranslate"><span class="pre">L.</span> <span class="pre">If</span> <span class="pre">such</span> <span class="pre">a</span> <span class="pre">coroutage</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">exist,</span> <span class="pre">this</span> <span class="pre">parameter</span> <span class="pre">can</span> <span class="pre">be</span> </code>NULL` 。</p>
</section>
<hr class="docutils"/>
<section id="lua-rotate">
<h4><code class="docutils literal notranslate"><span class="pre">lua_rotate</span></code><a class="headerlink" href="#lua-rotate" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>void lua_rotate (lua_State *L, int idx, int n);</p>
<p>Rotate the elements starting from <code class="docutils literal notranslate"><span class="pre">idx</span></code> to the top of the stack by <code class="docutils literal notranslate"><span class="pre">n</span></code> positions. When <code class="docutils literal notranslate"><span class="pre">n</span></code> is a positive number, the rotation direction is to the top of the stack. When <code class="docutils literal notranslate"><span class="pre">n</span></code> is negative, it rotates <code class="docutils literal notranslate"><span class="pre">-n</span></code> positions to the bottom of the stack. The absolute value of <code class="docutils literal notranslate"><span class="pre">n</span></code> cannot be greater than the slice length of the rotation.</p>
</section>
<hr class="docutils"/>
<section id="lua-setallocf">
<h4><code class="docutils literal notranslate"><span class="pre">lua_setallocf</span></code><a class="headerlink" href="#lua-setallocf" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>void lua_setallocf (lua_State *L, lua_Alloc f, void *ud);</p>
<p>Replace the allocator function of the specified state machine with the one with the user data<code class="docutils literal notranslate"> <span class="pre">ud</span></code> <code class="docutils literal notranslate"><span class="pre">f</span></code> 。</p>
</section>
<hr class="docutils"/>
<section id="lua-setfield">
<h4><code class="docutils literal notranslate"><span class="pre">lua_setfield</span></code><a class="headerlink" href="#lua-setfield" title="Permalink to this headline">#</a></h4>
<p>[-1, +0, <em>e</em>]</p>
<p>void lua_setfield (lua_State *L, int index, const char *k);</p>
<p>Do an operation equivalent to<code class="docutils literal notranslate"><span class="pre">t[k]</span> <span class="pre">=</span> <span class="pre">v</span></code>, where <code class="docutils literal notranslate"><span class="pre">t</span></code> is the value at the given index and <code class="docutils literal notranslate"><span class="pre">v</span></code> is the value at the top of the stack.</p>
<p>This function will pop this value off the stack. As in Lua, this function may trigger a meta-method for a “newindex” event (see <span class="xref myst">§2.4</span>）。</p>
</section>
<hr class="docutils"/>
<section id="lua-setglobal">
<h4><code class="docutils literal notranslate"><span class="pre">lua_setglobal</span></code><a class="headerlink" href="#lua-setglobal" title="Permalink to this headline">#</a></h4>
<p>[-1, +0, <em>e</em>]</p>
<p>void lua_setglobal (lua_State *L, const char *name);</p>
<p>Pop a value off the stack and set it to the new value of the global variable `name.</p>
</section>
<hr class="docutils"/>
<section id="lua-seti">
<h4><code class="docutils literal notranslate"><span class="pre">lua_seti</span></code><a class="headerlink" href="#lua-seti" title="Permalink to this headline">#</a></h4>
<p>[-1, +0, <em>e</em>]</p>
<p>void lua_seti (lua_State *L, int index, lua_Integer n);</p>
<p>Do an operation equivalent to<code class="docutils literal notranslate"><span class="pre">t[n]</span> <span class="pre">=</span> <span class="pre">v</span></code>, where <code class="docutils literal notranslate"><span class="pre">t</span></code> is the value at the given index and <code class="docutils literal notranslate"><span class="pre">v</span></code> is the value at the top of the stack.</p>
<p>This function will pop this value off the stack. As in Lua, this function may trigger a meta-method for a “newindex” event (see <span class="xref myst">§2.4</span>）。</p>
</section>
<hr class="docutils"/>
<section id="lua-setmetatable">
<h4><code class="docutils literal notranslate"><span class="pre">lua_setmetatable</span></code><a class="headerlink" href="#lua-setmetatable" title="Permalink to this headline">#</a></h4>
<p>[-1, +0, –]</p>
<p>void lua_setmetatable (lua_State *L, int index);</p>
<p>Pop a table off the stack and make it the meta table for the value at the given index.</p>
</section>
<hr class="docutils"/>
<section id="lua-settable">
<h4><code class="docutils literal notranslate"><span class="pre">lua_settable</span></code><a class="headerlink" href="#lua-settable" title="Permalink to this headline">#</a></h4>
<p>[-2, +0, <em>e</em>]</p>
<p>void lua_settable (lua_State *L, int index);</p>
<p>Do an operation equivalent to<code class="docutils literal notranslate"><span class="pre">t[k]</span> <span class="pre">=</span> <span class="pre">v</span></code>, where <code class="docutils literal notranslate"><span class="pre">t</span></code> is the value at the given index, <code class="docutils literal notranslate"><span class="pre">v</span></code> is the value at the top of the stack, and <code class="docutils literal notranslate"><span class="pre">k</span></code> is the value below the top of the stack.</p>
<p>This function pops both the key and the value on the stack. As in Lua, this function may trigger a meta-method for a “newindex” event (see <span class="xref myst">§2.4</span>）。</p>
</section>
<hr class="docutils"/>
<section id="lua-settop">
<h4><code class="docutils literal notranslate"><span class="pre">lua_settop</span></code><a class="headerlink" href="#lua-settop" title="Permalink to this headline">#</a></h4>
<p>[-?, +?, –]</p>
<p>void lua_settop (lua_State *L, int index);</p>
<p>The parameter allows any index to be passed in as well as 0. It will set the top of the stack to this index. If the new top of the stack is larger than the original, the excess new elements will be filled with **nil * *. If <code class="docutils literal notranslate"><span class="pre">index</span></code> is 0, all elements on the stack are removed.</p>
</section>
<hr class="docutils"/>
<section id="lua-setuservalue">
<h4><code class="docutils literal notranslate"><span class="pre">lua_setuservalue</span></code><a class="headerlink" href="#lua-setuservalue" title="Permalink to this headline">#</a></h4>
<p>[-1, +0, –]</p>
<p>void lua_setuservalue (lua_State *L, int index);</p>
<p>Pops a value from the stack and sets it as the associated value for the user data at the given index.</p>
</section>
<hr class="docutils"/>
<section id="lua-state">
<h4><code class="docutils literal notranslate"><span class="pre">lua_State</span></code><a class="headerlink" href="#lua-state" title="Permalink to this headline">#</a></h4>
<p>typedef struct lua_State lua_State;</p>
<p>An opaque structure that points to a thread and indirectly (through that thread) references the state of the entire Lua interpreter. The Lua library is fully reentrant: it doesn’t have any global variables. All information about the state machine can be accessed through this structure.</p>
<p>A pointer to this structure must be passed as the first argument to every library function. The exception is <span class="xref myst">lua_newstate</span>, which creates a Lua state machine from scratch.</p>
</section>
<hr class="docutils"/>
<section id="lua-status">
<h4><code class="docutils literal notranslate"><span class="pre">lua_status</span></code><a class="headerlink" href="#lua-status" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_status (lua_State *L);</p>
<p>Returns the status of thread `L.</p>
<p>The normal thread state is 0 ([<code class="docutils literal notranslate"><span class="pre">LUA_OK</span> </code>](#pdf-LUA_ OK)). The status value is the error code when the thread finishes execution with <span class="xref myst">lua_resume</span> and throws an error. If the thread is suspended, the status is <code class="docutils literal notranslate"><span class="pre">LUA_YIELD</span></code> 。</p>
<p>You can only call a function on a thread whose status is [<code class="docutils literal notranslate"><span class="pre">LUA_OK</span> </code>](#pdf-LUA_ OK). You can continue a thread with a status of [<code class="docutils literal notranslate"><span class="pre">LUA_OK</span> </code>](#pdf-LUA_ OK) (for starting a new LUA_YIELD) or a thread with a status of <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">LUA_OK</span></code></span> (for continuing a coroutine）。</p>
</section>
<hr class="docutils"/>
<section id="lua-stringtonumber">
<h4><code class="docutils literal notranslate"><span class="pre">lua_stringtonumber</span></code><a class="headerlink" href="#lua-stringtonumber" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, –]</p>
<p>size_t lua_stringtonumber (lua_State *L, const char *s);</p>
<p>Converts a zero-terminated string <code class="docutils literal notranslate"><span class="pre">s</span></code> to a number, stacks the number, and returns the total length of the string (I. e. length plus one). The result of the conversion may be an integer or a floating point number, depending on Lua`s conversion syntax (see <span class="xref myst">§ 3.1</span>). This string can have leading and trailing spaces and symbols. If the string is not a valid number, returning 0 does not put anything on the stack. (Note that this result can be used as a Boolean quantity, and if it is true, the conversion is successful.。）</p>
</section>
<hr class="docutils"/>
<section id="lua-toboolean">
<h4><code class="docutils literal notranslate"><span class="pre">lua_toboolean</span></code><a class="headerlink" href="#lua-toboolean" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_toboolean (lua_State *L, int index);</p>
<p>Converts the Lua value at a given index to a boolean (0 or 1) in C. As with all tests in Lua, <span class="xref myst">lua_toboolean</span> will return any values other than <strong>false</strong>and<strong>nil</strong> as true; otherwise, it will return false. (If you want to receive only real boolean values, you need to use <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_isboolean</span></code></span> to test the type of the value。）</p>
</section>
<hr class="docutils"/>
<section id="lua-tocfunction">
<h4><code class="docutils literal notranslate"><span class="pre">lua_tocfunction</span></code><a class="headerlink" href="#lua-tocfunction" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>lua_CFunction lua_tocfunction (lua_State *L, int index);</p>
<p>Converts the Lua value at the given index to a C function. This value must be a C function; if not, it returns <code class="docutils literal notranslate"><span class="pre">NULL</span></code> 。</p>
</section>
<hr class="docutils"/>
<section id="lua-tointeger">
<h4><code class="docutils literal notranslate"><span class="pre">lua_tointeger</span></code><a class="headerlink" href="#lua-tointeger" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>lua_Integer lua_tointeger (lua_State *L, int index);</p>
<p>is equivalent to calling [`lua_tointegerx](#lua_tointegerx) with parameter `isnum` `NULL`。</p>
</section>
<hr class="docutils"/>
<section id="lua-tointegerx">
<h4><code class="docutils literal notranslate"><span class="pre">lua_tointegerx</span></code><a class="headerlink" href="#lua-tointegerx" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>lua_Integer lua_tointegerx (lua_State *L, int index, int *isnum);</p>
<p>Converts the Lua value at the given index to the signed integer type <span class="xref myst">lua_Integer</span>. The Lua value must be an integer, or a number or string that can be converted to an integer (see <span class="xref myst">§ 3.4.3</span>); otherwise, lua_tointegerx returns 0 。</p>
<p>If <code class="docutils literal notranslate"><span class="pre">isnum</span></code> is not <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span> <span class="pre">isnum</span></code> will be set to whether the operation was successful.</p>
</section>
<hr class="docutils"/>
<section id="lua-tolstring">
<h4><code class="docutils literal notranslate"><span class="pre">lua_tolstring</span></code><a class="headerlink" href="#lua-tolstring" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>e</em>]</p>
<p>const char *lua_tolstring (lua_State *L, int index, size_t *len);</p>
<p>Converts the Lua value at the given index to a C string. If <code class="docutils literal notranslate"><span class="pre">len</span></code> is not <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, it also sets the string length to <code class="docutils literal notranslate"><span class="pre">*</span> <span class="pre">len.</span> <span class="pre">The</span> <span class="pre">Lua</span> <span class="pre">value</span> <span class="pre">must</span> <span class="pre">be</span> <span class="pre">a</span> <span class="pre">string</span> <span class="pre">or</span> <span class="pre">a</span> <span class="pre">number;</span> <span class="pre">otherwise,</span> </code>NULL<code class="docutils literal notranslate"><span class="pre">is</span> <span class="pre">returned</span></code>. If the value is a number, lua_tolstring will also convert the actual type of that value on the stack to a string_. (When traversing a table, if the lua_tolstring is applied to the key, this conversion may cause <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_next</span></code></span> to be wrong。）</p>
<p><code class="docutils literal notranslate"><span class="pre">lua_tolstring</span></code> Returns an aligned pointer to a string in the Lua state machine. This string always guarantees that the last character (required by C) is zero (‘\0’), and it allows multiple such zeros to be contained within the string.</p>
<p>Because of the possibility of garbage collection in Lua, there is no guarantee that the pointer returned by the lua_tolstring will still be valid after the corresponding value is removed from the stack.</p>
</section>
<hr class="docutils"/>
<section id="lua-tonumber">
<h4><code class="docutils literal notranslate"><span class="pre">lua_tonumber</span></code><a class="headerlink" href="#lua-tonumber" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>lua_Number lua_tonumber (lua_State *L, int index);</p>
<p>is equivalent to calling [`lua_tonumberx](#lua_tonumberx) with parameter `isnum` `NULL`。</p>
</section>
<hr class="docutils"/>
<section id="lua-tonumberx">
<h4><code class="docutils literal notranslate"><span class="pre">lua_tonumberx</span></code><a class="headerlink" href="#lua-tonumberx" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>lua_Number lua_tonumberx (lua_State *L, int index, int *isnum);</p>
<p>Converts the Lua value at the given index to a C type <span class="xref myst">lua_Number</span> (see Lua _Number). This Lua value must be a number or a string that can be converted to a number (see <span class="xref myst">§ 3.4.3</span>); otherwise, <span class="xref myst">lua_tonumberx</span> returns 0 。</p>
<p>If <code class="docutils literal notranslate"><span class="pre">isnum</span></code> is not <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span> <span class="pre">isnum</span></code> will be set to whether the operation was successful.</p>
</section>
<hr class="docutils"/>
<section id="lua-topointer">
<h4><code class="docutils literal notranslate"><span class="pre">lua_topointer</span></code><a class="headerlink" href="#lua-topointer" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>const void *lua_topointer (lua_State *L, int index);</p>
<p>Converts the value at the given index to a generic C pointer (<code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span> </code>). This value can be a user object, a table, a thread, or a function; otherwise, lua_topointer returns NULL `. Different objects have different pointers. There is no way to return a pointer to the original type.</p>
<p>This function is usually only used for debugging information.</p>
</section>
<hr class="docutils"/>
<section id="lua-tostring">
<h4><code class="docutils literal notranslate"><span class="pre">lua_tostring</span></code><a class="headerlink" href="#lua-tostring" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>e</em>]</p>
<p>const char *lua_tostring (lua_State *L, int index);</p>
<p>Equivalent to calling <span class="xref myst">lua_tolstring</span>, whose argument <code class="docutils literal notranslate"><span class="pre">len</span></code> is <code class="docutils literal notranslate"><span class="pre">NULL</span></code> 。</p>
</section>
<hr class="docutils"/>
<section id="lua-tothread">
<h4><code class="docutils literal notranslate"><span class="pre">lua_tothread</span></code><a class="headerlink" href="#lua-tothread" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>lua_State *lua_tothread (lua_State *L, int index);</p>
<p>Converts the value at the given index to a Lua thread (denoted as <code class="docutils literal notranslate"><span class="pre">lua_State</span> <span class="pre">*</span> </code>). This value must be a thread; otherwise the function returns <code class="docutils literal notranslate"><span class="pre">NULL</span></code>。</p>
</section>
<hr class="docutils"/>
<section id="lua-touserdata">
<h4><code class="docutils literal notranslate"><span class="pre">lua_touserdata</span></code><a class="headerlink" href="#lua-touserdata" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>void *lua_touserdata (lua_State *L, int index);</p>
<p>If the value at the given index is a full user data, the function returns the address of its memory block. If the value is a lightweight user data, the pointer it represents is returned. Otherwise, return <code class="docutils literal notranslate"><span class="pre">NULL</span></code> 。</p>
</section>
<hr class="docutils"/>
<section id="lua-type">
<h4><code class="docutils literal notranslate"><span class="pre">lua_type</span></code><a class="headerlink" href="#lua-type" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_type (lua_State *L, int index);</p>
<p>Returns the type of the value at the given valid index, or LUA_TNONE when the index is invalid (or inaccessible) <code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">[</span></code>lua_type](#lua_type) The returned type is encoded as some constant defined in <code class="docutils literal notranslate"><span class="pre">lua.h</span></code>： <code class="docutils literal notranslate"><span class="pre">LUA_TNIL</span></code>， <code class="docutils literal notranslate"><span class="pre">LUA_TNUMBER</span></code>， <code class="docutils literal notranslate"><span class="pre">LUA_TBOOLEAN</span></code>， <code class="docutils literal notranslate"><span class="pre">LUA_TSTRING</span></code>， <code class="docutils literal notranslate"><span class="pre">LUA_TTABLE</span></code>， <code class="docutils literal notranslate"><span class="pre">LUA_TFUNCTION</span></code>， <code class="docutils literal notranslate"><span class="pre">LUA_TUSERDATA</span></code>， <code class="docutils literal notranslate"><span class="pre">LUA_TTHREAD</span></code>， <code class="docutils literal notranslate"><span class="pre">LUA_TLIGHTUSERDATA</span></code>。</p>
</section>
<hr class="docutils"/>
<section id="lua-typename">
<h4><code class="docutils literal notranslate"><span class="pre">lua_typename</span></code><a class="headerlink" href="#lua-typename" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>const char *lua_typename (lua_State *L, int tp);</p>
<p>Returns the name of the type represented by <code class="docutils literal notranslate"><span class="pre">tp</span></code>, which must be one of the possible values returned by <span class="xref myst">lua_type</span>.</p>
</section>
<hr class="docutils"/>
<section id="lua-unsigned">
<h4><code class="docutils literal notranslate"><span class="pre">lua_Unsigned</span></code><a class="headerlink" href="#lua-unsigned" title="Permalink to this headline">#</a></h4>
<p>typedef … lua_Unsigned;</p>
<p><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_Integer</span></code></span> The unsigned version.</p>
</section>
<hr class="docutils"/>
<section id="lua-upvalueindex">
<h4><code class="docutils literal notranslate"><span class="pre">lua_upvalueindex</span></code><a class="headerlink" href="#lua-upvalueindex" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_upvalueindex (int i);</p>
<p>Returns the pseudo-index of the <code class="docutils literal notranslate"><span class="pre">I</span></code> top value of the currently running function (see <span class="xref myst">§ 4.4</span>).</p>
</section>
<hr class="docutils"/>
<section id="lua-version">
<h4><code class="docutils literal notranslate"><span class="pre">lua_version</span></code><a class="headerlink" href="#lua-version" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>v</em>]</p>
<p>const lua_Number *lua_version (lua_State *L);</p>
<p>Returns the address of the version number stored in the Lua kernel. When called, a legal <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_State</span></code></span> is passed in, which returns the address of the version when the state machine was created. If called with <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, return the caller`s version address.</p>
</section>
<hr class="docutils"/>
<section id="lua-writer">
<h4><code class="docutils literal notranslate"><span class="pre">lua_Writer</span></code><a class="headerlink" href="#lua-writer" title="Permalink to this headline">#</a></h4>
<p>typedef int (*lua_Writer) (lua_State *L,
const void* p,
size_t sz,
void* ud);</p>
<p>Writer function used by <span class="xref myst">lua_dump</span>. Each time <span class="xref myst">lua_dump</span> spawns a new block of code, it calls the writer. Pass in the buffer to be written (<code class="docutils literal notranslate"><span class="pre">p</span></code>) and its size (<code class="docutils literal notranslate"><span class="pre">sz</span></code>), and the parameters passed to <span class="xref myst">lua_dump</span> <code class="docutils literal notranslate"><span class="pre">data</span></code> 。</p>
<p>The writer returns an error code: 0 indicates no error; any other value indicates an error and causes <span class="xref myst">lua_dump</span> to stop calling the writer again.</p>
</section>
<hr class="docutils"/>
<section id="lua-xmove">
<h4><code class="docutils literal notranslate"><span class="pre">lua_xmove</span></code><a class="headerlink" href="#lua-xmove" title="Permalink to this headline">#</a></h4>
<p>[-?, +?, –]</p>
<p>void lua_xmove (lua_State *from, lua_State *to, int n);</p>
<p>Swap values in different threads under the same state machine.</p>
<p>This function pops <code class="docutils literal notranslate"><span class="pre">n</span></code> values from the <code class="docutils literal notranslate"><span class="pre">from</span></code> stack and pushes them onto the <code class="docutils literal notranslate"><span class="pre">to</span></code> stack.</p>
</section>
<hr class="docutils"/>
<section id="lua-yield">
<h4><code class="docutils literal notranslate"><span class="pre">lua_yield</span></code><a class="headerlink" href="#lua-yield" title="Permalink to this headline">#</a></h4>
<p>[-?, +?, <em>e</em>]</p>
<p>int lua_yield (lua_State *L, int nresults);</p>
<p>This function is equivalent to calling <span class="xref myst">lua_yieldk</span>, except that the continuation function is not provided (see <span class="xref myst">§ 4.7</span>). Therefore, when the thread is extended, the thread will continue to run the function that called the lua_yield function.</p>
</section>
<hr class="docutils"/>
<section id="lua-yieldk">
<h4><code class="docutils literal notranslate"><span class="pre">lua_yieldk</span></code><a class="headerlink" href="#lua-yieldk" title="Permalink to this headline">#</a></h4>
<p>[-?, +?, <em>e</em>]</p>
<p>int lua_yieldk (lua_State *L,
int nresults,
lua_KContext ctx,
lua_KFunction k);</p>
<p>give up the coroutine (thread）。</p>
<p>When the C function calls <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_yieldk</span></code></span>, the currently running coroutine will be suspended, and the <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_resume</span></code></span> call that started this thread will return. The parameter <code class="docutils literal notranslate"><span class="pre">nresults</span></code> is the number of values returned to <span class="xref myst">lua_resume</span> on the stack.</p>
<p>When the coroutine is continued again, Lua calls the continuation function <code class="docutils literal notranslate"><span class="pre">k</span></code> to continue running the suspended C function (see <span class="xref myst">§ 4.7</span>). The continuation function receives the same stack from the previous function, and the <code class="docutils literal notranslate"><span class="pre">n</span></code> return values in the stack are removed and the parameters passed in from <span class="xref myst">lua_resume</span> are pushed. In addition, the continuation function receives an argument passed to <span class="xref myst">lua_yieldk</span> <code class="docutils literal notranslate"><span class="pre">ctx</span></code>。</p>
<p>Normally, this function does not return; as the coroutine continues over and over again, it continues from the continuation function. However, there is one exception: when the function is called from a hook function that runs line by line (see <span class="xref myst">§ 4.9</span>), the lua_yieldk cannot provide a continuation function. (that is, a form similar to <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_yield</span></code></span>), and in this case, the hook function will return immediately after calling out. Lua will make the coroutine give up. Once the coroutine is continued again, the function that triggered the hook will continue to run normally.</p>
<p>When a thread is in a C call that does not provide a continuation function, calling it will throw an error. Calling it from a thread that is not started with a continuation (for example, the main thread) will do the same.</p>
</section>
</section>
<section id="debug-interface">
<h3>4.9 – Debug Interface<a class="headerlink" href="#debug-interface" title="Permalink to this headline">#</a></h3>
<p>Lua There is no built-in debugging mechanism. But it provides a special set of function interfaces and_hooks_. This set of interfaces can be used to build different debuggers, performance profilers, or other tools that need to get “inside information” from the interpreter.</p>
<hr class="docutils"/>
<section id="lua-debug">
<h4><code class="docutils literal notranslate"><span class="pre">lua_Debug</span></code><a class="headerlink" href="#lua-debug" title="Permalink to this headline">#</a></h4>
<p>typedef struct lua_Debug {
int event;
const char *name;           /* (n) */
const char *namewhat;       /* (n) */
const char *what;           /* (S) */
const char *source;         /* (S) */
int currentline;            /* (l) */
int linedefined;            /* (S) */
int lastlinedefined;        /* (S) */
unsigned char nups;         /* (u) Number of upper values */
unsigned char nparams;      /* (u) Number of parameters */
char isvararg;              /* (u) */
char istailcall;            /* (t) */
char short_src[LUA_IDSIZE]; /* (S) */
/* Private part */
_ Other Domains _
} lua_Debug;</p>
<p>This is a structure that carries various information about a function or activity record. <span class="xref myst">`lua_getstack</span> will only populate the private part of the structure for later use. Calling <span class="xref myst">lua_getinfo</span> fills in <span class="xref myst">lua_Debug</span> those information fields that can be used.</p>
<p>The following is a description of each field of <span class="xref myst">lua_Debug</span>：</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">source</span></code>:</strong> The name of the block of code that created the function. If ‘source’ is preceded by ‘’@’’, it means that the function is defined in a file, and the part after ‘’@’’ is the file name. If ‘source’ is first with ‘’=’’, the rest is determined by user behavior how to represent the source code. In other cases, the function is defined in a string, and ‘source’ is exactly that string.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">short_src</span></code>:</strong> A “printable version” of <code class="docutils literal notranslate"><span class="pre">source</span></code> for error messages.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">linedefined</span></code>:</strong> The line number at which the function definition begins.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">lastlinedefined</span></code>:</strong> The line number at the end of the function definition.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">what</span></code>:</strong> A string <code class="docutils literal notranslate"><span class="pre">"Lua"</span></code> if the function is a Lua function, <code class="docutils literal notranslate"><span class="pre">"C"</span></code> if it is a C function, or if it is the body part of a code block <code class="docutils literal notranslate"><span class="pre">"main"</span></code>。</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">currentline</span></code>:</strong> The line on which the given function is executing. When line number information is not available, <code class="docutils literal notranslate"><span class="pre">currentline</span></code> is set -1 。</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">name</span></code>:</strong> Given a reasonable name for the function. Because functions in Lua are first-class citizens, they have no fixed names: some functions may be the values of global compound variables, others may simply be stored in a field in a table. The lua_getinfo function examines how the function was called to find an appropriate name. If it cannot find a name, <code class="docutils literal notranslate"><span class="pre">name</span></code> is set <code class="docutils literal notranslate"><span class="pre">NULL</span></code> 。</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">namewhat</span></code>:</strong> Used to interpret the <code class="docutils literal notranslate"><span class="pre">name</span></code> domain. The value of <code class="docutils literal notranslate"><span class="pre">namewhat</span></code> can be <code class="docutils literal notranslate"><span class="pre">"global"</span></code>, <code class="docutils literal notranslate"><span class="pre">"local"</span></code>, <code class="docutils literal notranslate"><span class="pre">"method"</span></code>, <code class="docutils literal notranslate"><span class="pre">"field"</span></code>, <code class="docutils literal notranslate"><span class="pre">"upvalue"</span></code>, or <code class="docutils literal notranslate"><span class="pre">""</span></code> (empty string). It depends on how the function is called. (Lua uses an empty string to indicate that other options do not match。）</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">istailcall</span></code>:</strong> This value is true if the function is called as a tail call. In this case, when the layer’s caller is not in the stack.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">nups</span></code>:</strong> The number of upper values of the function.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">nparams</span></code>:</strong> The number of function fixed parameters (for C functions will always be 0 ）。</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">isvararg</span></code>:</strong> True if the function is a variable parameter function (always true for C functions）。</p></li>
</ul>
</section>
<hr class="docutils"/>
<section id="lua-gethook">
<h4><code class="docutils literal notranslate"><span class="pre">lua_gethook</span></code><a class="headerlink" href="#lua-gethook" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>lua_Hook lua_gethook (lua_State *L);</p>
<p>Returns the current hook function.</p>
</section>
<hr class="docutils"/>
<section id="lua-gethookcount">
<h4><code class="docutils literal notranslate"><span class="pre">lua_gethookcount</span></code><a class="headerlink" href="#lua-gethookcount" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_gethookcount (lua_State *L);</p>
<p>Returns the current hook count.</p>
</section>
<hr class="docutils"/>
<section id="lua-gethookmask">
<h4><code class="docutils literal notranslate"><span class="pre">lua_gethookmask</span></code><a class="headerlink" href="#lua-gethookmask" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_gethookmask (lua_State *L);</p>
<p>Returns the current hook mask.</p>
</section>
<hr class="docutils"/>
<section id="lua-getinfo">
<h4><code class="docutils literal notranslate"><span class="pre">lua_getinfo</span></code><a class="headerlink" href="#lua-getinfo" title="Permalink to this headline">#</a></h4>
<p>[-(0|1), +(0|1|2), <em>e</em>]</p>
<p>int lua_getinfo (lua_State *L, const char *what, lua_Debug *ar);</p>
<p>Returns information about a specified function or function call.</p>
<p>When used to get information about a function call, the parameter <code class="docutils literal notranslate"><span class="pre">ar</span></code> must be a valid active record. This record can be the result of a previous call to <span class="xref myst">lua_getstack</span>, or the result of a hook (see <span class="xref myst">lua_Hook</span> ).</p>
<p>When used to obtain information about a function, you can push the function onto the stack and then start the <code class="docutils literal notranslate"><span class="pre">what</span></code> string with the character ``&gt;. (This will cause the lua_getinfo to pop the function from the top of the stack.) For example, to know on which line the function <code class="docutils literal notranslate"><span class="pre">f</span></code> is defined, you can use the following code：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> lua\_Debug ar;
 lua\_getglobal(L, "f");  /\* Get global variables 'f' \*/
 lua\_getinfo(L, "&gt;S", &amp;ar);
 printf("%d\\n", ar.linedefined);
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">what</span></code> Each character in the string filters out some fields in the structure<code class="docutils literal notranslate"><span class="pre">ar</span></code> structure to fill in, or to push a value onto the stack.：</p>
<ul>
<li><p><strong>‘<code class="docutils literal notranslate"><span class="pre">n</span></code>’:</strong> Populating the <code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">namework</span></code> fields；</p></li>
<li><p><strong>‘<code class="docutils literal notranslate"><span class="pre">S</span></code>’:</strong> Fill the fields <code class="docutils literal notranslate"><span class="pre">source</span></code>, <code class="docutils literal notranslate"><span class="pre">linedefined</span></code>, <code class="docutils literal notranslate"><span class="pre">lastlinedefined</span></code>, and <code class="docutils literal notranslate"><span class="pre">what</span></code> with short_src；</p></li>
<li><p><strong>‘<code class="docutils literal notranslate"><span class="pre">l</span></code>’:</strong> Populating the <code class="docutils literal notranslate"><span class="pre">currentline</span></code> field；</p></li>
<li><p><strong>‘<code class="docutils literal notranslate"><span class="pre">t</span></code>’:</strong> Populating the <code class="docutils literal notranslate"><span class="pre">istailcall</span></code> domain；</p></li>
<li><p><strong>‘<code class="docutils literal notranslate"><span class="pre">u</span></code>’:</strong> Populate the <code class="docutils literal notranslate"><span class="pre">nups</span></code>, <code class="docutils literal notranslate"><span class="pre">nparams</span></code>, and <code class="docutils literal notranslate"><span class="pre">isvararg</span></code> fields；</p></li>
<li><p><strong>‘<code class="docutils literal notranslate"><span class="pre">f</span></code>’:</strong> Stacks the function at the specified level in the running.；</p></li>
<li><p><strong>‘<code class="docutils literal notranslate"><span class="pre">L</span></code>’:</strong> A table is stacked, and the integer index in this table is used to describe which rows in the function are valid rows. (_valid line_refers to the line with the actual code, that is, the line where you can put the breakpoint. Invalid lines include blank lines and lines with comments only。）</p>
<p>If this option is used at the same time as option ‘’f’’, the table is stacked after the function.</p>
</li>
</ul>
<p>This function error will return 0 (for example, there is an invalid option in <code class="docutils literal notranslate"><span class="pre">what</span></code>）。</p>
</section>
<hr class="docutils"/>
<section id="lua-getlocal">
<h4><code class="docutils literal notranslate"><span class="pre">lua_getlocal</span></code><a class="headerlink" href="#lua-getlocal" title="Permalink to this headline">#</a></h4>
<p>[-0, +(0|1), –]</p>
<p>const char *lua_getlocal (lua_State *L, const lua_Debug *ar, int n);</p>
<p>Gets information about a local variable from a given activity record or from a function.</p>
<p>For the first case, the parameter <code class="docutils literal notranslate"><span class="pre">ar</span></code> must be a valid active record. This record can be the result of a previous call to <span class="xref myst">lua_getstack</span> or an argument to a hook (see <span class="xref myst">lua_Hook</span> ). The index <code class="docutils literal notranslate"><span class="pre">n</span></code> is used to select which local variable to review; see <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">debug.getlocal</span></code></span> for the description of variable indexes and names.</p>
<p><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_getlocal</span></code></span> Stacks the value of a variable and returns its name.</p>
<p>For the second case, <code class="docutils literal notranslate"><span class="pre">ar</span></code> must be filled with <code class="docutils literal notranslate"><span class="pre">NULL</span> </code>. Functions that need to be probed must be placed at the top of the stack. In this case, only the parameters of the Lua function are visible (there is no information about which other active variables are available) and no values are stacked.</p>
<p>When the index is greater than the number of active local variables, return <code class="docutils literal notranslate"><span class="pre">NULL</span></code> (no stack）</p>
</section>
<hr class="docutils"/>
<section id="lua-getstack">
<h4><code class="docutils literal notranslate"><span class="pre">lua_getstack</span></code><a class="headerlink" href="#lua-getstack" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>int lua_getstack (lua_State *L, int level, lua_Debug *ar);</p>
<p>Gets information about the interpreter’s runtime stack.</p>
<p>This function fills in part of the <span class="xref myst">lua_Debug</span> structure with the_activity record_of the function at the specified level that is running. Layer 0 represents the currently running function, and the function on the_n 1_layer is the one that calls the function on the_n_layer (except for the tail call, which is not included in the stack level). If there are no errors, <span class="xref myst">lua_getstack</span> returns 1; when the level passed in by the call is greater than the stack depth, it returns 0 。</p>
</section>
<hr class="docutils"/>
<section id="lua-getupvalue">
<h4><code class="docutils literal notranslate"><span class="pre">lua_getupvalue</span></code><a class="headerlink" href="#lua-getupvalue" title="Permalink to this headline">#</a></h4>
<p>[-0, +(0|1), –]</p>
<p>const char *lua_getupvalue (lua_State *L, int funcindex, int n);</p>
<p>Gets information about the upper value of a closure. (For Lua functions, the upper values are external local variables that the function needs to use, so these variables are included in the closure.) <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_getupvalue</span></code></span> gets the <code class="docutils literal notranslate"><span class="pre">n</span></code> top value, stacks the value of this top value, and returns its name. The <code class="docutils literal notranslate"><span class="pre">funcindex</span></code> points to the location of the closure on the stack. (Because the upper values are valid throughout the function, they have no particular order. Therefore, they are numbered in alphabetical order。）</p>
<p>Returns <code class="docutils literal notranslate"><span class="pre">NULL</span></code> when the index number is greater than the number of values above (and does not push anything). For C functions, the names of all upper values are empty strings. <code class="docutils literal notranslate"><span class="pre">""</span></code>。</p>
</section>
<hr class="docutils"/>
<section id="lua-hook">
<h4><code class="docutils literal notranslate"><span class="pre">lua_Hook</span></code><a class="headerlink" href="#lua-hook" title="Permalink to this headline">#</a></h4>
<p>typedef void (*lua_Hook) (lua_State *L, lua_Debug *ar);</p>
<p>The type of hook function used for debugging.</p>
<p>Whenever the hook is called, the <code class="docutils literal notranslate"><span class="pre">event</span></code> field in its parameter <code class="docutils literal notranslate"><span class="pre">ar</span></code> is set to the event that fires the hook. Lua defines these events as the following constants: LUA_HOOKCALL, LUA_HOOKRET, LUA_HOOKTAILCALL, LUA_HOOKLINE, LUA_HOOKCOUNT <code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">In</span> <span class="pre">addition,</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">line</span> <span class="pre">event,</span> <span class="pre">the</span> </code>currentline<code class="docutils literal notranslate"><span class="pre">field</span> <span class="pre">is</span> <span class="pre">also</span> <span class="pre">set.</span> <span class="pre">To</span> <span class="pre">get</span> <span class="pre">other</span> <span class="pre">fields</span> <span class="pre">in</span></code>ar<code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">the</span> <span class="pre">hook</span> <span class="pre">must</span> <span class="pre">call</span> <span class="pre">[</span></code>lua_getinfo`](#lua_getinfo) 。</p>
<p>For the call event, <code class="docutils literal notranslate"><span class="pre">event</span></code> can be the usual value for <code class="docutils literal notranslate"><span class="pre">LUA_HOOKCALL,</span> </code>or LUA_HOOKTAILCALL for tail call; in the latter case, there is no corresponding return event.</p>
<p>When Lua runs inside a hook, it masks other calls to the hook. In other words, if a hook function is called back to Lua to execute a function or a block of code, the execution operation will not trigger any hooks.</p>
<p>A hook function cannot have a continuation point, that is, it cannot call <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_yieldk</span></code></span>, <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_pcallk</span></code></span> with a non-empty <code class="docutils literal notranslate"><span class="pre">k</span></code>, or <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_callk</span></code></span>。</p>
<p>The hook function can give up when the following conditions are met: only row count events can give up, and no value can be passed out when giving up; To give up from the hook, [`lua_yield](#lua_yield) must be used to end the operation of the hook, and` nresults` must be zero.</p>
</section>
<hr class="docutils"/>
<section id="lua-sethook">
<h4><code class="docutils literal notranslate"><span class="pre">lua_sethook</span></code><a class="headerlink" href="#lua-sethook" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>void lua_sethook (lua_State *L, lua_Hook f, int mask, int count);</p>
<p>Set up a hook function for debugging.</p>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">f</span></code> is a hook function. <code class="docutils literal notranslate"><span class="pre">mask</span></code> specifies which events are called upon: it consists of the following set of bit constants LUA_MASKCALL, LUA_MASKRET, LUA_MASKLINE, LUA_MASKCOUNT <code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">The</span> <span class="pre">parameter</span> </code>count` is meaningful only if it contains a LUA_MASKCOUNT in the mask. For each event, the case where the hook is called is explained as follows：</p>
<ul class="simple">
<li><p><strong>call hook:</strong> Called when the interpreter calls a function. The hook will be called after Lua enters a new function and before the function takes parameters.</p></li>
<li><p><strong>return hook:</strong> Called when the interpreter returns from a function. The hook will be called at the moment before Lua leaves the function. There is no standard way to access the values returned by the function.</p></li>
<li><p><strong>line hook:</strong> Called when the interpreter is ready to start executing a new line of code, or when jumping into this line of code (even if jumping within the same line). (This event only occurs when Lua executes a Lua function。）</p></li>
<li><p><strong>count hook:</strong> Called after the interpreter executes every <code class="docutils literal notranslate"><span class="pre">count</span></code> instruction. (This event only occurs when Lua executes a Lua function。）</p></li>
</ul>
<p>Hooks can be masked by setting <code class="docutils literal notranslate"><span class="pre">mask</span></code> to zero.</p>
</section>
<hr class="docutils"/>
<section id="lua-setlocal">
<h4><code class="docutils literal notranslate"><span class="pre">lua_setlocal</span></code><a class="headerlink" href="#lua-setlocal" title="Permalink to this headline">#</a></h4>
<p>[-(0|1), +0, –]</p>
<p>const char *lua_setlocal (lua_State *L, const lua_Debug *ar, int n);</p>
<p>Sets the value of a local variable in a given active record. The parameter <code class="docutils literal notranslate"><span class="pre">ar</span></code> is the same as in <code class="docutils literal notranslate"><span class="pre">n</span></code> and <span class="xref myst">lua_getlocal</span> (see <span class="xref myst">lua_getlocal</span> ). <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_setlocal</span></code></span> Assign the value of the top of the stack to the variable and return the name of the variable. It will pop the value from the top of the stack.</p>
<p>When the index is greater than the number of active local variables, return <code class="docutils literal notranslate"><span class="pre">NULL</span></code> (nothing pops up.）。</p>
</section>
<hr class="docutils"/>
<section id="lua-setupvalue">
<h4><code class="docutils literal notranslate"><span class="pre">lua_setupvalue</span></code><a class="headerlink" href="#lua-setupvalue" title="Permalink to this headline">#</a></h4>
<p>[-(0|1), +0, –]</p>
<p>const char *lua_setupvalue (lua_State *L, int funcindex, int n);</p>
<p>Sets the value of the value on the closure. It pops the value at the top of the stack and assigns it to the upper value and returns the name of the upper value. The argument <code class="docutils literal notranslate"><span class="pre">funcindex</span></code> is the same as in <code class="docutils literal notranslate"><span class="pre">n</span></code> and <span class="xref myst">lua_getupvalue</span> (cf. <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_getupvalue</span></code></span> ）。</p>
<p>When the index is greater than the number of upper values, return <code class="docutils literal notranslate"><span class="pre">NULL</span></code> (nothing pops up）。</p>
</section>
<hr class="docutils"/>
<section id="lua-upvalueid">
<h4><code class="docutils literal notranslate"><span class="pre">lua_upvalueid</span></code><a class="headerlink" href="#lua-upvalueid" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>void *lua_upvalueid (lua_State *L, int funcindex, int n);</p>
<p>Returns a unique identifier for the upper value numbered <code class="docutils literal notranslate"><span class="pre">n</span></code> in the closure at index <code class="docutils literal notranslate"><span class="pre">funcindex.</span> <span class="pre">The</span> <span class="pre">parameter</span> </code>funcindex<code class="docutils literal notranslate"><span class="pre">is</span> <span class="pre">the</span> <span class="pre">same</span> <span class="pre">as</span> <span class="pre">in</span></code>n<code class="docutils literal notranslate"><span class="pre">and</span> <span class="pre">[lua_getupvalue](#lua_getupvalue)</span> <span class="pre">(see</span> <span class="pre">[lua_getupvalue](#lua_getupvalue)</span> <span class="pre">).</span> <span class="pre">(But</span></code>n` cannot be greater than the number of upper values.）。</p>
<p>These unique identifiers can be used to detect whether different closures share the same upper value. Lua closures that share the same upper value (that is, they refer to the same external local variable) will return the same identity for this upper value.</p>
</section>
<hr class="docutils"/>
<section id="lua-upvaluejoin">
<h4><code class="docutils literal notranslate"><span class="pre">lua_upvaluejoin</span></code><a class="headerlink" href="#lua-upvaluejoin" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>void lua_upvaluejoin (lua_State *L, int funcindex1, int n1,
int funcindex2, int n2);</p>
<p>Let the <code class="docutils literal notranslate"><span class="pre">n1</span></code> upper value of the Lua closure at index <code class="docutils literal notranslate"><span class="pre">funcindex1</span></code> refer to the <code class="docutils literal notranslate"><span class="pre">n2</span></code> upper value of the Lua closure at index `funcindex2.</p>
</section>
</section>
</section>
<section id="auxiliary-library">
<h2>5 – auxiliary library<a class="headerlink" href="#auxiliary-library" title="Permalink to this headline">#</a></h2>
<p>_ The auxiliary library_provides some convenient functions for programming Lua in C. The base API provides the main functions for C and Lua interaction, while the auxiliary libraries provide higher-order functions for some common tasks.</p>
<p>All functions and types in the auxiliary library are defined in the header file <code class="docutils literal notranslate"><span class="pre">lauxlib.h</span></code> with the prefix <code class="docutils literal notranslate"><span class="pre">luaL_</span></code>。</p>
<p>All functions in the auxiliary library are implemented based on the base API. Therefore, they do not provide any functions that the underlying API cannot implement. Nevertheless, using auxiliary libraries can make your code more robust.</p>
<p>Some helper library functions use some extra stack space internally. When auxiliary libraries use less than five stacks, they don’t check the stack size; they simply assume that the stack is sufficient.</p>
<p>Functions in some auxiliary libraries are used to check the parameters of C functions. Because the error message is formatted to refer to the parameter (for example, “<code class="docutils literal notranslate"><span class="pre">bad</span> <span class="pre">argument</span> <span class="pre">#1</span> </code>“), you should not use these functions for values other than parameters.</p>
<p>If the check fails, the <code class="docutils literal notranslate"><span class="pre">luaL_check</span> <span class="pre">*</span> </code>functions will definitely throw an error.</p>
<section id="id1">
<h3>5.1 – Functions and Types<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p>Here we have listed all the functions and types in the auxiliary library in alphabetized order.</p>
<hr class="docutils"/>
<section id="lual-addchar">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_addchar</span></code><a class="headerlink" href="#lual-addchar" title="Permalink to this headline">#</a></h4>
<p>[-?, +?, <em>e</em>]</p>
<p>void luaL_addchar (luaL_Buffer *B, char c);</p>
<p>Add a byte to cache <code class="docutils literal notranslate"><span class="pre">B</span></code> (see <span class="xref myst">luaL_Buffer</span>) <code class="docutils literal notranslate"><span class="pre">c</span></code>。</p>
</section>
<hr class="docutils"/>
<section id="lual-addlstring">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_addlstring</span></code><a class="headerlink" href="#lual-addlstring" title="Permalink to this headline">#</a></h4>
<p>[-?, +?, <em>e</em>]</p>
<p>void luaL_addlstring (luaL_Buffer *B, const char *s, size_t l);</p>
<p>Add a string <code class="docutils literal notranslate"><span class="pre">s</span></code> of length <code class="docutils literal notranslate"><span class="pre">l</span></code> to cache <code class="docutils literal notranslate"><span class="pre">B</span></code> (see <span class="xref myst">luaL_Buffer</span>) `. This string can contain zeros.</p>
</section>
<hr class="docutils"/>
<section id="lual-addsize">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_addsize</span></code><a class="headerlink" href="#lual-addsize" title="Permalink to this headline">#</a></h4>
<p>[-?, +?, <em>e</em>]</p>
<p>void luaL_addsize (luaL_Buffer *B, size_t n);</p>
<p>Add to cache <code class="docutils literal notranslate"><span class="pre">B</span></code> (see <span class="xref myst">luaL_Buffer</span>) a string of length <code class="docutils literal notranslate"><span class="pre">n</span></code> that was previously copied to buffer (see <span class="xref myst">luaL_prepbuffer</span>).</p>
</section>
<hr class="docutils"/>
<section id="lual-addstring">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_addstring</span></code><a class="headerlink" href="#lual-addstring" title="Permalink to this headline">#</a></h4>
<p>[-?, +?, <em>e</em>]</p>
<p>void luaL_addstring (luaL_Buffer *B, const char *s);</p>
<p>Add a zero-terminated string to cache <code class="docutils literal notranslate"><span class="pre">B</span></code> (see <span class="xref myst">luaL_Buffer</span>) <code class="docutils literal notranslate"><span class="pre">s</span></code>。</p>
</section>
<hr class="docutils"/>
<section id="lual-addvalue">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_addvalue</span></code><a class="headerlink" href="#lual-addvalue" title="Permalink to this headline">#</a></h4>
<p>[-1, +?, <em>e</em>]</p>
<p>void luaL_addvalue (luaL_Buffer *B);</p>
<p>Add a value at the top of the stack to cache <code class="docutils literal notranslate"><span class="pre">B</span></code> (see <span class="xref myst">luaL_Buffer</span>) and then pop it.</p>
<p>This function is the only one that manipulates the string cache that will (and must) put extra elements on the stack. This element will be added to the cache.</p>
</section>
<hr class="docutils"/>
<section id="lual-argcheck">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_argcheck</span></code><a class="headerlink" href="#lual-argcheck" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>v</em>]</p>
<p>void luaL_argcheck (lua_State *L,
int cond,
int arg,
const char *extramsg);</p>
<p>Check if <code class="docutils literal notranslate"><span class="pre">cond</span></code> is true. If it is not true, an error is thrown in the form of standard information (see <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">luaL_argerror</span></code></span>）。</p>
</section>
<hr class="docutils"/>
<section id="lual-argerror">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_argerror</span></code><a class="headerlink" href="#lual-argerror" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>v</em>]</p>
<p>int luaL_argerror (lua_State *L, int arg, const char *extramsg);</p>
<p>Throws an error reporting the problem with the <code class="docutils literal notranslate"><span class="pre">arg</span></code> parameter of the called C function. It uses the following standard information and includes an <code class="docutils literal notranslate"><span class="pre">extramsg</span></code> as an annotation：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> bad argument #_arg_ to '_funcname_' (_extramsg_)
</pre></div>
</div>
<p>This function never returns.</p>
</section>
<hr class="docutils"/>
<section id="lual-buffer">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_Buffer</span></code><a class="headerlink" href="#lual-buffer" title="Permalink to this headline">#</a></h4>
<p>typedef struct luaL_Buffer luaL_Buffer;</p>
<p>_ The type of string cache.</p>
<p>String caching allows C code to segment a Lua string. The use mode is as follows：</p>
<ul class="simple">
<li><p>First define a variable of type <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">luaL_Buffer</span></code></span> <code class="docutils literal notranslate"><span class="pre">b</span></code>。</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">luaL_buffinit(L,</span> <span class="pre">&amp;</span> <span class="pre">B)</span> </code>to initialize it.</p></li>
<li><p>Then call the <code class="docutils literal notranslate"><span class="pre">luaL_add</span> <span class="pre">*</span></code> set of functions to add string fragments to it.</p></li>
<li><p>Last call <code class="docutils literal notranslate"><span class="pre">luaL_pushresult(&amp;</span> <span class="pre">B)</span> </code>. This last call leaves the final string at the top of the stack.</p></li>
</ul>
<p>If you know the length of the result string in advance, you can use the cache like this.：</p>
<ul class="simple">
<li><p>First define a variable of type <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">luaL_Buffer</span></code></span> <code class="docutils literal notranslate"><span class="pre">b</span></code>。</p></li>
<li><p>Then call <code class="docutils literal notranslate"><span class="pre">luaL_buffinitsize(L,</span> <span class="pre">&amp;</span> <span class="pre">B,</span> <span class="pre">sz)</span></code>to pre-allocate a space of size `sz.</p></li>
<li><p>Then copy the string into this space.</p></li>
<li><p>Finally, call <code class="docutils literal notranslate"><span class="pre">luaL_pushresultsize(&amp;</span> <span class="pre">B,</span> <span class="pre">sz)</span></code>, where <code class="docutils literal notranslate"><span class="pre">sz</span></code> refers to the length of the string that has been copied into the cache.</p></li>
</ul>
<p>In general operation, the string cache will use an inconstant number of stack slots. Therefore, in using caching, you cannot assume where the top of the stack is currently. You can use the stack between function calls to the cache operation, just keep the stack balanced; that is, when you make a cache operation call, the stack position at that time is the same as the position after the last cache operation was called. (The only exception is for <span class="xref myst">luaL_addvalue</span>.) After calling <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">luaL_pushresult</span></code></span>, the stack is restored to the position where the cache was initialized and the final string is pushed at the top.</p>
</section>
<hr class="docutils"/>
<section id="lual-buffinit">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_buffinit</span></code><a class="headerlink" href="#lual-buffinit" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>void luaL_buffinit (lua_State *L, luaL_Buffer *B);</p>
<p>Initialize cache <code class="docutils literal notranslate"><span class="pre">B</span></code>. This function does not allocate any space; the cache must be declared as a variable (cf. <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">luaL_Buffer</span></code></span>）。</p>
</section>
<hr class="docutils"/>
<section id="lual-buffinitsize">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_buffinitsize</span></code><a class="headerlink" href="#lual-buffinitsize" title="Permalink to this headline">#</a></h4>
<p>[-?, +?, <em>e</em>]</p>
<p>char *luaL_buffinitsize (lua_State *L, luaL_Buffer *B, size_t sz);</p>
<p>Equivalent to call sequence <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">luaL_buffinit</span></code></span>， <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">luaL_prepbuffsize</span></code></span>。</p>
</section>
<hr class="docutils"/>
<section id="lual-callmeta">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_callmeta</span></code><a class="headerlink" href="#lual-callmeta" title="Permalink to this headline">#</a></h4>
<p>[-0, +(0|1), <em>e</em>]</p>
<p>int luaL_callmeta (lua_State *L, int obj, const char *e);</p>
<p>Call a meta method.</p>
<p>If the object at index <code class="docutils literal notranslate"><span class="pre">obj</span></code> has a meta table and the meta table has field <code class="docutils literal notranslate"><span class="pre">e</span> </code>. This function calls the field with the object as an argument. In this case, the function returns true and the call return value is pushed on the stack. If there is no meta table at that location, or no corresponding meta method, this function returns false (and does not stack anything）。</p>
</section>
<hr class="docutils"/>
<section id="lual-checkany">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_checkany</span></code><a class="headerlink" href="#lual-checkany" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>v</em>]</p>
<p>void luaL_checkany (lua_State *L, int arg);</p>
<p>Checks if the function has parameters of any type (including <strong>nil</strong>) at the <code class="docutils literal notranslate"><span class="pre">arg</span></code> position.</p>
</section>
<hr class="docutils"/>
<section id="lual-checkinteger">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_checkinteger</span></code><a class="headerlink" href="#lual-checkinteger" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>v</em>]</p>
<p>lua_Integer luaL_checkinteger (lua_State *L, int arg);</p>
<p>Checks whether the <code class="docutils literal notranslate"><span class="pre">arg</span></code> parameter of the function is an integer (or can be converted to an integer) and returns the integer value as type <span class="xref myst">lua_Integer</span>.</p>
</section>
<hr class="docutils"/>
<section id="lual-checklstring">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_checklstring</span></code><a class="headerlink" href="#lual-checklstring" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>v</em>]</p>
<p>const char *luaL_checklstring (lua_State *L, int arg, size_t *l);</p>
<p>Check whether the <code class="docutils literal notranslate"><span class="pre">arg</span></code> parameter of the function is a string and return the string; If <code class="docutils literal notranslate"><span class="pre">l</span></code> is not <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, fill in the length of the string <code class="docutils literal notranslate"><span class="pre">*l</span></code>。</p>
<p>This function uses <span class="xref myst">lua_tolstring</span> to get the result. So the function has the potential to cause conversions that are equally valid.</p>
</section>
<hr class="docutils"/>
<section id="lual-checknumber">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_checknumber</span></code><a class="headerlink" href="#lual-checknumber" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>v</em>]</p>
<p>lua_Number luaL_checknumber (lua_State *L, int arg);</p>
<p>Checks whether the <code class="docutils literal notranslate"><span class="pre">arg</span></code> parameter of the function is a number and returns this number.</p>
</section>
<hr class="docutils"/>
<section id="lual-checkoption">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_checkoption</span></code><a class="headerlink" href="#lual-checkoption" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>v</em>]</p>
<p>int luaL_checkoption (lua_State *L,
int arg,
const char *def,
const char *const lst[]);</p>
<p>Check whether the <code class="docutils literal notranslate"><span class="pre">arg</span></code> parameter of the function is a string and look for this string in the array <code class="docutils literal notranslate"><span class="pre">lst</span></code> (e. g. a zero-terminated string array). Returns the index number of the matched string in the array. If the argument is not a string, or if the string does not match in the array, an error is thrown.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">def</span></code> is not <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, the function takes <code class="docutils literal notranslate"><span class="pre">def</span></code> as the default value. The default value takes effect when the parameter <code class="docutils literal notranslate"><span class="pre">arg</span></code> does not exist or the parameter is **nil.</p>
<p>This function is typically used to map strings to C enumerations. (Doing this conversion in the Lua library allows it to use strings instead of numbers to do some options.。）</p>
</section>
<hr class="docutils"/>
<section id="lual-checkstack">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_checkstack</span></code><a class="headerlink" href="#lual-checkstack" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>v</em>]</p>
<p>void luaL_checkstack (lua_State *L, int sz, const char *msg);</p>
<p>Extend stack space to <code class="docutils literal notranslate"><span class="pre">top</span> <span class="pre">sz</span></code> elements. If it does not extend, an error is thrown. <code class="docutils literal notranslate"><span class="pre">msg</span></code> is the extra text for the error message (<code class="docutils literal notranslate"><span class="pre">NULL</span></code> means no extra text is needed）。</p>
</section>
<hr class="docutils"/>
<section id="lual-checkstring">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_checkstring</span></code><a class="headerlink" href="#lual-checkstring" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>v</em>]</p>
<p>const char *luaL_checkstring (lua_State *L, int arg);</p>
<p>Checks whether the <code class="docutils literal notranslate"><span class="pre">arg</span></code> parameter of the function is a string and returns the string.</p>
<p>This function uses <span class="xref myst">lua_tolstring</span> to get the result. So the function has the potential to cause conversions that are equally valid.</p>
</section>
<hr class="docutils"/>
<section id="lual-checktype">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_checktype</span></code><a class="headerlink" href="#lual-checktype" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>v</em>]</p>
<p>void luaL_checktype (lua_State *L, int arg, int t);</p>
<p>Checks if the type of the <code class="docutils literal notranslate"><span class="pre">arg</span></code> parameter of the function is<code class="docutils literal notranslate"><span class="pre">t</span> </code>. See <span class="xref myst">lua_type</span> to look up the encoding of type`t.</p>
</section>
<hr class="docutils"/>
<section id="lual-checkudata">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_checkudata</span></code><a class="headerlink" href="#lual-checkudata" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>v</em>]</p>
<p>void *luaL_checkudata (lua_State *L, int arg, const char *tname);</p>
<p>Check that the <code class="docutils literal notranslate"><span class="pre">arg</span></code> parameter of the function is user data of type <code class="docutils literal notranslate"><span class="pre">tname</span></code> (see <span class="xref myst">luaL_newmetatable</span> ). It returns the address of the user data (see. <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_touserdata</span></code></span>）。</p>
</section>
<hr class="docutils"/>
<section id="lual-checkversion">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_checkversion</span></code><a class="headerlink" href="#lual-checkversion" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>void luaL_checkversion (lua_State *L);</p>
<p>Check that the kernel that called it is the kernel that created the Lua state machine. and whether the code that calls it uses the same Lua version. It also checks whether the kernel that called it and the kernel that created the Lua state machine use the same piece of address space.</p>
</section>
<hr class="docutils"/>
<section id="lual-dofile">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_dofile</span></code><a class="headerlink" href="#lual-dofile" title="Permalink to this headline">#</a></h4>
<p>[-0, +?, <em>e</em>]</p>
<p>int luaL_dofile (lua_State *L, const char *filename);</p>
<p>Loads and runs the specified file. It is defined by the following macro：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> (luaL\_loadfile(L, filename) || lua\_pcall(L, 0, LUA\_MULTRET, 0))
</pre></div>
</div>
<p>If there is no error, the function returns false; if there is an error, it returns true.</p>
</section>
<hr class="docutils"/>
<section id="lual-dostring">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_dostring</span></code><a class="headerlink" href="#lual-dostring" title="Permalink to this headline">#</a></h4>
<p>[-0, +?, –]</p>
<p>int luaL_dostring (lua_State *L, const char *str);</p>
<p>Loads and runs the specified string. It is defined by the following macro：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> (luaL\_loadstring(L, str) || lua\_pcall(L, 0, LUA\_MULTRET, 0))
</pre></div>
</div>
<p>If there is no error, the function returns false; if there is an error, it returns true.</p>
</section>
<hr class="docutils"/>
<section id="lual-error">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_error</span></code><a class="headerlink" href="#lual-error" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>v</em>]</p>
<p>int luaL_error (lua_State *L, const char *fmt, …);</p>
<p>Throws an error. The format of the error message is given by `fmt. Several parameters are provided later, which follow the rules in <span class="xref myst">lua_pushfstring</span>. If available, it also prefaces the message with the file name and line number at the time of the error.</p>
<p>This function never returns. But in C functions the idiom is usually followed： <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">luaL_error(_args_)</span></code> 。</p>
</section>
<hr class="docutils"/>
<section id="lual-execresult">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_execresult</span></code><a class="headerlink" href="#lual-execresult" title="Permalink to this headline">#</a></h4>
<p>[-0, +3, <em>e</em>]</p>
<p>int luaL_execresult (lua_State *L, int stat);</p>
<p>This function is used to generate the return values of standard library and process-related functions. (referring to <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">OS.</span> <span class="pre">execute</span></code></span> and <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">io.close</span></code></span>）。</p>
</section>
<hr class="docutils"/>
<section id="lual-fileresult">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_fileresult</span></code><a class="headerlink" href="#lual-fileresult" title="Permalink to this headline">#</a></h4>
<p>[-0, +(1|3), <em>e</em>]</p>
<p>int luaL_fileresult (lua_State *L, int stat, const char *fname);</p>
<p>This function is used to generate the return values of file-related functions in the standard library. (refers to (<span class="xref myst"><code class="docutils literal notranslate"><span class="pre">io.open</span></code></span>, <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">OS.</span> <span class="pre">rename</span></code></span>, <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">file:seek</span></code></span>, etc.。)。</p>
</section>
<hr class="docutils"/>
<section id="lual-getmetafield">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_getmetafield</span></code><a class="headerlink" href="#lual-getmetafield" title="Permalink to this headline">#</a></h4>
<p>[-0, +(0|1), <em>e</em>]</p>
<p>int luaL_getmetafield (lua_State *L, int obj, const char *e);</p>
<p>Stacks the value of the <code class="docutils literal notranslate"><span class="pre">e</span></code> field in the meta table of the object at index <code class="docutils literal notranslate"><span class="pre">obj.</span> <span class="pre">If</span> <span class="pre">the</span> <span class="pre">object</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">have</span> <span class="pre">a</span> <span class="pre">meta</span> <span class="pre">table,</span> <span class="pre">or</span> <span class="pre">if</span> <span class="pre">the</span> <span class="pre">meta</span> <span class="pre">table</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">have</span> <span class="pre">a</span> <span class="pre">related</span> <span class="pre">field,</span> <span class="pre">this</span> <span class="pre">function</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">stack</span> <span class="pre">anything</span> <span class="pre">and</span> <span class="pre">returns</span> </code>LUA_TNIL`。</p>
</section>
<hr class="docutils"/>
<section id="lual-getmetatable">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_getmetatable</span></code><a class="headerlink" href="#lual-getmetatable" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, –]</p>
<p>int luaL_getmetatable (lua_State *L, const char *tname);</p>
<p>Stack the meta table corresponding to <code class="docutils literal notranslate"><span class="pre">tname</span></code> in the registry (see <span class="xref myst">luaL_newmetatable</span>). If there is no meta table corresponding to <code class="docutils literal notranslate"><span class="pre">tname</span></code>, <strong>nil</strong> is pushed on the stack and false is returned.</p>
</section>
<hr class="docutils"/>
<section id="lual-getsubtable">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_getsubtable</span></code><a class="headerlink" href="#lual-getsubtable" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>int luaL_getsubtable (lua_State *L, int idx, const char *fname);</p>
<p>Make sure<code class="docutils literal notranslate"><span class="pre">t[fname]</span></code>is a table and stack that table. Here <code class="docutils literal notranslate"><span class="pre">t</span></code> refers to the value at index `idx. If it was originally a table, return true; otherwise, create a new table for it and return false.</p>
</section>
<hr class="docutils"/>
<section id="lual-gsub">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_gsub</span></code><a class="headerlink" href="#lual-gsub" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>const char *luaL_gsub (lua_State *L,
const char *s,
const char *p,
const char *r);</p>
<p>Generate a copy of the string <code class="docutils literal notranslate"><span class="pre">s</span></code> and replace all of the string <code class="docutils literal notranslate"><span class="pre">p</span></code> with the string <code class="docutils literal notranslate"><span class="pre">r</span> </code>. Stacks the result string and returns it.</p>
</section>
<hr class="docutils"/>
<section id="lual-len">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_len</span></code><a class="headerlink" href="#lual-len" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>e</em>]</p>
<p>lua_Integer luaL_len (lua_State *L, int index);</p>
<p>Returns the “length” of the value at the given index as a number; it is equivalent to the operation of calling ‘’#’’ in Lua (see <span class="xref myst">§ 3.4.7</span>). If the result of the operation is not an integer, an error is thrown. (This only happens when the meta method is triggered.。）</p>
</section>
<hr class="docutils"/>
<section id="lual-loadbuffer">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_loadbuffer</span></code><a class="headerlink" href="#lual-loadbuffer" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, –]</p>
<p>int luaL_loadbuffer (lua_State *L,
const char *buff,
size_t sz,
const char *name);</p>
<p>Equivalent to <span class="xref myst">luaL_loadbufferx</span> with <code class="docutils literal notranslate"><span class="pre">mode</span></code> parameter equal <code class="docutils literal notranslate"><span class="pre">NULL</span></code>。</p>
</section>
<hr class="docutils"/>
<section id="lual-loadbufferx">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_loadbufferx</span></code><a class="headerlink" href="#lual-loadbufferx" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, –]</p>
<p>int luaL_loadbufferx (lua_State *L,
const char *buff,
size_t sz,
const char *name,
const char *mode);</p>
<p>Load a cache as a block of Lua code. This function uses <span class="xref myst">lua_load</span> to load the memory area of length <code class="docutils literal notranslate"><span class="pre">sz</span></code> pointed to by `buff.</p>
<p>This function returns the same value as <span class="xref myst">lua_load</span>. <code class="docutils literal notranslate"><span class="pre">name</span></code> is the name of the code block used for debugging information and error messages. The role of the <code class="docutils literal notranslate"><span class="pre">mode</span></code> string is the same as that of the function <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_load</span></code></span>。</p>
</section>
<hr class="docutils"/>
<section id="lual-loadfile">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_loadfile</span></code><a class="headerlink" href="#lual-loadfile" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>int luaL_loadfile (lua_State *L, const char *filename);</p>
<p>Equivalent to <span class="xref myst">luaL_loadfilex</span> with <code class="docutils literal notranslate"><span class="pre">mode</span></code> parameter equal <code class="docutils literal notranslate"><span class="pre">NULL</span></code>。</p>
</section>
<hr class="docutils"/>
<section id="lual-loadfilex">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_loadfilex</span></code><a class="headerlink" href="#lual-loadfilex" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>int luaL_loadfilex (lua_State *L, const char *filename,
const char *mode);</p>
<p>Load a file as a Lua code block. This function uses <span class="xref myst">lua_load</span> to load data from a file. The name of the code block is called <code class="docutils literal notranslate"><span class="pre">filename</span> </code>. If <code class="docutils literal notranslate"><span class="pre">filename</span></code> is <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, it is loaded from standard input. If the first line of the file is prefixed with <code class="docutils literal notranslate"><span class="pre">#</span></code>, this line is ignored.</p>
<p><code class="docutils literal notranslate"><span class="pre">mode</span></code> The role of the string is the same as the function <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_load</span></code></span>。</p>
<p>The return value of this function is the same as <span class="xref myst">lua_load</span>, but it may also generate an error code called LUA_ERRFILE. This error occurs when the file cannot be opened or read, or the file has an incorrect mode.</p>
<p>Like <span class="xref myst">lua_load</span>, this function only loads blocks of code and does not run.</p>
</section>
<hr class="docutils"/>
<section id="lual-loadstring">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_loadstring</span></code><a class="headerlink" href="#lual-loadstring" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, –]</p>
<p>int luaL_loadstring (lua_State *L, const char *s);</p>
<p>Loads a string as a Lua code block. This function uses <span class="xref myst">lua_load</span> to load a zero-terminated string <code class="docutils literal notranslate"><span class="pre">s</span></code>。</p>
<p>The return value of this function is the same as <span class="xref myst">lua_load</span>.</p>
<p>Also like <span class="xref myst">lua_load</span>, this function only loads blocks of code and does not run.</p>
</section>
<hr class="docutils"/>
<section id="lual-newlib">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_newlib</span></code><a class="headerlink" href="#lual-newlib" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>void luaL_newlib (lua_State *L, const luaL_Reg l[]);</p>
<p>Create a new table and register the functions in the list `l.</p>
<p>It is implemented with the following macros：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> (luaL\_newlibtable(L,l), luaL\_setfuncs(L,l,0))
</pre></div>
</div>
<p>Array <code class="docutils literal notranslate"><span class="pre">l</span></code> must be an array, not a pointer.</p>
</section>
<hr class="docutils"/>
<section id="lual-newlibtable">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_newlibtable</span></code><a class="headerlink" href="#lual-newlibtable" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>void luaL_newlibtable (lua_State *L, const luaL_Reg l[]);</p>
<p>Create a new table and pre-allocate enough space to hold the contents of array <code class="docutils literal notranslate"><span class="pre">l</span></code> (but not fill it). This is for use with <span class="xref myst">`luaL_setfuncs](#luaL_setfuncs) (cf. [`luaL_newlib`</span>）。</p>
<p>It is implemented as a macro, and the array <code class="docutils literal notranslate"><span class="pre">l</span></code> must be an array, not a pointer.</p>
</section>
<hr class="docutils"/>
<section id="lual-newmetatable">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_newmetatable</span></code><a class="headerlink" href="#lual-newmetatable" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>int luaL_newmetatable (lua_State *L, const char *tname);</p>
<p>Returns 0 if the key <code class="docutils literal notranslate"><span class="pre">tname</span></code> already exists in the registry. Otherwise, create a new table for the meta table of user data. Add <code class="docutils literal notranslate"><span class="pre">__name</span> <span class="pre">=</span> <span class="pre">tname</span></code> key-value pair to this table and add<code class="docutils literal notranslate"><span class="pre">[tname]</span> <span class="pre">=</span> <span class="pre">new</span> <span class="pre">table</span></code> to the registry, returning 1. (<code class="docutils literal notranslate"><span class="pre">__name</span></code> item can be used for some error output functions。）</p>
<p>Both cases will stack the value associated with <code class="docutils literal notranslate"><span class="pre">tname</span></code> in the final registry.</p>
</section>
<hr class="docutils"/>
<section id="lual-newstate">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_newstate</span></code><a class="headerlink" href="#lual-newstate" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>lua_State *luaL_newstate (void);</p>
<p>Create a new Lua state machine. It calls <span class="xref myst">lua_newstate</span> with a memory allocator based on the standard C implementation of the <code class="docutils literal notranslate"><span class="pre">realloc</span></code> function. And set up a panic function (see <span class="xref myst">§ 4.6</span>) that prints some error information to the standard error output to handle fatal errors.</p>
<p>Returns the new state machine. Returns if memory allocation fails <code class="docutils literal notranslate"><span class="pre">NULL</span></code> 。</p>
</section>
<hr class="docutils"/>
<section id="lual-openlibs">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_openlibs</span></code><a class="headerlink" href="#lual-openlibs" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>e</em>]</p>
<p>void luaL_openlibs (lua_State *L);</p>
<p>Opens all Lua standard libraries in the specified state machine.</p>
</section>
<hr class="docutils"/>
<section id="lual-optinteger">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_optinteger</span></code><a class="headerlink" href="#lual-optinteger" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>v</em>]</p>
<p>lua_Integer luaL_optinteger (lua_State *L,
int arg,
lua_Integer d);</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">arg</span></code> argument to the function is an integer (or can be converted to an integer), return that integer. If the parameter does not exist or is <strong>nil</strong>, return <code class="docutils literal notranslate"><span class="pre">d</span> </code>. Other than that, an error is thrown.</p>
</section>
<hr class="docutils"/>
<section id="lual-optlstring">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_optlstring</span></code><a class="headerlink" href="#lual-optlstring" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>v</em>]</p>
<p>const char *luaL_optlstring (lua_State *L,
int arg,
const char *d,
size_t *l);</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">arg</span></code> argument to the function is a string, return that string. If the parameter does not exist or is <strong>nil</strong>, return <code class="docutils literal notranslate"><span class="pre">d</span> </code>. Other than that, an error is thrown.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">l</span></code> is not <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, fill in the length of the result. <code class="docutils literal notranslate"><span class="pre">*l</span></code> 。</p>
</section>
<hr class="docutils"/>
<section id="lual-optnumber">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_optnumber</span></code><a class="headerlink" href="#lual-optnumber" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>v</em>]</p>
<p>lua_Number luaL_optnumber (lua_State *L, int arg, lua_Number d);</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">arg</span></code> argument to the function is a number, return that number. If the parameter does not exist or is <strong>nil</strong>, return <code class="docutils literal notranslate"><span class="pre">d</span> </code>. Other than that, an error is thrown.</p>
</section>
<hr class="docutils"/>
<section id="lual-optstring">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_optstring</span></code><a class="headerlink" href="#lual-optstring" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>v</em>]</p>
<p>const char *luaL_optstring (lua_State *L,
int arg,
const char *d);</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">arg</span></code> argument to the function is a string, return that string. If the parameter does not exist or is <strong>nil</strong>, return <code class="docutils literal notranslate"><span class="pre">d</span> </code>. Other than that, an error is thrown.</p>
</section>
<hr class="docutils"/>
<section id="lual-prepbuffer">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_prepbuffer</span></code><a class="headerlink" href="#lual-prepbuffer" title="Permalink to this headline">#</a></h4>
<p>[-?, +?, <em>e</em>]</p>
<p>char *luaL_prepbuffer (luaL_Buffer *B);</p>
<p>Equivalent to [`luaL_prepbuffsize](#luaL_prepbuffsize) with a predefined size `LUAL_BUFFERSIZE`。</p>
</section>
<hr class="docutils"/>
<section id="lual-prepbuffsize">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_prepbuffsize</span></code><a class="headerlink" href="#lual-prepbuffsize" title="Permalink to this headline">#</a></h4>
<p>[-?, +?, <em>e</em>]</p>
<p>char *luaL_prepbuffsize (luaL_Buffer *B, size_t sz);</p>
<p>Returns a space address of size <code class="docutils literal notranslate"><span class="pre">sz.</span> <span class="pre">You</span> <span class="pre">can</span> <span class="pre">copy</span> <span class="pre">the</span> <span class="pre">string</span> <span class="pre">into</span> <span class="pre">the</span> <span class="pre">cache</span> </code>B<code class="docutils literal notranslate"> <span class="pre">(see</span> <span class="pre">[luaL_Buffer](#luaL_Buffer)).</span> <span class="pre">After</span> <span class="pre">copying</span> <span class="pre">the</span> <span class="pre">string</span> <span class="pre">into</span> <span class="pre">it,</span> <span class="pre">you</span> <span class="pre">must</span> <span class="pre">call</span> <span class="pre">[</span></code>luaL_addsize`](#luaL_addsize) to pass in the size of the string before it will actually be added to the cache.</p>
</section>
<hr class="docutils"/>
<section id="lual-pushresult">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_pushresult</span></code><a class="headerlink" href="#lual-pushresult" title="Permalink to this headline">#</a></h4>
<p>[-?, +1, <em>e</em>]</p>
<p>void luaL_pushresult (luaL_Buffer *B);</p>
<p>End the use of cache <code class="docutils literal notranslate"><span class="pre">B</span></code>, leaving the final string at the top of the stack.</p>
</section>
<hr class="docutils"/>
<section id="lual-pushresultsize">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_pushresultsize</span></code><a class="headerlink" href="#lual-pushresultsize" title="Permalink to this headline">#</a></h4>
<p>[-?, +1, <em>e</em>]</p>
<p>void luaL_pushresultsize (luaL_Buffer *B, size_t sz);</p>
<p>equivalent <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">luaL_addsize</span></code></span>，<span class="xref myst"><code class="docutils literal notranslate"><span class="pre">luaL_pushresult</span></code></span>。</p>
</section>
<hr class="docutils"/>
<section id="lual-ref">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_ref</span></code><a class="headerlink" href="#lual-ref" title="Permalink to this headline">#</a></h4>
<p>[-1, +0, <em>e</em>]</p>
<p>int luaL_ref (lua_State *L, int t);</p>
<p>For the object at the top of the stack, create and return a_reference_in the table pointed to by the index<code class="docutils literal notranslate"> <span class="pre">t</span></code> (the top of the stack object will be popped up at the end）。</p>
<p>This reference is a unique integer key. As long as you don<code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">manually</span> <span class="pre">add</span> <span class="pre">integer</span> <span class="pre">keys</span> <span class="pre">to</span> <span class="pre">table</span> </code>t<code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">[luaL_ref](#luaL_ref)</span> <span class="pre">guarantees</span> <span class="pre">the</span> <span class="pre">uniqueness</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">keys</span> <span class="pre">it</span> <span class="pre">returns.</span> <span class="pre">You</span> <span class="pre">can</span> <span class="pre">retrieve</span> <span class="pre">the</span> <span class="pre">object</span> <span class="pre">referenced</span> <span class="pre">by</span> </code>r<code class="docutils literal notranslate"><span class="pre">by</span> <span class="pre">calling</span></code>lua_rawgeti(L, t, r). Function <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">luaL_unref</span> </code></span> is used to release a reference to the associated object</p>
<p>If the object at the top of the stack is <strong>nil</strong>, <span class="xref myst">luaL_ref</span> will return the constant LUA_REFNIL `. The constant LUA_NOREF can be guaranteed to be different from other reference values returned by <span class="xref myst">luaL_ref</span>.</p>
</section>
<hr class="docutils"/>
<section id="lual-reg">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_Reg</span></code><a class="headerlink" href="#lual-reg" title="Permalink to this headline">#</a></h4>
<p>typedef struct luaL_Reg {
const char *name;
lua_CFunction func;
} luaL_Reg;</p>
<p>The array type used for the <span class="xref myst">luaL_setfuncs</span> registration function. <code class="docutils literal notranslate"><span class="pre">name</span></code> is the function name, and <code class="docutils literal notranslate"><span class="pre">func</span></code> is the function pointer. Any [<code class="docutils literal notranslate"><span class="pre">luaL_Reg](#luaL_Reg)</span> <span class="pre">array</span> <span class="pre">must</span> <span class="pre">end</span> <span class="pre">with</span> <span class="pre">the</span> <span class="pre">pair</span> </code>name<code class="docutils literal notranslate"><span class="pre">and</span></code>func<code class="docutils literal notranslate"><span class="pre">both</span> <span class="pre">being</span></code>NULL.</p>
</section>
<hr class="docutils"/>
<section id="lual-requiref">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_requiref</span></code><a class="headerlink" href="#lual-requiref" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>void luaL_requiref (lua_State *L, const char *modname,
lua_CFunction openf, int glb);</p>
<p>If <code class="docutils literal notranslate"><span class="pre">modname</span></code> is not in <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">package.loaded</span></code></span>, the function <code class="docutils literal notranslate"><span class="pre">openf</span></code> is called and the string <code class="docutils literal notranslate"><span class="pre">modname</span></code> is passed in <code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">Put</span> <span class="pre">its</span> <span class="pre">return</span> <span class="pre">value</span> <span class="pre">into</span> </code>package.loaded[modname]<code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">This</span> <span class="pre">behaves</span> <span class="pre">as</span> <span class="pre">if</span> <span class="pre">the</span> <span class="pre">function</span> <span class="pre">had</span> <span class="pre">been</span> <span class="pre">called</span> <span class="pre">through</span> <span class="pre">[</span></code>require`](#pdf-require).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">glb</span></code> is true, the module is also set to the global variable `modname.</p>
<p>Leave a copy of the module on the stack.</p>
</section>
<hr class="docutils"/>
<section id="lual-setfuncs">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_setfuncs</span></code><a class="headerlink" href="#lual-setfuncs" title="Permalink to this headline">#</a></h4>
<p>[-nup, +0, <em>e</em>]</p>
<p>void luaL_setfuncs (lua_State *L, const luaL_Reg *l, int nup);</p>
<p>Register all functions in array <code class="docutils literal notranslate"><span class="pre">l</span></code> (see <span class="xref myst">luaL_Reg</span>) in a table at the top of the stack (the table is below the optional upper value, see the explanation below）。</p>
<p>If <code class="docutils literal notranslate"><span class="pre">nup</span></code> is not zero, all functions share <code class="docutils literal notranslate"><span class="pre">nup</span></code> values. These values must be pressed on the table before the call. These values are popped from the stack after registration.</p>
</section>
<hr class="docutils"/>
<section id="lual-setmetatable">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_setmetatable</span></code><a class="headerlink" href="#lual-setmetatable" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>void luaL_setmetatable (lua_State *L, const char *tname);</p>
<p>Set the <code class="docutils literal notranslate"><span class="pre">tname</span></code> associated meta table (see <span class="xref myst">luaL_newmetatable</span>) in the registry as the meta table of the top-of-stack object.</p>
</section>
<hr class="docutils"/>
<section id="lual-stream">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_Stream</span></code><a class="headerlink" href="#lual-stream" title="Permalink to this headline">#</a></h4>
<p>typedef struct luaL_Stream {
FILE *f;
lua_CFunction closef;
} luaL_Stream;</p>
<p>The standard file handle structure used in the standard input and output library.</p>
<p>The file handle is implemented as a full user data whose meta-table is called a LUA_FILEHANDLE (LUA_FILEHANDLE is a macro that represents the name of the real meta-table). This meta table is created by the standard input/output library (see <span class="xref myst">luaL_newmetatable</span>).</p>
<p>User data must begin with the structure luaL_Stream; this structure can be followed by any other data. The <code class="docutils literal notranslate"><span class="pre">f</span></code> field points to a C data stream (if it is <code class="docutils literal notranslate"><span class="pre">NULL</span></code> it means an uncreated handle). The <code class="docutils literal notranslate"><span class="pre">closef</span></code> field points to a Lua function that needs to be called when the stream is closed or recycled. The function will receive one argument, the file handle. It needs to return <strong>true</strong> (the operation succeeded) or <strong>nil</strong> plus an error message (when an error occurs). Once Lua calls this field, the value of the field is changed to <code class="docutils literal notranslate"><span class="pre">NULL</span></code> to indicate that the handle has been closed.</p>
</section>
<hr class="docutils"/>
<section id="lual-testudata">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_testudata</span></code><a class="headerlink" href="#lual-testudata" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, <em>e</em>]</p>
<p>void *luaL_testudata (lua_State *L, int arg, const char *tname);</p>
<p>This function is similar to <span class="xref myst">luaL_checkudata</span>. But it returns <code class="docutils literal notranslate"><span class="pre">NULL</span></code> instead of throwing an error when the test fails.</p>
</section>
<hr class="docutils"/>
<section id="lual-tolstring">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_tolstring</span></code><a class="headerlink" href="#lual-tolstring" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>const char *luaL_tolstring (lua_State *L, int idx, size_t *len);</p>
<p>Converts the Lua value at the given index to a C string in the appropriate format. The result string will not only be pushed on the stack, but will also be returned by the function. If <code class="docutils literal notranslate"><span class="pre">len</span></code> is not <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, it also sets the string length to `* len.</p>
<p>If the value has a meta table with <code class="docutils literal notranslate"><span class="pre">__tostring</span></code> field, the luaL_tolstring calls the corresponding meta method with the value as the parameter and returns the value as the result.</p>
</section>
<hr class="docutils"/>
<section id="lual-traceback">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_traceback</span></code><a class="headerlink" href="#lual-traceback" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>void luaL_traceback (lua_State *L, lua_State *L1, const char *msg,
int level);</p>
<p>Stack backtracking information of stack <code class="docutils literal notranslate"><span class="pre">L1</span></code> is pressed. If <code class="docutils literal notranslate"><span class="pre">msg</span></code> is not <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, it will be appended to the stack before the backtrace information. The <code class="docutils literal notranslate"><span class="pre">level</span></code> parameter indicates the layer from which to do stack backtracking.</p>
</section>
<hr class="docutils"/>
<section id="lual-typename">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_typename</span></code><a class="headerlink" href="#lual-typename" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>const char *luaL_typename (lua_State *L, int index);</p>
<p>Returns the type name of the value at the given index.</p>
</section>
<hr class="docutils"/>
<section id="lual-unref">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_unref</span></code><a class="headerlink" href="#lual-unref" title="Permalink to this headline">#</a></h4>
<p>[-0, +0, –]</p>
<p>void luaL_unref (lua_State *L, int t, int ref);</p>
<p>Releases the <code class="docutils literal notranslate"><span class="pre">ref</span></code> reference object for the table at index <code class="docutils literal notranslate"><span class="pre">t</span></code> (see <span class="xref myst">luaL_ref</span> ). This entry is removed from the table to make the object it references available for garbage collection. The reference <code class="docutils literal notranslate"><span class="pre">ref</span></code> is also recycled for reuse.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">ref</span></code> is <span class="xref myst">LUA_NOREF</span> or <span class="xref myst">LUA_REFNIL</span>, <span class="xref myst">luaL_unref</span> does nothing.</p>
</section>
<hr class="docutils"/>
<section id="lual-where">
<h4><code class="docutils literal notranslate"><span class="pre">luaL_where</span></code><a class="headerlink" href="#lual-where" title="Permalink to this headline">#</a></h4>
<p>[-0, +1, <em>e</em>]</p>
<p>void luaL_where (lua_State *L, int lvl);</p>
<p>A string representing the control point location of the <code class="docutils literal notranslate"><span class="pre">lvl</span></code> layer stack is stacked. This string follows the following format：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> _chunkname_:_currentline_:
</pre></div>
</div>
<p>0 Layer refers to the currently running function, layer 1 refers to the function that calls the running function, and so on.</p>
<p>This function is used to construct the prefix of the error message.</p>
</section>
</section>
</section>
<section id="standard-library">
<h2>6 – Standard Library<a class="headerlink" href="#standard-library" title="Permalink to this headline">#</a></h2>
<p>The standard library provides some useful functions that are implemented directly in the C API. Some of these functions provide services that are native to the language (e. g.,<span class="xref myst"><code class="docutils literal notranslate"><span class="pre">type</span></code></span> and <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">getmetatable</span></code></span>); Others provide services that deal with “external” (e. g. I/O ); Still others could have been implemented in Lua itself, but implemented in C can meet key performance requirements (e. g. <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">table.sort</span></code></span>）。</p>
<p>All libraries are implemented directly in the C API and are provided as separate C modules. Currently, Lua has the following standard libraries：</p>
<ul class="simple">
<li><p>Base Library (<span class="xref myst">§6.1</span>);</p></li>
<li><p>Synergy Library (<span class="xref myst">§6.2</span>);</p></li>
<li><p>Package Management Library (<span class="xref myst">§6.3</span>);</p></li>
<li><p>String Control (<span class="xref myst">§6.4</span>);</p></li>
<li><p>Basic UTF-8 support (<span class="xref myst">§6.5</span>);</p></li>
<li><p>Table Control (<span class="xref myst">§6.6</span>);</p></li>
<li><p>Mathematical functions (<span class="xref myst">§ 6.7</span>) (sin ,log, etc.);</p></li>
<li><p>Input Output (<span class="xref myst">§6.8</span>);</p></li>
<li><p>Operating System Library (<span class="xref myst">§6.9</span>);</p></li>
<li><p>Debug Library (<span class="xref myst">§6.10</span>).</p></li>
</ul>
<p>With the exception of the base library and the package management library, all libraries place their functions in a domain of a global table, or provide them as object methods.</p>
<p>To use these libraries, the C host program needs to call the <span class="xref myst">luaL_openlibs</span> function, which opens all the standard libraries. Or the host program can use <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">luaL_requiref</span></code></span> to open these libraries respectively: <code class="docutils literal notranslate"><span class="pre">luaopen_base</span></code> (basic library), <code class="docutils literal notranslate"><span class="pre">luaopen_package</span></code> (package management library), <code class="docutils literal notranslate"><span class="pre">luaopen_coroutine</span></code> (coroutine library), <code class="docutils literal notranslate"><span class="pre">luaopen_string</span></code> (string library), <code class="docutils literal notranslate"><span class="pre">luaopen_utf8</span></code> (UTF8 library), <code class="docutils literal notranslate"><span class="pre">luaopen_table</span></code> (table processing library), <code class="docutils literal notranslate"><span class="pre">luaopen_math</span></code> (math library), luaopen_io (I/O library), luaopen_ OS (operating system library), luaopen_debug (debug library). These functions are defined in `lualib.h.</p>
<section id="basic-function">
<h3>6.1 – basic function<a class="headerlink" href="#basic-function" title="Permalink to this headline">#</a></h3>
<p>The base library provides the Lua core functions. If you don’t include this library in your program, you need to be careful to check whether the program needs to provide its own implementation of some of these features.</p>
<hr class="docutils"/>
<section id="assert-v-message">
<h4><code class="docutils literal notranslate"><span class="pre">assert</span> <span class="pre">(v</span> <span class="pre">[,</span> <span class="pre">message])</span></code><a class="headerlink" href="#assert-v-message" title="Permalink to this headline">#</a></h4>
<p>If the value of its parameter <code class="docutils literal notranslate"><span class="pre">v</span></code> is false (<strong>nil</strong>or<strong>false</strong>), it calls <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">error</span></code></span>; otherwise, it returns all the parameters. In the case of an error, <code class="docutils literal notranslate"><span class="pre">message</span></code> refers to that error object; if this parameter is not supplied, the parameter defaults “<code class="docutils literal notranslate"><span class="pre">assertion</span> <span class="pre">failed!</span></code>” 。</p>
</section>
<hr class="docutils"/>
<section id="collectgarbage-opt-arg">
<h4><code class="docutils literal notranslate"><span class="pre">collectgarbage</span> <span class="pre">([opt</span> <span class="pre">[,</span> <span class="pre">arg]])</span></code><a class="headerlink" href="#collectgarbage-opt-arg" title="Permalink to this headline">#</a></h4>
<p>This function is a common interface to the garbage collector. With the parameter <code class="docutils literal notranslate"><span class="pre">opt</span></code> it provides a different set of functions：</p>
<ul class="simple">
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">collect</span></code>”:</strong> Do a full garbage collection cycle. This is the default option.</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">stop</span></code>”:</strong> Stops the garbage collector from running. The collector will only run as a result of an explicit call before a restart is called.</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">restart</span></code>”:</strong> Restart the automatic run of the garbage collector.</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">count</span></code>”:</strong> Returns the total memory used by Lua in K bytes. This value has a decimal part, so you only need to multiply 1024 to get the exact number of bytes used by Lua (unless overflow）。</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">step</span></code>”:</strong> Step into the garbage collector. The step size is controlled by `arg. When 0 is passed in, the collector is stepped (indivisible) by one step. Passing in a non-zero value, the collector collects the equivalent of Lua allocating these multiple (K bytes) of memory. If the collector ends a loop will return <strong>true</strong> 。</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">setpause</span></code>”:</strong> Set <code class="docutils literal notranslate"><span class="pre">arg</span></code> to the collector`s_intermittent rate_(see <span class="xref myst">§ 2.5</span>). Returns the previous value of_intermittent rate.</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">setstepmul</span></code>”:</strong> Set <code class="docutils literal notranslate"><span class="pre">arg</span></code> to the_step factor_of the collector (see <span class="xref myst">§ 2.5</span>). Returns the previous value of_step magnification.</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">isrunning</span></code>”:</strong> Returns a Boolean value that indicates whether the collector is working (that is, not stopped.）。</p></li>
</ul>
</section>
<hr class="docutils"/>
<section id="dofile-filename">
<h4><code class="docutils literal notranslate"><span class="pre">dofile</span> <span class="pre">([filename])</span></code><a class="headerlink" href="#dofile-filename" title="Permalink to this headline">#</a></h4>
<p>Open the file with that name and execute the Lua code block in the file. When called without parameters, <code class="docutils literal notranslate"><span class="pre">dofile</span></code> performs the contents of the standard input (<code class="docutils literal notranslate"><span class="pre">stdin</span></code>). Returns all return values for this code block. For the case of errors, <code class="docutils literal notranslate"><span class="pre">dofile</span></code> feeds back the error to the caller (ie, <code class="docutils literal notranslate"><span class="pre">dofile</span></code> is not running in protected mode）。</p>
</section>
<hr class="docutils"/>
<section id="error-message-level">
<h4><code class="docutils literal notranslate"><span class="pre">error</span> <span class="pre">(message</span> <span class="pre">[,</span> <span class="pre">level])</span></code><a class="headerlink" href="#error-message-level" title="Permalink to this headline">#</a></h4>
<p>Aborts the last protection function call, returning the error object <code class="docutils literal notranslate"><span class="pre">message.</span> <span class="pre">The</span> <span class="pre">function</span> </code>error` never returns.</p>
<p>When the message is a string, <code class="docutils literal notranslate"><span class="pre">error</span></code> usually prepends some information about where the error occurred. The <code class="docutils literal notranslate"><span class="pre">level</span></code> parameter indicates how to obtain the error location. For level 1 (the default), the error location refers to the location of the <code class="docutils literal notranslate"><span class="pre">error</span></code> function call. Level 2 points the error location to the function calling the function of <code class="docutils literal notranslate"><span class="pre">error</span></code>; and so on. Pass-in level 0 to avoid adding error location information before the message.</p>
</section>
<hr class="docutils"/>
<section id="g">
<h4><code class="docutils literal notranslate"><span class="pre">_G</span></code><a class="headerlink" href="#g" title="Permalink to this headline">#</a></h4>
<p>A global variable (not a function) that internally stores the global environment (see <span class="xref myst">§ 2.2</span>). Lua does not use this variable itself; changing the value of this variable does not affect any environment, and vice versa.</p>
</section>
<hr class="docutils"/>
<section id="getmetatable-object">
<h4><code class="docutils literal notranslate"><span class="pre">getmetatable</span> <span class="pre">(object)</span></code><a class="headerlink" href="#getmetatable-object" title="Permalink to this headline">#</a></h4>
<p>If <code class="docutils literal notranslate"><span class="pre">object</span></code> does not contain a meta table, <strong>nil</strong> is returned. Otherwise, return its associated value if there is a <code class="docutils literal notranslate"><span class="pre">"__metatable"</span></code> field in the object<code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">meta</span> <span class="pre">table,</span> <span class="pre">and</span> <span class="pre">return</span> <span class="pre">the</span> <span class="pre">object</span></code>s meta table if not.</p>
</section>
<hr class="docutils"/>
<section id="ipairs-t">
<h4><code class="docutils literal notranslate"><span class="pre">ipairs</span> <span class="pre">(t)</span></code><a class="headerlink" href="#ipairs-t" title="Permalink to this headline">#</a></h4>
<p>returns three values (iterated function, table <code class="docutils literal notranslate"><span class="pre">t</span></code>, and 0 ), so the following code</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> for i,v in ipairs(t) do _body_ end
</pre></div>
</div>
<p>The key-value pairs (<code class="docutils literal notranslate"><span class="pre">1,t[1]</span></code>) ,(<code class="docutils literal notranslate"><span class="pre">2,t[2]</span></code>),… will be iterated until the first null value.</p>
</section>
<hr class="docutils"/>
<section id="load-chunk-chunkname-mode-env">
<h4><code class="docutils literal notranslate"><span class="pre">load</span> <span class="pre">(chunk</span> <span class="pre">[,</span> <span class="pre">chunkname</span> <span class="pre">[,</span> <span class="pre">mode</span> <span class="pre">[,</span> <span class="pre">env]]])</span></code><a class="headerlink" href="#load-chunk-chunkname-mode-env" title="Permalink to this headline">#</a></h4>
<p>Load a block of code.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">chunk</span></code> is a string, the code block refers to this string. If <code class="docutils literal notranslate"><span class="pre">chunk</span></code> is a function, <code class="docutils literal notranslate"><span class="pre">load</span></code> keeps calling it to get snippets of code blocks. Each call to <code class="docutils literal notranslate"><span class="pre">chunk</span></code> must return a string immediately after the return string of the previous call. When an empty string is returned, <strong>nil</strong>, or no value is returned, the code block is over.</p>
<p>Returns a compiled block of code as a function if there are no syntax errors; otherwise, returns <strong>nil</strong> plus an error message.</p>
<p>If the result function has an upper value, <code class="docutils literal notranslate"><span class="pre">env</span></code> is set to the first upper value. If this parameter is not supplied, the global environment overrides it. All other upper values are initialized to **nil * *. (When you load the main code block, the result function must have only one upper value <code class="docutils literal notranslate"><span class="pre">_ENV</span></code> (see <span class="xref myst">§ 2.2</span>)). However, if you load a block of binary code created with a function (see <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">string.dump</span></code></span>, the resulting function can have any number of upper values), all the upper values are newly created. This means that they are not shared with any other functions.</p>
<p><code class="docutils literal notranslate"><span class="pre">chunkname</span></code> In error messages and debug messages (see <span class="xref myst">§ 4.9</span>), the name used for the code block. If this parameter is not supplied, it defaults to the string <code class="docutils literal notranslate"><span class="pre">chunk</span> </code>. If <code class="docutils literal notranslate"><span class="pre">chunk</span></code> is not a string, otherwise “<code class="docutils literal notranslate"><span class="pre">=(load)</span></code>” 。</p>
<p>The string <code class="docutils literal notranslate"><span class="pre">mode</span></code> is used to control whether the code block is text or binary (that is, a precompiled code block). It can be the string “<code class="docutils literal notranslate"><span class="pre">B</span></code>” (can only be a binary code block), “<code class="docutils literal notranslate"><span class="pre">t</span></code>” (can only be a text code block), or “<code class="docutils literal notranslate"><span class="pre">bt</span></code>” (can be either binary or text). The default value is “<code class="docutils literal notranslate"><span class="pre">bt</span></code>”。</p>
<p>Lua Binary code blocks are not checked for robustness. Maliciously constructing a binary block has the potential to crash the interpreter.</p>
</section>
<hr class="docutils"/>
<section id="loadfile-filename-mode-env">
<h4><code class="docutils literal notranslate"><span class="pre">loadfile</span> <span class="pre">([filename</span> <span class="pre">[,</span> <span class="pre">mode</span> <span class="pre">[,</span> <span class="pre">env]]])</span></code><a class="headerlink" href="#loadfile-filename-mode-env" title="Permalink to this headline">#</a></h4>
<p>Similar to <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">load</span></code></span>, but gets the code block from the file <code class="docutils literal notranslate"><span class="pre">filename</span></code> or standard input (if a file name is not provided).</p>
</section>
<hr class="docutils"/>
<section id="next-table-index">
<h4><code class="docutils literal notranslate"><span class="pre">next</span> <span class="pre">(table</span> <span class="pre">[,</span> <span class="pre">index])</span></code><a class="headerlink" href="#next-table-index" title="Permalink to this headline">#</a></h4>
<p>Run the program to traverse all the fields in the table. The first parameter is the table to be traversed, and the second parameter is a key in the table. <code class="docutils literal notranslate"><span class="pre">next</span></code> returns the next key of the key and its associated value. Calling <code class="docutils literal notranslate"><span class="pre">next</span></code> with <strong>nil</strong> as the second argument returns the initial key and its associated value. When called with the last key, or an empty table is called with <strong>nil</strong>, <code class="docutils literal notranslate"><span class="pre">next</span></code> returns **nil * *. If you do not provide the second argument, it will be considered to be **nil * *. In particular, you can use <code class="docutils literal notranslate"><span class="pre">next(t)</span></code>to determine whether a table is empty.</p>
<p>The order of indexes during traversal is undefined,<em>even for numeric indexes</em>. (If you want to traverse the table in numerical order, you can use <strong>for</strong> 。）</p>
<p>When you assign a value to a field that does not exist in the table during traversal, the behavior of <code class="docutils literal notranslate"><span class="pre">next</span></code> is undefined. However, you can modify existing fields. In particular, you can clear some existing domains.</p>
</section>
<hr class="docutils"/>
<section id="pairs-t">
<h4><code class="docutils literal notranslate"><span class="pre">pairs</span> <span class="pre">(t)</span></code><a class="headerlink" href="#pairs-t" title="Permalink to this headline">#</a></h4>
<p>If <code class="docutils literal notranslate"><span class="pre">t</span></code> has meta method <code class="docutils literal notranslate"><span class="pre">__pairs</span></code>, call it with <code class="docutils literal notranslate"><span class="pre">t</span></code> as an argument and return the first three values it returns.</p>
<p>Otherwise, three values are returned:<span class="xref myst"><code class="docutils literal notranslate"><span class="pre">next</span></code></span> function, table <code class="docutils literal notranslate"><span class="pre">t</span></code>, and **nil * *. So the following code</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> for k,v in pairs(t) do _body_ end
</pre></div>
</div>
<p>Can represent all key-value pairs in`t.</p>
<p>See the function <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">next</span></code></span> for the risk of modifying a table during an iteration.</p>
</section>
<hr class="docutils"/>
<section id="pcall-f-arg1">
<h4><code class="docutils literal notranslate"><span class="pre">pcall</span> <span class="pre">(f</span> <span class="pre">[,</span> <span class="pre">arg1,</span> <span class="pre">···])</span></code><a class="headerlink" href="#pcall-f-arg1" title="Permalink to this headline">#</a></h4>
<p>Pass in the parameter to call the function <code class="docutils literal notranslate"><span class="pre">f</span></code> in_protected mode <code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">This</span> <span class="pre">means</span> <span class="pre">that</span> <span class="pre">any</span> <span class="pre">error</span> <span class="pre">in</span> </code>f<code class="docutils literal notranslate"><span class="pre">will</span> <span class="pre">not</span> <span class="pre">be</span> <span class="pre">thrown;</span> <span class="pre">instead,</span></code>pcall<code class="docutils literal notranslate"><span class="pre">will</span> <span class="pre">catch</span> <span class="pre">the</span> <span class="pre">error</span> <span class="pre">and</span> <span class="pre">return</span> <span class="pre">a</span> <span class="pre">status</span> <span class="pre">code.</span> <span class="pre">The</span> <span class="pre">first</span> <span class="pre">return</span> <span class="pre">value</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">status</span> <span class="pre">code</span> <span class="pre">(a</span> <span class="pre">boolean),</span> <span class="pre">which</span> <span class="pre">is</span> <span class="pre">true</span> <span class="pre">when</span> <span class="pre">there</span> <span class="pre">are</span> <span class="pre">no</span> <span class="pre">errors.</span> <span class="pre">In</span> <span class="pre">this</span> <span class="pre">case,</span></code>pcall<code class="docutils literal notranslate"><span class="pre">will</span> <span class="pre">also</span> <span class="pre">return</span> <span class="pre">the</span> <span class="pre">results</span> <span class="pre">of</span> <span class="pre">all</span> <span class="pre">calls</span> <span class="pre">after</span> <span class="pre">the</span> <span class="pre">status</span> <span class="pre">code.</span> <span class="pre">When</span> <span class="pre">there</span> <span class="pre">is</span> <span class="pre">an</span> <span class="pre">error,</span></code>pcall` returns <strong>false</strong> plus the error message.</p>
</section>
<hr class="docutils"/>
<section id="print">
<h4><code class="docutils literal notranslate"><span class="pre">print</span> <span class="pre">(···)</span></code><a class="headerlink" href="#print" title="Permalink to this headline">#</a></h4>
<p>Receive any number of parameters and print their values to <code class="docutils literal notranslate"><span class="pre">stdout</span> </code>. It uses the <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">tostring</span></code></span> function to convert each argument to a string. <code class="docutils literal notranslate"><span class="pre">print</span></code> is not used to do formatted output. Just as a shortcut to look at a value. More for debugging. For complete control of the output, use <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">string.format</span></code></span> and <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">io.write</span></code></span>。</p>
</section>
<hr class="docutils"/>
<section id="rawequal-v1-v2">
<h4><code class="docutils literal notranslate"><span class="pre">rawequal</span> <span class="pre">(v1,</span> <span class="pre">v2)</span></code><a class="headerlink" href="#rawequal-v1-v2" title="Permalink to this headline">#</a></h4>
<p>Check if <code class="docutils literal notranslate"><span class="pre">v1</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">v2</span></code> without triggering any meta-methods. Returns a Boolean quantity.</p>
</section>
<hr class="docutils"/>
<section id="rawget-table-index">
<h4><code class="docutils literal notranslate"><span class="pre">rawget</span> <span class="pre">(table,</span> <span class="pre">index)</span></code><a class="headerlink" href="#rawget-table-index" title="Permalink to this headline">#</a></h4>
<p>Get the value of <code class="docutils literal notranslate"><span class="pre">table[index]</span></code>without triggering any meta-methods. <code class="docutils literal notranslate"><span class="pre">table</span></code> must be a table; <code class="docutils literal notranslate"><span class="pre">index</span></code> can be any value.</p>
</section>
<hr class="docutils"/>
<section id="rawlen-v">
<h4><code class="docutils literal notranslate"><span class="pre">rawlen</span> <span class="pre">(v)</span></code><a class="headerlink" href="#rawlen-v" title="Permalink to this headline">#</a></h4>
<p>Returns the length of object <code class="docutils literal notranslate"><span class="pre">v</span></code> without triggering any meta-methods. <code class="docutils literal notranslate"><span class="pre">v</span></code> can be a table or a string. It returns an integer.</p>
</section>
<hr class="docutils"/>
<section id="rawset-table-index-value">
<h4><code class="docutils literal notranslate"><span class="pre">rawset</span> <span class="pre">(table,</span> <span class="pre">index,</span> <span class="pre">value)</span></code><a class="headerlink" href="#rawset-table-index-value" title="Permalink to this headline">#</a></h4>
<p>Set <code class="docutils literal notranslate"><span class="pre">table[index]</span></code>to <code class="docutils literal notranslate"><span class="pre">value</span></code> without triggering any meta-methods<code class="docutils literal notranslate"><span class="pre">.</span> </code>table<code class="docutils literal notranslate"><span class="pre">must</span> <span class="pre">be</span> <span class="pre">a</span> <span class="pre">table,</span> <span class="pre">and</span></code>index<code class="docutils literal notranslate"><span class="pre">can</span> <span class="pre">be</span> <span class="pre">any</span> <span class="pre">value</span> <span class="pre">other</span> <span class="pre">than</span> <span class="pre">**nil**</span> <span class="pre">or</span> <span class="pre">NaN.</span></code>value` can be any Lua value.</p>
<p>This function returns <code class="docutils literal notranslate"><span class="pre">table</span></code>。</p>
</section>
<hr class="docutils"/>
<section id="select-index">
<h4><code class="docutils literal notranslate"><span class="pre">select</span> <span class="pre">(index,</span> <span class="pre">···)</span></code><a class="headerlink" href="#select-index" title="Permalink to this headline">#</a></h4>
<p>If <code class="docutils literal notranslate"><span class="pre">index</span></code> is a number, the part of the argument after the <code class="docutils literal notranslate"><span class="pre">index</span></code> is returned; negative numbers are indexed backwards and forwards (-1 refers to the last argument). Otherwise, <code class="docutils literal notranslate"><span class="pre">index</span></code> must be the string <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">"</span></code>, where <code class="docutils literal notranslate"><span class="pre">select</span></code> returns the number of arguments.</p>
</section>
<hr class="docutils"/>
<section id="setmetatable-table-metatable">
<h4><code class="docutils literal notranslate"><span class="pre">setmetatable</span> <span class="pre">(table,</span> <span class="pre">metatable)</span></code><a class="headerlink" href="#setmetatable-table-metatable" title="Permalink to this headline">#</a></h4>
<p>Sets the meta table for the specified table. (You can<code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">change</span> <span class="pre">the</span> <span class="pre">meta</span> <span class="pre">table</span> <span class="pre">for</span> <span class="pre">other</span> <span class="pre">types</span> <span class="pre">of</span> <span class="pre">values</span> <span class="pre">in</span> <span class="pre">Lua,</span> <span class="pre">those</span> <span class="pre">can</span> <span class="pre">only</span> <span class="pre">be</span> <span class="pre">done</span> <span class="pre">in</span> <span class="pre">C.)</span> <span class="pre">If</span> </code>metatable<code class="docutils literal notranslate"><span class="pre">is</span> <span class="pre">**nil**,</span> <span class="pre">the</span> <span class="pre">meta</span> <span class="pre">table</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">specified</span> <span class="pre">table</span> <span class="pre">is</span> <span class="pre">removed.</span> <span class="pre">If</span> <span class="pre">the</span> <span class="pre">original</span> <span class="pre">meta</span> <span class="pre">table</span> <span class="pre">has</span></code>__metatable` field, an error is thrown.</p>
<p>This function returns <code class="docutils literal notranslate"><span class="pre">table</span></code>。</p>
</section>
<hr class="docutils"/>
<section id="tonumber-e-base">
<h4><code class="docutils literal notranslate"><span class="pre">tonumber</span> <span class="pre">(e</span> <span class="pre">[,</span> <span class="pre">base])</span></code><a class="headerlink" href="#tonumber-e-base" title="Permalink to this headline">#</a></h4>
<p>If there is no <code class="docutils literal notranslate"><span class="pre">base</span></code> at the time of the call, <code class="docutils literal notranslate"><span class="pre">number</span></code> tries to convert the argument to a number. If the argument is already a number, or a string that can be converted to a number, <code class="docutils literal notranslate"><span class="pre">number</span></code> returns that number; otherwise <strong>nil</strong>。</p>
<p>The result of the string conversion may be an integer or a floating point number, depending on Lua’s conversion grammar (see <span class="xref myst">§ 3.1</span>). (Strings can have leading and trailing spaces, and can be signed。）</p>
<p>When <code class="docutils literal notranslate"><span class="pre">base</span></code> is passed in to call it, <code class="docutils literal notranslate"><span class="pre">e</span></code> must be an integer string represented in that base. The base can be any integer between 2 and 36, inclusive. When greater than 10, the letter <code class="docutils literal notranslate"><span class="pre">A</span></code> (both upper and lower case) means 10 , <code class="docutils literal notranslate"><span class="pre">B</span></code> means 11, and <code class="docutils literal notranslate"><span class="pre">Z</span></code> means 35. If the string <code class="docutils literal notranslate"><span class="pre">e</span></code> is not a legal number in this base, the function returns <strong>nil</strong>。</p>
</section>
<hr class="docutils"/>
<section id="tostring-v">
<h4><code class="docutils literal notranslate"><span class="pre">tostring</span> <span class="pre">(v)</span></code><a class="headerlink" href="#tostring-v" title="Permalink to this headline">#</a></h4>
<p>Can receive any type, it converts it to human-readable string form. Floating-point numbers are always converted to the representation of floating-point numbers (decimal or exponential). (If you want full control over how numbers are converted, you can use <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">string.format</span></code></span>。）</p>
<p>If <code class="docutils literal notranslate"><span class="pre">v</span></code> has a metable<code class="docutils literal notranslate"><span class="pre">__tostring</span> <span class="pre">"</span></code>field, <code class="docutils literal notranslate"><span class="pre">tostring</span></code> will call it with <code class="docutils literal notranslate"><span class="pre">v</span></code> as an argument. and use its result as the return value.</p>
</section>
<hr class="docutils"/>
<section id="type-v">
<h4><code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">(v)</span></code><a class="headerlink" href="#type-v" title="Permalink to this headline">#</a></h4>
<p>Encodes the type of the argument as a string returned. The possible return value of the function is “<code class="docutils literal notranslate"><span class="pre">nil</span></code>” (a string, not a <strong>nil</strong> value）， “<code class="docutils literal notranslate"><span class="pre">number</span></code>”， “<code class="docutils literal notranslate"><span class="pre">string</span></code>”， “<code class="docutils literal notranslate"><span class="pre">boolean</span></code>”， “<code class="docutils literal notranslate"><span class="pre">table</span></code>”， “<code class="docutils literal notranslate"><span class="pre">function</span></code>”， “<code class="docutils literal notranslate"><span class="pre">thread</span></code>”， “<code class="docutils literal notranslate"><span class="pre">userdata</span></code>”。</p>
</section>
<hr class="docutils"/>
<section id="version">
<h4><code class="docutils literal notranslate"><span class="pre">_VERSION</span></code><a class="headerlink" href="#version" title="Permalink to this headline">#</a></h4>
<p>A global variable (not a function) that contains the version number of the current interpreter. The current value of this variable is “<code class="docutils literal notranslate"><span class="pre">Lua</span> <span class="pre">5.3</span></code>”。</p>
</section>
<hr class="docutils"/>
<section id="xpcall-f-msgh-arg1">
<h4><code class="docutils literal notranslate"><span class="pre">xpcall</span> <span class="pre">(f,</span> <span class="pre">msgh</span> <span class="pre">[,</span> <span class="pre">arg1,</span> <span class="pre">···])</span></code><a class="headerlink" href="#xpcall-f-msgh-arg1" title="Permalink to this headline">#</a></h4>
<p>This function is similar to <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">pcall</span></code></span>. However, it can set up an additional message processor. <code class="docutils literal notranslate"><span class="pre">msgh</span></code>。</p>
</section>
</section>
<section id="synergy-management">
<h3>6.2 – Synergy Management<a class="headerlink" href="#synergy-management" title="Permalink to this headline">#</a></h3>
<p>Operations on coroutines are placed in a separate table <code class="docutils literal notranslate"><span class="pre">coroutine</span></code> as a sublibrary of the base library. For the introduction of the association, see <span class="xref myst">§2.6</span> 。</p>
<hr class="docutils"/>
<section id="coroutine-create-f">
<h4><code class="docutils literal notranslate"><span class="pre">coroutine.create</span> <span class="pre">(f)</span></code><a class="headerlink" href="#coroutine-create-f" title="Permalink to this headline">#</a></h4>
<p>Create a new coprocess with a body function of <code class="docutils literal notranslate"><span class="pre">f.</span> </code>f<code class="docutils literal notranslate"><span class="pre">must</span> <span class="pre">be</span> <span class="pre">a</span> <span class="pre">Lua</span> <span class="pre">function.</span> <span class="pre">Returns</span> <span class="pre">this</span> <span class="pre">new</span> <span class="pre">coprocess,</span> <span class="pre">which</span> <span class="pre">is</span> <span class="pre">an</span> <span class="pre">object</span> <span class="pre">of</span> <span class="pre">type</span></code>”thread.</p>
</section>
<hr class="docutils"/>
<section id="coroutine-isyieldable">
<h4><code class="docutils literal notranslate"><span class="pre">coroutine.isyieldable</span> <span class="pre">()</span></code><a class="headerlink" href="#coroutine-isyieldable" title="Permalink to this headline">#</a></h4>
<p>Returns true if the running coroutes can yield.</p>
<p>The current coroutation is transferable when it is not in the main thread or in a C function that cannot be transferred.</p>
</section>
<hr class="docutils"/>
<section id="coroutine-resume-co-val1">
<h4><code class="docutils literal notranslate"><span class="pre">coroutine.resume</span> <span class="pre">(co</span> <span class="pre">[,</span> <span class="pre">val1,</span> <span class="pre">···])</span></code><a class="headerlink" href="#coroutine-resume-co-val1" title="Permalink to this headline">#</a></h4>
<p>Start or continue the operation of the coroutine <code class="docutils literal notranslate"><span class="pre">co.</span> <span class="pre">When</span> <span class="pre">you</span> <span class="pre">first</span> <span class="pre">continue</span> <span class="pre">a</span> <span class="pre">coroutine,</span> <span class="pre">it</span> <span class="pre">will</span> <span class="pre">start</span> <span class="pre">running</span> <span class="pre">from</span> <span class="pre">the</span> <span class="pre">main</span> <span class="pre">function.</span> </code>val1<code class="docutils literal notranslate"><span class="pre">,...</span> <span class="pre">These</span> <span class="pre">values</span> <span class="pre">are</span> <span class="pre">passed</span> <span class="pre">in</span> <span class="pre">as</span> <span class="pre">arguments</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">body</span> <span class="pre">function.</span> <span class="pre">If</span> <span class="pre">the</span> <span class="pre">coroutine</span> <span class="pre">is</span> <span class="pre">relinquished,</span> </code>resume<code class="docutils literal notranslate"><span class="pre">will</span> <span class="pre">restart</span> <span class="pre">it;</span></code>val1`,… these parameters will be used as the return value of the relinquished point.</p>
<p>If the coroutine runs without errors, <code class="docutils literal notranslate"><span class="pre">resume</span></code> returns <strong>true</strong> plus all the values passed to<code class="docutils literal notranslate"> <span class="pre">yield</span></code> (when the coroutine gives up), or all the return values of the subject function (when the coroutine aborts). If any error occurs, <code class="docutils literal notranslate"><span class="pre">resume</span></code> returns <strong>false</strong> plus the error message.</p>
</section>
<hr class="docutils"/>
<section id="coroutine-running">
<h4><code class="docutils literal notranslate"><span class="pre">coroutine.running</span> <span class="pre">()</span></code><a class="headerlink" href="#coroutine-running" title="Permalink to this headline">#</a></h4>
<p>Returns the current running coroutation plus a boolean. This is true if the currently running coroute is the main thread.</p>
</section>
<hr class="docutils"/>
<section id="coroutine-status-co">
<h4><code class="docutils literal notranslate"><span class="pre">coroutine.status</span> <span class="pre">(co)</span></code><a class="headerlink" href="#coroutine-status-co" title="Permalink to this headline">#</a></h4>
<p>Return the status of the coroutine <code class="docutils literal notranslate"><span class="pre">co</span></code> in the form of a string: when the coroutine is running (it is the one that call<code class="docutils literal notranslate"> <span class="pre">status</span></code>), return<code class="docutils literal notranslate"><span class="pre">"running"</span></code>; If the coroutine call<code class="docutils literal notranslate"> <span class="pre">yield</span></code> pending or has not yet started running, return<code class="docutils literal notranslate"><span class="pre">"suspended"</span></code>; If the coroutine is active but not running (I .e. it is continuing other coroutines), return<code class="docutils literal notranslate"> <span class="pre">"</span></code>normal”<code class="docutils literal notranslate"><span class="pre">;</span> <span class="pre">if</span> <span class="pre">the</span> <span class="pre">coroutine</span> <span class="pre">finishes</span> <span class="pre">running</span> <span class="pre">the</span> <span class="pre">body</span> <span class="pre">function</span> <span class="pre">or</span> <span class="pre">stops</span> <span class="pre">due</span> <span class="pre">to</span> <span class="pre">an</span> <span class="pre">error,</span> <span class="pre">returns</span> </code>“dead”`。</p>
</section>
<hr class="docutils"/>
<section id="coroutine-wrap-f">
<h4><code class="docutils literal notranslate"><span class="pre">coroutine.wrap</span> <span class="pre">(f)</span></code><a class="headerlink" href="#coroutine-wrap-f" title="Permalink to this headline">#</a></h4>
<p>Create a new coprocess with a body function of <code class="docutils literal notranslate"><span class="pre">f.</span> </code>f<code class="docutils literal notranslate"><span class="pre">must</span> <span class="pre">be</span> <span class="pre">a</span> <span class="pre">Lua</span> <span class="pre">function.</span> <span class="pre">Returns</span> <span class="pre">a</span> <span class="pre">function</span> <span class="pre">that</span> <span class="pre">continues</span> <span class="pre">the</span> <span class="pre">coroutation</span> <span class="pre">each</span> <span class="pre">time</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">called.</span> <span class="pre">The</span> <span class="pre">arguments</span> <span class="pre">passed</span> <span class="pre">to</span> <span class="pre">this</span> <span class="pre">function</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">extra</span> <span class="pre">arguments</span> <span class="pre">to</span></code>resume. and <code class="docutils literal notranslate"><span class="pre">resume</span></code> return the same value, just without the first boolean. If any error occurs, throw this error.</p>
</section>
<hr class="docutils"/>
<section id="coroutine-yield">
<h4><code class="docutils literal notranslate"><span class="pre">coroutine.yield</span> <span class="pre">(···)</span></code><a class="headerlink" href="#coroutine-yield" title="Permalink to this headline">#</a></h4>
<p>Suspends execution of the calling corouty. Any parameter passed to <code class="docutils literal notranslate"><span class="pre">yield</span></code> is converted to an additional return value of `resume.</p>
</section>
</section>
<section id="module">
<h3>6.3 – Module<a class="headerlink" href="#module" title="Permalink to this headline">#</a></h3>
<p>The package management library provides the base for loading modules from Lua. Only one exported function is placed directly in the global environment: <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">require</span></code></span>. All other parts are exported in the table `package.</p>
<hr class="docutils"/>
<section id="require-modname">
<h4><code class="docutils literal notranslate"><span class="pre">require</span> <span class="pre">(modname)</span></code><a class="headerlink" href="#require-modname" title="Permalink to this headline">#</a></h4>
<p>Load a module. This function first looks up the <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">package.loaded</span></code></span> table to check if the <code class="docutils literal notranslate"><span class="pre">modname</span></code> has been loaded. If loaded, <code class="docutils literal notranslate"><span class="pre">require</span></code> returns the value saved in `package.loaded[modname]. Otherwise, it tries to find the_loader for the module._ 。</p>
<p><code class="docutils literal notranslate"><span class="pre">require</span></code> Follow the <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">package.searchers</span></code></span> sequence to find the loader. If we change this sequence, we can change how <code class="docutils literal notranslate"><span class="pre">require</span></code> looks for a module. The following description is based on the default configuration of <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">package.searchers</span></code></span>.</p>
<p>First <code class="docutils literal notranslate"><span class="pre">require</span></code> looks for <code class="docutils literal notranslate"><span class="pre">package.preload[modname]</span></code>. If there is a value here, this value (which must be a function) is the loader. Otherwise <code class="docutils literal notranslate"><span class="pre">require</span></code> uses the Lua loader to find the path of <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">package.path</span></code></span>. If the lookup fails, then use the C loader to find the path of <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">package.cpath</span></code></span>. If all fail, try the_integration_loader again (see <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">package.searchers</span></code></span>）。</p>
<p>Each time a loader is found, <code class="docutils literal notranslate"><span class="pre">require</span></code> calls the loader with two parameters: <code class="docutils literal notranslate"><span class="pre">modname</span></code> and a parameter obtained during the acquisition of the loader. (If the loader is obtained by looking for a file, this extra parameter is the file name.) If the loader returns a non-null value, <code class="docutils literal notranslate"><span class="pre">require</span></code> assigns this value to <code class="docutils literal notranslate"><span class="pre">package.loaded[modname]</span></code>. If the loader fails to return a non-null value to assign to <code class="docutils literal notranslate"><span class="pre">package.loaded[modname]</span></code>, <code class="docutils literal notranslate"><span class="pre">require</span></code> will be set to <strong>true</strong> there * *. Whatever the case, <code class="docutils literal notranslate"><span class="pre">require</span></code> returns the final value of `package.loaded[modname].</p>
<p>If there is an error loading or running the module, or if the loader cannot be found for the module, <code class="docutils literal notranslate"><span class="pre">require</span></code> will throw an error.</p>
</section>
<hr class="docutils"/>
<section id="package-config">
<h4><code class="docutils literal notranslate"><span class="pre">package.config</span></code><a class="headerlink" href="#package-config" title="Permalink to this headline">#</a></h4>
<p>A string that describes some compile-time configuration information prepared for package management. This string consists of a series of lines：</p>
<ul class="simple">
<li><p>The first line is a directory split string. The default is ‘’’’ for Windows, and for other systems. ‘<code class="docutils literal notranslate"><span class="pre">/</span></code>’ 。</p></li>
<li><p>The second line is the separator used in the path. The default value is ‘<code class="docutils literal notranslate"><span class="pre">;</span></code>’ 。</p></li>
<li><p>The third line is the string used to mark the template replacement point. The default is ‘<code class="docutils literal notranslate"><span class="pre">?</span></code>’ 。</p></li>
<li><p>The fourth line is the string that will be replaced in the Windows with the path of the directory where the executable is located. The default is ‘<code class="docutils literal notranslate"><span class="pre">!</span></code>’ 。</p></li>
<li><p>The fifth line is a token, and all text after this token will be ignored when constructing the <code class="docutils literal notranslate"><span class="pre">luaopen_</span></code>function name. The default is ‘<code class="docutils literal notranslate"><span class="pre">-</span></code>’。</p></li>
</ul>
</section>
<hr class="docutils"/>
<section id="package-cpath">
<h4><code class="docutils literal notranslate"><span class="pre">package.cpath</span></code><a class="headerlink" href="#package-cpath" title="Permalink to this headline">#</a></h4>
<p>This path is used by <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">require</span></code></span> when doing a search in the C loader.</p>
<p>Lua The C path <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">package.cpath</span></code></span> is initialized in the same way as the Lua path [<code class="docutils literal notranslate"><span class="pre">package.</span> <span class="pre">pdf-package.cpath](#)</span> <span class="pre">is</span> <span class="pre">initialized.</span> <span class="pre">It</span> <span class="pre">is</span> <span class="pre">initialized</span> <span class="pre">with</span> <span class="pre">the</span> <span class="pre">environment</span> <span class="pre">variable</span> <span class="pre">LUA_CPATH_5_3</span> <span class="pre">or</span> <span class="pre">the</span> <span class="pre">environment</span> <span class="pre">variable</span> <span class="pre">LUA_CPATH.</span> <span class="pre">Either</span> <span class="pre">take</span> <span class="pre">the</span> <span class="pre">default</span> <span class="pre">path</span> <span class="pre">defined</span> <span class="pre">in</span> </code>luaconf.h.</p>
</section>
<hr class="docutils"/>
<section id="package-loaded">
<h4><code class="docutils literal notranslate"><span class="pre">package.loaded</span></code><a class="headerlink" href="#package-loaded" title="Permalink to this headline">#</a></h4>
<p>A table used for <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">require</span></code></span> to control which modules have been loaded. When you request a <code class="docutils literal notranslate"><span class="pre">modname</span></code> module and <code class="docutils literal notranslate"><span class="pre">package.loaded[modname]</span></code>is not false, <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">require</span></code></span> simply returns the stored value.</p>
<p>This variable is only a reference to the actual table; changing this value does not change the table used by <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">require</span></code></span>.</p>
</section>
<hr class="docutils"/>
<section id="package-loadlib-libname-funcname">
<h4><code class="docutils literal notranslate"><span class="pre">package.loadlib</span> <span class="pre">(libname,</span> <span class="pre">funcname)</span></code><a class="headerlink" href="#package-loadlib-libname-funcname" title="Permalink to this headline">#</a></h4>
<p>Let the host program dynamically link the C library. <code class="docutils literal notranslate"><span class="pre">libname</span></code> 。</p>
<p>When <code class="docutils literal notranslate"><span class="pre">funcname</span></code> is “<code class="docutils literal notranslate"><span class="pre">*</span></code>”, it only connects to the library and allows the symbols in the library to be exported to other dynamic link libraries. Otherwise, it looks for the function <code class="docutils literal notranslate"><span class="pre">funcname</span></code> in the library and returns it as a C function. Therefore, <code class="docutils literal notranslate"><span class="pre">funcname</span></code> must follow the prototype <span class="xref myst">`lua_CFunction](#lua_CFunction) (cf. [`lua_CFunction`</span>）。</p>
<p>This is a low-order function. It completely bypasses the package module system. Unlike <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">require</span></code></span>, it does not do any path lookup and does not automatically add an extension. <code class="docutils literal notranslate"><span class="pre">libname</span></code> must be the full filename required by a C library, providing the path and extension if necessary. <code class="docutils literal notranslate"><span class="pre">funcname</span></code> must be the exact name required by the C library (depending on the C compiler and linker used）。</p>
<p>This function is not supported in standard C. Therefore, it is only valid on some platforms (Windows ,Linux ,Mac OS X, Solaris, BSD, plus Unix systems that support the<code class="docutils literal notranslate"> <span class="pre">dlfcn</span></code> standard）。</p>
</section>
<hr class="docutils"/>
<section id="package-path">
<h4><code class="docutils literal notranslate"><span class="pre">package.path</span></code><a class="headerlink" href="#package-path" title="Permalink to this headline">#</a></h4>
<p>This path is used by <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">require</span></code></span> when searching in the Lua loader.</p>
<p>At startup, Lua initializes this variable with the environment variable LUA_PATH_5_3 or the environment variable LUA_PATH. Or take the default path in <code class="docutils literal notranslate"><span class="pre">luaconf.h.</span> <span class="pre">All</span> <span class="pre">occurrences</span> <span class="pre">of</span> <span class="pre">"</span></code>;;`” in the environment variable are replaced with the default path.</p>
</section>
<hr class="docutils"/>
<section id="package-preload">
<h4><code class="docutils literal notranslate"><span class="pre">package.preload</span></code><a class="headerlink" href="#package-preload" title="Permalink to this headline">#</a></h4>
<p>holds a loader with some special modules (see <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">require</span></code></span>）。</p>
<p>This variable is only a reference to the actual table; changing this value does not change the table used by <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">require</span></code></span>.</p>
</section>
<hr class="docutils"/>
<section id="package-searchers">
<h4><code class="docutils literal notranslate"><span class="pre">package.searchers</span></code><a class="headerlink" href="#package-searchers" title="Permalink to this headline">#</a></h4>
<p>Table for <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">require</span></code></span> to control how modules are loaded.</p>
<p>Each item in this table is a_finder function_. When looking up a module, <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">require</span></code></span> calls these finder in order, passing in the module name (an argument to the <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">require</span></code></span>) as the only argument. This function can return another function (the module<code class="docutils literal notranslate"><span class="pre">s_loader_)</span> <span class="pre">plus</span> <span class="pre">another</span> <span class="pre">argument</span> <span class="pre">that</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">passed</span> <span class="pre">to</span> <span class="pre">this</span> <span class="pre">loader.</span> <span class="pre">Or</span> <span class="pre">return</span> <span class="pre">a</span> <span class="pre">string</span> <span class="pre">describing</span> <span class="pre">why</span> <span class="pre">the</span> <span class="pre">module</span> <span class="pre">was</span> <span class="pre">not</span> <span class="pre">found</span> <span class="pre">(or</span> <span class="pre">return</span> <span class="pre">**nil**</span> <span class="pre">and</span> <span class="pre">don</span></code>t want to say anything）。</p>
<p>Lua Initialize this table with four finder functions.</p>
<p>The first finder is simply a loader in the <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">package.preload</span></code></span> table.</p>
<p>The second finder is used to find loaded libraries for Lua libraries. It uses the path stored in <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">package.path</span></code></span> to do the lookup. The search process is consistent with the description of the function <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">package.searchpath</span></code></span>.</p>
<p>The third finder is used to find the loaded library for the C library. It uses the path stored in <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">package.cpath</span></code></span> to do the lookup. Similarly, the lookup process is identical to that described by the function <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">package.searchpath</span></code></span>. For example, if the C path is such a string</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> "./?.so;./?.dll;/usr/local/?/init.so"
</pre></div>
</div>
<p>The finder lookup module <code class="docutils literal notranslate"><span class="pre">foo</span></code> attempts to open the files <code class="docutils literal notranslate"><span class="pre">./foo.so</span></code>,<code class="docutils literal notranslate"><span class="pre">./foo.dll</span></code>, and <code class="docutils literal notranslate"><span class="pre">/usr/local/foo/init.so</span></code>. Once it finds a C library, the finder first connects to the library using a dynamic linking mechanism. Then try to find a C function in that library that you can use as a loader. The name of this C function is “<code class="docutils literal notranslate"><span class="pre">luaopen_</span></code>” a string immediately following the module name, where all underscores in the string are replaced with dots. In addition, if there is a horizontal line in the module name, the part after the horizontal line (including the horizontal line) is removed. For example, if the module is named <code class="docutils literal notranslate"><span class="pre">a.</span> <span class="pre">B.</span> <span class="pre">c-v2.1,</span> </code>the function name is <code class="docutils literal notranslate"><span class="pre">luaopen_a_b_c</span></code>。</p>
<p>The fourth searcher is the_all-in-one loader_. It looks up the root name of the specified module from the C path. For example, when requesting <code class="docutils literal notranslate"><span class="pre">a.</span> <span class="pre">B.</span> <span class="pre">c</span></code>, it will look for <code class="docutils literal notranslate"><span class="pre">a</span></code> which is the C library. If it can find it, it will find the loading function of the submodule in it. In our case, we are looking for “luaopen_a_ B _c `. Using this mechanism, several C submodules can be packaged into a single library. Each submodule can have an original load function name.</p>
<p>Except for the first (preloaded) searcher, each searcher returns the filename of the module it finds. This is the same as the return value of <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">package.searchpath</span></code></span>. The first searcher has no return value.</p>
</section>
<hr class="docutils"/>
<section id="package-searchpath-name-path-sep-rep">
<h4><code class="docutils literal notranslate"><span class="pre">package.searchpath</span> <span class="pre">(name,</span> <span class="pre">path</span> <span class="pre">[,</span> <span class="pre">sep</span> <span class="pre">[,</span> <span class="pre">rep]])</span></code><a class="headerlink" href="#package-searchpath-name-path-sep-rep" title="Permalink to this headline">#</a></h4>
<p>Searches the specified <code class="docutils literal notranslate"><span class="pre">path</span></code> for the specified <code class="docutils literal notranslate"><span class="pre">name</span></code> 。</p>
<p>A path is a string consisting of a series of_templates_separated by semicolon. For each template, each question mark in it (if any) is replaced with <code class="docutils literal notranslate"><span class="pre">name.</span> <span class="pre">And</span> <span class="pre">replace</span> <span class="pre">the</span> </code>sep<code class="docutils literal notranslate"><span class="pre">(default</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">dot)</span> <span class="pre">with</span></code>rep` (default is the directory separator of the system). Then try to open this file name.</p>
<p>For example, if the path is a string</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> "./?.lua;./?.lc;/usr/local/?/init.lua"
</pre></div>
</div>
<p>Searching for the name <code class="docutils literal notranslate"><span class="pre">foo.a</span></code> will attempt to open the files <code class="docutils literal notranslate"><span class="pre">./foo/a.lua</span></code>, <code class="docutils literal notranslate"><span class="pre">./foo/a.lc</span></code>, and <code class="docutils literal notranslate"><span class="pre">/usr/local/foo/a/init.lua</span></code>。</p>
<p>Returns the name of the first file that can be opened in read mode (and closed immediately). If no such file exists, return <strong>nil</strong> plus an error message. (This error message lists all the file names you tried to open.。）</p>
</section>
</section>
<section id="string-processing">
<h3>6.4 – String processing<a class="headerlink" href="#string-processing" title="Permalink to this headline">#</a></h3>
<p>This library provides generic functions for string processing. For example, string lookup, substring, pattern matching, etc. When indexing strings in Lua, the first character is counted from 1 (not 0 in C). The index can be a negative number, which refers to the reverse parsing from the end of the string. That is, the last character is at the -1 position, and so on.</p>
<p>All functions in the string library are in the table <code class="docutils literal notranslate"><span class="pre">string.</span> <span class="pre">It</span> <span class="pre">also</span> <span class="pre">sets</span> <span class="pre">it</span> <span class="pre">to</span> <span class="pre">the</span> </code>__index<code class="docutils literal notranslate"><span class="pre">field</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">string</span> <span class="pre">meta</span> <span class="pre">table.</span> <span class="pre">Therefore,</span> <span class="pre">you</span> <span class="pre">can</span> <span class="pre">use</span> <span class="pre">string</span> <span class="pre">functions</span> <span class="pre">in</span> <span class="pre">object-oriented</span> <span class="pre">form.</span> <span class="pre">For</span> <span class="pre">example,</span></code>string.byte(s, I) <code class="docutils literal notranslate"><span class="pre">can</span> <span class="pre">be</span> <span class="pre">written</span> </code>s:byte(i)`。</p>
<p>String libraries assume single-byte character encoding.</p>
<hr class="docutils"/>
<section id="string-byte-s-i-j">
<h4><code class="docutils literal notranslate"><span class="pre">string.byte</span> <span class="pre">(s</span> <span class="pre">[,</span> <span class="pre">i</span> <span class="pre">[,</span> <span class="pre">j]])</span></code><a class="headerlink" href="#string-byte-s-i-j" title="Permalink to this headline">#</a></h4>
<p>Returns the internal numeric encoding of the characters <code class="docutils literal notranslate"><span class="pre">[I]</span></code>, <code class="docutils literal notranslate"><span class="pre">[I</span> <span class="pre">1]</span></code>,… ,<code class="docutils literal notranslate"><span class="pre">[j].</span> <span class="pre">The</span> <span class="pre">default</span> <span class="pre">value</span> <span class="pre">for</span> </code>I<code class="docutils literal notranslate"><span class="pre">is</span> <span class="pre">1;</span> <span class="pre">the</span> <span class="pre">default</span> <span class="pre">value</span> <span class="pre">for</span></code>j<code class="docutils literal notranslate"><span class="pre">is</span></code>I<code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">These</span> <span class="pre">indexes</span> <span class="pre">are</span> <span class="pre">modified</span> <span class="pre">by</span> <span class="pre">the</span> <span class="pre">rules</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">function</span> <span class="pre">[</span></code>string.sub`](#pdf-string.sub).</p>
<p>There is no need for digital encoding to be cross-platform.</p>
</section>
<hr class="docutils"/>
<section id="string-char">
<h4><code class="docutils literal notranslate"><span class="pre">string.char</span> <span class="pre">(···)</span></code><a class="headerlink" href="#string-char" title="Permalink to this headline">#</a></h4>
<p>Receives zero or more integers. Returns a string of the same length as the number of arguments. The internal encoding value of each character is equal to the corresponding parameter value.</p>
<p>There is no need for digital encoding to be cross-platform.</p>
</section>
<hr class="docutils"/>
<section id="string-dump-function-strip">
<h4><code class="docutils literal notranslate"><span class="pre">string.dump</span> <span class="pre">(function</span> <span class="pre">[,</span> <span class="pre">strip])</span></code><a class="headerlink" href="#string-dump-function-strip" title="Permalink to this headline">#</a></h4>
<p>Returns a string containing the specified function in binary representation (a_binary code block_). You can then call this string with <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">load</span></code></span> to get a copy of the function (but bind the new upper value). If <code class="docutils literal notranslate"><span class="pre">strip</span></code> is true, the binary code block does not carry debugging information for the function (local variable name, line number, etc.。）。</p>
<p>The function with values only holds the number of values. When loaded (again), these upper values are updated to instances of **nil. (You can use the debug library to serialize the upper value in the way you need and overload it into the function.）</p>
</section>
<hr class="docutils"/>
<section id="string-find-s-pattern-init-plain">
<h4><code class="docutils literal notranslate"><span class="pre">string.find</span> <span class="pre">(s,</span> <span class="pre">pattern</span> <span class="pre">[,</span> <span class="pre">init</span> <span class="pre">[,</span> <span class="pre">plain]])</span></code><a class="headerlink" href="#string-find-s-pattern-init-plain" title="Permalink to this headline">#</a></h4>
<p>Find the matching <code class="docutils literal notranslate"><span class="pre">pattern</span></code> in the first string <code class="docutils literal notranslate"><span class="pre">s</span></code> (see <span class="xref myst">§ 6.4.1</span>). If a match is found, <code class="docutils literal notranslate"><span class="pre">find</span></code> returns the index in <code class="docutils literal notranslate"><span class="pre">s</span></code> about where it starts and ends; otherwise, <strong>nil</strong> is returned * *. The third optional numeric parameter <code class="docutils literal notranslate"><span class="pre">init</span></code> indicates where to start the search; it defaults to 1 and can be negative. When the fourth optional parameter <code class="docutils literal notranslate"><span class="pre">plain</span></code> is <strong>true</strong>, the pattern matching mechanism is disabled. At this point, the function only does the direct “find substring” operation, and no characters in <code class="docutils literal notranslate"><span class="pre">pattern</span></code> are regarded as magic characters. Note that if <code class="docutils literal notranslate"><span class="pre">plain</span></code> is given, it must be written on <code class="docutils literal notranslate"><span class="pre">init</span></code> 。</p>
<p>If capture is defined in the schema, several values captured are also returned after two indexes.</p>
</section>
<hr class="docutils"/>
<section id="string-format-formatstring">
<h4><code class="docutils literal notranslate"><span class="pre">string.format</span> <span class="pre">(formatstring,</span> <span class="pre">···)</span></code><a class="headerlink" href="#string-format-formatstring" title="Permalink to this headline">#</a></h4>
<p>Returns a formatted version of an indefinite number of arguments, formatted as the first argument (must be a string). The formatted string follows the rules of the ISO C function <code class="docutils literal notranslate"><span class="pre">sprintf.</span> <span class="pre">The</span> <span class="pre">difference</span> <span class="pre">is</span> <span class="pre">that</span> <span class="pre">the</span> <span class="pre">options</span> </code>*<code class="docutils literal notranslate"><span class="pre">,</span> </code>h<code class="docutils literal notranslate"><span class="pre">,</span> </code>L<code class="docutils literal notranslate"><span class="pre">,</span> </code>l<code class="docutils literal notranslate"><span class="pre">,</span> </code>n<code class="docutils literal notranslate"><span class="pre">,</span> </code>p<code class="docutils literal notranslate"><span class="pre">are</span> <span class="pre">not</span> <span class="pre">supported,</span> <span class="pre">and</span> <span class="pre">an</span> <span class="pre">option</span></code>q<code class="docutils literal notranslate"><span class="pre">is</span> <span class="pre">added</span></code>. The <code class="docutils literal notranslate"><span class="pre">q</span></code> option formats a string as a string surrounded by two double quotes, with appropriate escaping of internal characters. This string can be safely read back by the Lua interpreter. For example, calling</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> string.format('%q', 'a string with "quotes" and \\n new line')
</pre></div>
</div>
<p>will produce the string：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> "a string with \\"quotes\\" and \\
  new line"
</pre></div>
</div>
<p>Options <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">a</span></code> (if any), <code class="docutils literal notranslate"><span class="pre">E</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>, <code class="docutils literal notranslate"><span class="pre">f</span></code>, <code class="docutils literal notranslate"><span class="pre">G</span></code>, and <code class="docutils literal notranslate"><span class="pre">g</span></code> all expect a corresponding numeric argument. The options <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">I</span></code>, <code class="docutils literal notranslate"><span class="pre">o</span></code>, <code class="docutils literal notranslate"><span class="pre">u</span></code>, <code class="docutils literal notranslate"><span class="pre">x</span></code>, and <code class="docutils literal notranslate"><span class="pre">x</span></code> expect an integer. Option <code class="docutils literal notranslate"><span class="pre">q</span></code> expects a string; option <code class="docutils literal notranslate"><span class="pre">s</span></code> expects a string without embedded zeros. If the parameter corresponding to the option <code class="docutils literal notranslate"><span class="pre">s</span></code> is not a string, it will be converted to a string according to the rules of <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">tostring</span></code></span>.</p>
</section>
<hr class="docutils"/>
<section id="string-gmatch-s-pattern">
<h4><code class="docutils literal notranslate"><span class="pre">string.gmatch</span> <span class="pre">(s,</span> <span class="pre">pattern)</span></code><a class="headerlink" href="#string-gmatch-s-pattern" title="Permalink to this headline">#</a></h4>
<p>Returns an iterator function. Each call to this function will continue to match <code class="docutils literal notranslate"><span class="pre">s</span></code> with <code class="docutils literal notranslate"><span class="pre">pattern</span></code> (see <span class="xref myst">§ 6.4.1</span>) and return all captured values. If no capture is specified in <code class="docutils literal notranslate"><span class="pre">pattern</span></code>, the entire <code class="docutils literal notranslate"><span class="pre">pattern</span></code>。</p>
<p>The following example iterates over all the words in the string <code class="docutils literal notranslate"><span class="pre">s</span></code> and prints them line by line.：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> s = "hello world from Lua"
 for w in string.gmatch(s, "%a+") do
   print(w)
 end
</pre></div>
</div>
<p>The next example collects all key-value pairs <code class="docutils literal notranslate"><span class="pre">key</span> <span class="pre">=</span> <span class="pre">value</span></code> from the specified string and puts them into a table.：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> t = {}
 s = "from=world, to=Lua"
 for k, v in string.gmatch(s, "(%w+)=(%w+)") do
   t\[k\] = v
 end
</pre></div>
</div>
<p>For this function, the <code class="docutils literal notranslate"><span class="pre">^</span></code> that starts before the template will not be used as an anchor. Because this prevents iteration.</p>
</section>
<hr class="docutils"/>
<section id="string-gsub-s-pattern-repl-n">
<h4><code class="docutils literal notranslate"><span class="pre">string.gsub</span> <span class="pre">(s,</span> <span class="pre">pattern,</span> <span class="pre">repl</span> <span class="pre">[,</span> <span class="pre">n])</span></code><a class="headerlink" href="#string-gsub-s-pattern-repl-n" title="Permalink to this headline">#</a></h4>
<p>Replace all (or the first <code class="docutils literal notranslate"><span class="pre">n</span></code> when <code class="docutils literal notranslate"><span class="pre">n</span></code> is given) <code class="docutils literal notranslate"><span class="pre">pattern</span></code> (see <span class="xref myst">§ 6.4.1</span>) in the string <code class="docutils literal notranslate"><span class="pre">s</span></code> with <code class="docutils literal notranslate"><span class="pre">repl</span></code>, and return its copy. <code class="docutils literal notranslate"><span class="pre">repl</span></code> can be a string, a table, or a function. <code class="docutils literal notranslate"><span class="pre">gsub</span></code> will also return the total number of matches in the second return value. The name <code class="docutils literal notranslate"><span class="pre">gsub</span></code> comes from <em>Global SUBstitution</em> 。</p>
<p>If <code class="docutils literal notranslate"><span class="pre">repl</span></code> is a string, then use this string as the replacement. The character <code class="docutils literal notranslate"><span class="pre">%</span></code> is an escape character: all strings of the form <code class="docutils literal notranslate"><span class="pre">%_d_</span></code> in <code class="docutils literal notranslate"><span class="pre">repl</span></code> represent the_d_th captured substring, which can be 1 through 9. The string <code class="docutils literal notranslate"><span class="pre">%0</span></code> represents the entire match. The string <code class="docutils literal notranslate"><span class="pre">%%</span></code> represents a single <code class="docutils literal notranslate"><span class="pre">%</span></code>。</p>
<p>If <code class="docutils literal notranslate"><span class="pre">repl</span></code> is a table, each match will use the first catch as a key to look up the table.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">repl</span></code> is a function, this function is called every time a match occurs. All captured substrings are passed in as parameters in turn.</p>
<p>In any case, no capture set in the template is considered to capture the entire template.</p>
<p>If the query result of the table or the return result of the function is a string or a number, it is used as a replacement string. However, when returning <strong>false</strong>or<strong>nil</strong>, no replacement is made (that is, the original string before matching is retained）。</p>
<p>Here are some use cases：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> x = string.gsub("hello world", "(%w+)", "%1 %1")
 --&gt; x="hello hello world world"

 x = string.gsub("hello world", "%w+", "%0 %0", 1)
 --&gt; x="hello hello world"

 x = string.gsub("hello world from Lua", "(%w+)%s\*(%w+)", "%2 %1")
 --&gt; x="world hello Lua from"

 x = string.gsub("home = $HOME, user = $USER", "%$(%w+)", os.getenv)
 --&gt; x="home = /home/roberto, user = roberto"

 x = string.gsub("4+5 = $return 4+5$", "%$(.-)%$", function (s)
       return load(s)()
     end)
 --&gt; x="4+5 = 9"

 local t = {name="lua", version="5.3"}
 x = string.gsub("$name-$version.tar.gz", "%$(%w+)", t)
 --&gt; x="lua-5.3.tar.gz"
</pre></div>
</div>
</section>
<hr class="docutils"/>
<section id="string-len-s">
<h4><code class="docutils literal notranslate"><span class="pre">string.len</span> <span class="pre">(s)</span></code><a class="headerlink" href="#string-len-s" title="Permalink to this headline">#</a></h4>
<p>Receives a string and returns its length. The length of the empty string <code class="docutils literal notranslate"><span class="pre">""</span></code> is 0. Embedded zeros are also counted, so the length of <code class="docutils literal notranslate"><span class="pre">"a\000bc\000"</span></code> is 5 。</p>
</section>
<hr class="docutils"/>
<section id="string-lower-s">
<h4><code class="docutils literal notranslate"><span class="pre">string.lower</span> <span class="pre">(s)</span></code><a class="headerlink" href="#string-lower-s" title="Permalink to this headline">#</a></h4>
<p>Receives a string, converts all uppercase characters in it to lowercase, and returns a copy of it. Other strings do not change. The definition of uppercase characters depends on the current locale.</p>
</section>
<hr class="docutils"/>
<section id="string-match-s-pattern-init">
<h4><code class="docutils literal notranslate"><span class="pre">string.match</span> <span class="pre">(s,</span> <span class="pre">pattern</span> <span class="pre">[,</span> <span class="pre">init])</span></code><a class="headerlink" href="#string-match-s-pattern-init" title="Permalink to this headline">#</a></h4>
<p>Find the first part of the string <code class="docutils literal notranslate"><span class="pre">s</span></code> that can be matched with <code class="docutils literal notranslate"><span class="pre">pattern</span></code> (see <span class="xref myst">§ 6.4.1</span>). If found, <code class="docutils literal notranslate"><span class="pre">match</span></code> returns the catch; otherwise, it returns **nil * *. If no capture is specified in <code class="docutils literal notranslate"><span class="pre">pattern</span></code>, the entire string captured by <code class="docutils literal notranslate"><span class="pre">pattern</span></code> is returned. The third optional numeric parameter <code class="docutils literal notranslate"><span class="pre">init</span></code> indicates where to start the search; it defaults to 1 and can be negative.</p>
</section>
<hr class="docutils"/>
<section id="string-pack-fmt-v1-v2">
<h4><code class="docutils literal notranslate"><span class="pre">string.pack</span> <span class="pre">(fmt,</span> <span class="pre">v1,</span> <span class="pre">v2,</span> <span class="pre">···)</span></code><a class="headerlink" href="#string-pack-fmt-v1-v2" title="Permalink to this headline">#</a></h4>
<p>Returns a binary string packed (I. e., serialized in binary form) with the values <code class="docutils literal notranslate"><span class="pre">v1</span></code>, <code class="docutils literal notranslate"><span class="pre">v2</span></code>, etc. The string <code class="docutils literal notranslate"><span class="pre">fmt</span></code> is in packed format (see. <span class="xref myst">§6.4.2</span>）。</p>
</section>
<hr class="docutils"/>
<section id="string-packsize-fmt">
<h4><code class="docutils literal notranslate"><span class="pre">string.packsize</span> <span class="pre">(fmt)</span></code><a class="headerlink" href="#string-packsize-fmt" title="Permalink to this headline">#</a></h4>
<p>Returns the length of a string packed with <span class="xref myst">‘string.pack’</span> in the specified format. The variable-length options ‘’s’’ or ‘’z’’ are not allowed in the formatted string (see. <span class="xref myst">§6.4.2</span>）。</p>
</section>
<hr class="docutils"/>
<section id="string-rep-s-n-sep">
<h4><code class="docutils literal notranslate"><span class="pre">string.rep</span> <span class="pre">(s,</span> <span class="pre">n</span> <span class="pre">[,</span> <span class="pre">sep])</span></code><a class="headerlink" href="#string-rep-s-n-sep" title="Permalink to this headline">#</a></h4>
<p>Returns a string of <code class="docutils literal notranslate"><span class="pre">n</span></code> strings <code class="docutils literal notranslate"><span class="pre">s</span></code> concatenated with the string <code class="docutils literal notranslate"><span class="pre">sep</span></code> as the delimiter. The default <code class="docutils literal notranslate"><span class="pre">sep</span></code> value is an empty string (I. e. no delimiter). Returns an empty string if <code class="docutils literal notranslate"><span class="pre">n</span></code> is not a positive number.</p>
</section>
<hr class="docutils"/>
<section id="string-reverse-s">
<h4><code class="docutils literal notranslate"><span class="pre">string.reverse</span> <span class="pre">(s)</span></code><a class="headerlink" href="#string-reverse-s" title="Permalink to this headline">#</a></h4>
<p>Returns the flipped string of the string`s.</p>
</section>
<hr class="docutils"/>
<section id="string-sub-s-i-j">
<h4><code class="docutils literal notranslate"><span class="pre">string.sub</span> <span class="pre">(s,</span> <span class="pre">i</span> <span class="pre">[,</span> <span class="pre">j])</span></code><a class="headerlink" href="#string-sub-s-i-j" title="Permalink to this headline">#</a></h4>
<p>Returns a substring of <code class="docutils literal notranslate"><span class="pre">s</span></code>, starting with <code class="docutils literal notranslate"><span class="pre">I</span></code> and ending with <code class="docutils literal notranslate"><span class="pre">j</span></code>; both <code class="docutils literal notranslate"><span class="pre">I</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span></code> can be negative. If <code class="docutils literal notranslate"><span class="pre">j</span></code> is not given, it is assumed to be -1 (the same length as the string). In particular, the call <code class="docutils literal notranslate"><span class="pre">string.sub(s,1,j)</span></code>can return a prefix string of length <code class="docutils literal notranslate"><span class="pre">j</span></code> for <code class="docutils literal notranslate"><span class="pre">s</span></code>, while <code class="docutils literal notranslate"><span class="pre">string.sub(s,</span> <span class="pre">-I)</span></code> returns a suffix string of length `I.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">I</span></code> is less than 1 after escaping the negative index, it is corrected back to 1. If <code class="docutils literal notranslate"><span class="pre">j</span></code> is greater than the length of the string, it is corrected to the length of the string. If, after the correction, <code class="docutils literal notranslate"><span class="pre">I</span></code> is greater than <code class="docutils literal notranslate"><span class="pre">j</span></code>, the function returns an empty string.</p>
</section>
<hr class="docutils"/>
<section id="string-unpack-fmt-s-pos">
<h4><code class="docutils literal notranslate"><span class="pre">string.unpack</span> <span class="pre">(fmt,</span> <span class="pre">s</span> <span class="pre">[,</span> <span class="pre">pos])</span></code><a class="headerlink" href="#string-unpack-fmt-s-pos" title="Permalink to this headline">#</a></h4>
<p>Returns a value packaged in a string <code class="docutils literal notranslate"><span class="pre">s</span></code> (see <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">string.pack</span></code></span>) in the format <code class="docutils literal notranslate"><span class="pre">fmt</span></code> (see <span class="xref myst">§ 6.4.2</span>). The option <code class="docutils literal notranslate"><span class="pre">pos</span></code> (default is 1) marks where to start reading from<code class="docutils literal notranslate"><span class="pre">s.</span> <span class="pre">After</span> <span class="pre">reading</span> <span class="pre">all</span> <span class="pre">the</span> <span class="pre">values,</span> <span class="pre">the</span> <span class="pre">function</span> <span class="pre">returns</span> <span class="pre">the</span> <span class="pre">position</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">first</span> <span class="pre">unread</span> <span class="pre">byte</span> <span class="pre">in</span></code>s.</p>
</section>
<hr class="docutils"/>
<section id="string-upper-s">
<h4><code class="docutils literal notranslate"><span class="pre">string.upper</span> <span class="pre">(s)</span></code><a class="headerlink" href="#string-upper-s" title="Permalink to this headline">#</a></h4>
<p>Receives a string, converts all lowercase characters to uppercase, and returns a copy. Other strings do not change. The definition of lowercase characters depends on the current locale.</p>
</section>
<section id="match-mode">
<h4>6.4.1 – Match mode<a class="headerlink" href="#match-mode" title="Permalink to this headline">#</a></h4>
<p>Lua The matching pattern in is described directly with a regular string. It is used for pattern matching functions <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">string.find</span></code></span>, <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">string.gmatch</span></code></span>, <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">string.gsub</span></code></span>, <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">string.match</span></code></span>. This section describes the syntax and meaning of these strings (I. e., what it can match）。</p>
<section id="character-class">
<h5>Character Class：<a class="headerlink" href="#character-class" title="Permalink to this headline">#</a></h5>
<p>_ Character class_is used to represent a collection of characters. The following combinations are available for character classes：</p>
<ul>
<li><p><strong><em>x</em>:</strong> （Here_x_cannot be a member of the_magic character_<code class="docutils literal notranslate"><span class="pre">^$()%.[]*</span> <span class="pre">+-?</span></code>) represents the character_x_itself.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">.</span></code>:</strong> （A dot) can represent any character.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">%a</span></code>:</strong> Indicates any letter.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">%c</span></code>:</strong> Represents any control character.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">%d</span></code>:</strong> Represents any number.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">%g</span></code>:</strong> Represents any printable character other than a white-space character.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">%l</span></code>:</strong> Indicates all lowercase letters.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">%p</span></code>:</strong> Represents all punctuation marks.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">%s</span></code>:</strong> Represents all white space characters.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">%u</span></code>:</strong> Indicates all uppercase letters.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">%w</span></code>:</strong> Represents all letters and numbers.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">%x</span></code>:</strong> Represents all hexadecimal numeric symbols.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">%_x_</span></code>:</strong> （Here_x_is any non-alphabetic or numeric character) represents the character_x_. This is the standard method for escaping magic characters. All non-alphabetic or numeric characters (including all punctuation marks and also non-magic characters) can represent themselves by being preceded by a ‘%’ in the pattern string.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">[_set_]</span></code>:</strong> Represents the union of all characters in_set. Characters at both ends of a range can be written in ascending order to represent a range of character sets. The <code class="docutils literal notranslate"><span class="pre">%</span></code>_x_form mentioned above can also be used in_set_to represent one of the elements. Other characters that appear in_set_represent themselves. For example, <code class="docutils literal notranslate"><span class="pre">[%w_]</span></code> (or <code class="docutils literal notranslate"><span class="pre">[_%w]</span></code>) means all alphanumerics plus underscores), <code class="docutils literal notranslate"><span class="pre">[0-7]</span></code> means octuary digits, and <code class="docutils literal notranslate"><span class="pre">[0-7%</span> <span class="pre">l%-]</span></code> means octuary digits plus lowercase letters and <code class="docutils literal notranslate"><span class="pre">-</span></code> characters.</p>
<p>The behavior of cross-using classes and scopes is undefined. Therefore, pattern strings like <code class="docutils literal notranslate"><span class="pre">[%a-z]</span></code> or <code class="docutils literal notranslate"><span class="pre">[a-%%]</span></code> have no meaning.</p>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">[^_set_]</span></code>:</strong> Represents the complement of_set_, where_set_is as explained above.</p></li>
</ul>
<p>All categories represented by a single letter (<code class="docutils literal notranslate"><span class="pre">%a</span></code>,<code class="docutils literal notranslate"><span class="pre">%c</span></code>, etc.), if their letters are changed to uppercase, represent the corresponding complement. For example, <code class="docutils literal notranslate"><span class="pre">%S</span></code> represents all non-space characters.</p>
<p>How you define letters, spaces, or other groups of characters depends on your current locale. Special note: <code class="docutils literal notranslate"><span class="pre">[a-z]</span></code> is not necessarily equivalent <code class="docutils literal notranslate"><span class="pre">%l</span></code> 。</p>
</section>
<section id="mode-entry">
<h5>Mode Entry：<a class="headerlink" href="#mode-entry" title="Permalink to this headline">#</a></h5>
<p>_ Mode Entries_can be</p>
<ul class="simple">
<li><p>A single character class matches any single character in that class；</p></li>
<li><p>A single character class followed by a ‘’*’’ will match zero or more characters of that class. This entry always matches the longest possible string；</p></li>
<li><p>A single character class followed by a ‘’’’’’ will match one or more characters of that class. This entry always matches the longest possible string；</p></li>
<li><p>A single character class followed by a <code class="docutils literal notranslate"><span class="pre">-</span></code> will match zero or more characters of that class. Unlike <code class="docutils literal notranslate"><span class="pre">*</span></code>, this entry always matches the shortest possible string；</p></li>
<li><p>A single character class followed by a ‘’?’’ will match zero or one character of that class. Whenever possible, it will match a；</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%_n_</span></code>， The_n_here can be from 1 to 9; this entry matches a substring equal to the_n_catch (described later).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%b_xy_</span></code>， Here_x_and_y_are two explicit characters; this entry matches a string that starts with_x_and ends with_y_, and where_x_and_y_remain_balanced. This means that if you read this string from left to right, every time you read a_x_, you_+1_, and when you read a_y_, you_-1_, and the_y_at the end is the first_y_that counts to 0_. For example, the entry <code class="docutils literal notranslate"><span class="pre">%</span> <span class="pre">B</span> <span class="pre">()</span></code> can be matched to a parenthetically balanced expression.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%f[_set_]</span></code>， Refers to the_border pattern_; This entry will match an empty string before a character in_set_, and the previous character in this position does not belong to_set_. The meaning of set_set_is as described earlier. The start and end points of the matched empty string are calculated as if there is a character ‘\0’ there.</p></li>
</ul>
</section>
<section id="mode">
<h5>Mode：<a class="headerlink" href="#mode" title="Permalink to this headline">#</a></h5>
<p>_ Patters_refers to a sequence of pattern entries. Adding the symbol <code class="docutils literal notranslate"><span class="pre">^</span></code> to the front of the pattern will anchor the match from the beginning of the string. Adding the symbol <code class="docutils literal notranslate"><span class="pre">$</span></code> at the end of the pattern will anchor the matching process to the end of the string. If <code class="docutils literal notranslate"><span class="pre">^</span></code> and <code class="docutils literal notranslate"><span class="pre">$</span></code> appear elsewhere, they have no special meaning, only themselves.</p>
</section>
<section id="capture">
<h5>Capture：<a class="headerlink" href="#capture" title="Permalink to this headline">#</a></h5>
<p>A pattern can be internally bracketed with a sub-pattern; these sub-patterns are called_catch_. When the match is successful, the substring in the string matched by the_catch_is saved for future use. The catches are numbered in the order of their opening brackets. For example, for the pattern <code class="docutils literal notranslate"><span class="pre">"(a</span> <span class="pre">*(.)%w(%s</span> <span class="pre">*))"</span></code>, the part of the string matching <code class="docutils literal notranslate"><span class="pre">"a</span> <span class="pre">*(.)%w(%s</span> <span class="pre">*)"</span></code> is stored in the first catch (hence the number 1 ); the character matched by “<code class="docutils literal notranslate"><span class="pre">.</span></code>” is the number 2 catch, the part that matches “<code class="docutils literal notranslate"><span class="pre">%s</span> <span class="pre">*</span></code>” is number 3.</p>
<p>As a special case, an empty capture <code class="docutils literal notranslate"><span class="pre">()</span></code> will capture the position of the current string (it is a number). For example, if the pattern <code class="docutils literal notranslate"><span class="pre">"()aa()"</span> <span class="pre">"is</span> <span class="pre">applied</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">string</span></code>” flaaap “`, two captures will be produced: 3 and 5 。</p>
</section>
</section>
<section id="format-string-used-for-packaging-and-unpacking">
<h4>6.4.2 – Format string used for packaging and unpacking<a class="headerlink" href="#format-string-used-for-packaging-and-unpacking" title="Permalink to this headline">#</a></h4>
<p>The first argument for <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">string.pack</span></code></span>, <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">string.packsize</span></code></span>, <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">string.unpack</span></code></span>. It is a layout that describes the structure that needs to be created or read.</p>
<p>A format string is a sequence of conversion options. These conversion options are listed in：</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">&lt;</span></code>:</strong> Set to Little Ended</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">&gt;</span></code>:</strong> Set to Big Endian</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">=</span></code>:</strong> Size side follows local settings</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">![_n_]</span></code>:</strong> Set the maximum number of alignments to <code class="docutils literal notranslate"><span class="pre">n</span></code> (default follows local alignment settings）</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">b</span></code>:</strong> A signed byte (<code class="docutils literal notranslate"><span class="pre">char</span></code>)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">B</span></code>:</strong> An unsigned byte (<code class="docutils literal notranslate"><span class="pre">char</span></code>)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">h</span></code>:</strong> A signed <code class="docutils literal notranslate"><span class="pre">short</span></code> (local size）</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">H</span></code>:</strong> An unsigned <code class="docutils literal notranslate"><span class="pre">short</span></code> (local size）</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">l</span></code>:</strong> A signed <code class="docutils literal notranslate"><span class="pre">long</span></code> (local size）</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">L</span></code>:</strong> An unsigned <code class="docutils literal notranslate"><span class="pre">long</span></code> (local size）</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">j</span></code>:</strong> One <code class="docutils literal notranslate"><span class="pre">lua_Integer</span></code></p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">J</span></code>:</strong> One <code class="docutils literal notranslate"><span class="pre">lua_Unsigned</span></code></p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">T</span></code>:</strong> a <code class="docutils literal notranslate"><span class="pre">size_t</span></code> (local size）</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">i[_n_]</span></code>:</strong> One <code class="docutils literal notranslate"><span class="pre">n</span></code> byte long (default to local size) signed <code class="docutils literal notranslate"><span class="pre">int</span></code></p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">I[_n_]</span></code>:</strong> One <code class="docutils literal notranslate"><span class="pre">n</span></code> byte long (default to local size) unsigned <code class="docutils literal notranslate"><span class="pre">int</span></code></p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">f</span></code>:</strong> a <code class="docutils literal notranslate"><span class="pre">float</span></code> (local size）</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">d</span></code>:</strong> a <code class="docutils literal notranslate"><span class="pre">double</span></code> (local size）</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">n</span></code>:</strong> One <code class="docutils literal notranslate"><span class="pre">lua_Number</span></code></p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">c_n_</span></code>:</strong> <code class="docutils literal notranslate"><span class="pre">n</span></code>Byte fixed-length string</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">z</span></code>:</strong> Zero-terminated string</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">s[_n_]</span></code>:</strong> The length plus content string is encoded as an unsigned integer of <code class="docutils literal notranslate"><span class="pre">n</span></code> bytes (by default, <code class="docutils literal notranslate"><span class="pre">size_t</span> </code>).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">x</span></code>:</strong> A byte of padding</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">X_op_</span></code>:</strong> An empty entry aligned as the option <code class="docutils literal notranslate"><span class="pre">op</span></code> (ignoring other aspects of it)</p></li>
<li><p><strong>‘  ‘:</strong> （spaces) ignore</p></li>
</ul>
<p>（ “<code class="docutils literal notranslate"><span class="pre">[_n_]</span></code>” Represents an optional integer.) Except padding, spaces, configuration items (option “<code class="docutils literal notranslate"><span class="pre">xX</span> <span class="pre">&lt;=&gt;!</span> </code>“), each option is associated with a parameter (for <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">string.pack</span></code></span>) or a result ( <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">string.unpack</span></code></span>）。</p>
<p>For option “<code class="docutils literal notranslate"><span class="pre">!</span> <span class="pre">_n_</span></code>”, “<code class="docutils literal notranslate"> <span class="pre">s_n_</span></code>”, “<code class="docutils literal notranslate"> <span class="pre">I_n_</span></code>”, “<code class="docutils literal notranslate"> <span class="pre">I_n_</span></code>”, <code class="docutils literal notranslate"><span class="pre">n</span></code> can be an integer between 1 and 16. All integer options will be checked for overflow; <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">string.pack</span></code></span> checks whether the supplied value can be expressed in the specified word length; <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">string.unpack</span></code></span> checks whether the read value can be placed in a Lua integer.</p>
<p>Any format string assumes a “<code class="docutils literal notranslate"><span class="pre">!</span> <span class="pre">1</span> <span class="pre">=</span> </code>“prefix, that is, the maximum alignment is 1 (no alignment) and the local size side setting is used.</p>
<p>Alignment works according to the following rules: for each option, formatting will be filled with some bytes until the data starts at a specific offset, which is a multiple of the smaller of the size and maximum alignment number of the option; This smaller value must be 2 integer powers. Options “<code class="docutils literal notranslate"><span class="pre">c</span></code>” and “<code class="docutils literal notranslate"><span class="pre">z</span></code>” do not do alignment; option “<code class="docutils literal notranslate"><span class="pre">s</span></code>” follows its beginning integer for alignment.</p>
<p><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">string.pack</span></code></span> Padding with zeros (<span class="xref myst"><code class="docutils literal notranslate"><span class="pre">string.unpack</span></code></span> is ignored）。</p>
</section>
</section>
<section id="utf-8-support">
<h3>6.5 – UTF-8 Support<a class="headerlink" href="#utf-8-support" title="Permalink to this headline">#</a></h3>
<p>This library provides basic support for UTF-8 coding. All functions are placed in the table `utf8. This library does not provide any Unicode support other than encoding processing. All operations that require understanding the meaning of characters, such as character classification, are not in this category.</p>
<p>Unless otherwise stated, when a function requires an argument for a byte position, it is assumed that the position is calculated either from the beginning of the byte sequence or from the position of the string length plus one. As with string libraries, negative indexes start at the end of the string.</p>
<hr class="docutils"/>
<section id="utf8-char">
<h4><code class="docutils literal notranslate"><span class="pre">utf8.char</span> <span class="pre">(···)</span></code><a class="headerlink" href="#utf8-char" title="Permalink to this headline">#</a></h4>
<p>Receives zero or more integers, converts each integer into a corresponding sequence of UTF-8 bytes, and returns a string of these sequences concatenated together.</p>
</section>
<hr class="docutils"/>
<section id="utf8-charpattern">
<h4><code class="docutils literal notranslate"><span class="pre">utf8.charpattern</span></code><a class="headerlink" href="#utf8-charpattern" title="Permalink to this headline">#</a></h4>
<p>A pattern (is a string, not a function) for exact matching to a UTF-8 byte sequence “<code class="docutils literal notranslate"><span class="pre">[\0-\x7F\xC2-\xF4][\x80-\xBF]*</span></code>” (see <span class="xref myst">§ 6.4.1</span>). It assumes that the object being processed is a legal UTF-8 string.</p>
</section>
<hr class="docutils"/>
<section id="utf8-codes-s">
<h4><code class="docutils literal notranslate"><span class="pre">utf8.codes</span> <span class="pre">(s)</span></code><a class="headerlink" href="#utf8-codes-s" title="Permalink to this headline">#</a></h4>
<p>Returns a series of values that allow</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> for p, c in utf8.codes(s) do _body_ end
</pre></div>
</div>
<p>Iterate out all the characters in the string<code class="docutils literal notranslate"><span class="pre">s.</span> <span class="pre">Here</span> </code>p<code class="docutils literal notranslate"><span class="pre">is</span> <span class="pre">the</span> <span class="pre">position</span> <span class="pre">(in</span> <span class="pre">bytes)</span> <span class="pre">and</span></code>c` is the number of each character. If an illegal sequence of bytes is processed, an error will be thrown.</p>
</section>
<hr class="docutils"/>
<section id="utf8-codepoint-s-i-j">
<h4><code class="docutils literal notranslate"><span class="pre">utf8.codepoint</span> <span class="pre">(s</span> <span class="pre">[,</span> <span class="pre">i</span> <span class="pre">[,</span> <span class="pre">j]])</span></code><a class="headerlink" href="#utf8-codepoint-s-i-j" title="Permalink to this headline">#</a></h4>
<p>Returns the number of all characters in <code class="docutils literal notranslate"><span class="pre">s</span></code> from position <code class="docutils literal notranslate"><span class="pre">I</span></code> to <code class="docutils literal notranslate"><span class="pre">j</span></code> (both ends inclusive) as an integer. The default <code class="docutils literal notranslate"><span class="pre">I</span></code> is 1 and the default <code class="docutils literal notranslate"><span class="pre">j</span></code> is <code class="docutils literal notranslate"><span class="pre">I</span></code>. If an illegal byte sequence is encountered, an error is thrown.</p>
</section>
<hr class="docutils"/>
<section id="utf8-len-s-i-j">
<h4><code class="docutils literal notranslate"><span class="pre">utf8.len</span> <span class="pre">(s</span> <span class="pre">[,</span> <span class="pre">i</span> <span class="pre">[,</span> <span class="pre">j]])</span></code><a class="headerlink" href="#utf8-len-s-i-j" title="Permalink to this headline">#</a></h4>
<p>Returns the number of UTF-8 characters in the string <code class="docutils literal notranslate"><span class="pre">s</span></code> from position <code class="docutils literal notranslate"><span class="pre">I</span></code> to <code class="docutils literal notranslate"><span class="pre">j</span></code> (both ends inclusive). The default <code class="docutils literal notranslate"><span class="pre">I</span></code> is 1, and the default <code class="docutils literal notranslate"><span class="pre">j</span></code> is -1. If it finds any illegal byte sequence, it returns a false value plus the position of the first illegal byte.</p>
</section>
<hr class="docutils"/>
<section id="utf8-offset-s-n-i">
<h4><code class="docutils literal notranslate"><span class="pre">utf8.offset</span> <span class="pre">(s,</span> <span class="pre">n</span> <span class="pre">[,</span> <span class="pre">i])</span></code><a class="headerlink" href="#utf8-offset-s-n-i" title="Permalink to this headline">#</a></h4>
<p>Returns the starting position (in bytes) of the <code class="docutils literal notranslate"><span class="pre">n</span></code> character encoded in <code class="docutils literal notranslate"><span class="pre">s</span></code> (counted from position <code class="docutils literal notranslate"><span class="pre">I</span></code>). Negative <code class="docutils literal notranslate"><span class="pre">n</span></code> takes the character before position <code class="docutils literal notranslate"><span class="pre">I.</span> <span class="pre">The</span> <span class="pre">default</span> </code>I<code class="docutils literal notranslate"><span class="pre">is</span> <span class="pre">1</span> <span class="pre">when</span></code>n<code class="docutils literal notranslate"><span class="pre">is</span> <span class="pre">non-negative,</span> <span class="pre">otherwise</span> <span class="pre">it</span> <span class="pre">defaults</span> <span class="pre">to</span></code>#s 1<code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">Therefore,</span> </code>utf8.offset(s, -n)<code class="docutils literal notranslate"><span class="pre">takes</span> <span class="pre">the</span> <span class="pre">position</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">last</span> </code>n` character of the string. If the specified character is not in it or after the end point, the function returns <strong>nil</strong>。</p>
<p>As a special case, when <code class="docutils literal notranslate"><span class="pre">n</span></code> is equal to 0, this function returns the starting position of the character containing the <code class="docutils literal notranslate"><span class="pre">I</span></code> byte of`s.</p>
<p>This function assumes that <code class="docutils literal notranslate"><span class="pre">s</span></code> is a legal UTF-8 string.</p>
</section>
</section>
<section id="table-processing">
<h3>6.6 – Table Processing<a class="headerlink" href="#table-processing" title="Permalink to this headline">#</a></h3>
<p>This library provides generic functions for table processing. All functions are placed in the table `table.</p>
<p>Remember that whenever an operation needs to take the length of a table, the table must be a true sequence or have a <code class="docutils literal notranslate"><span class="pre">__len</span></code> meta method (see <span class="xref myst">§ 3.4.7</span> ). All functions ignore the non-numeric keys in the table of incoming arguments.</p>
<hr class="docutils"/>
<section id="table-concat-list-sep-i-j">
<h4><code class="docutils literal notranslate"><span class="pre">table.concat</span> <span class="pre">(list</span> <span class="pre">[,</span> <span class="pre">sep</span> <span class="pre">[,</span> <span class="pre">i</span> <span class="pre">[,</span> <span class="pre">j]]])</span></code><a class="headerlink" href="#table-concat-list-sep-i-j" title="Permalink to this headline">#</a></h4>
<p>Provide a list whose elements are all strings or numbers, and return the string <code class="docutils literal notranslate"><span class="pre">list</span> <span class="pre">[I]</span> <span class="pre">..</span> <span class="pre">sep</span> <span class="pre">..</span> <span class="pre">list</span> <span class="pre">[I</span> <span class="pre">1]</span> <span class="pre">·</span> <span class="pre">·</span> <span class="pre">·</span> <span class="pre">sep</span> <span class="pre">..</span> <span class="pre">list[j]</span></code>. The default value of <code class="docutils literal notranslate"><span class="pre">sep</span></code> is an empty string, the default value of <code class="docutils literal notranslate"><span class="pre">I</span></code> is 1, and the default value of <code class="docutils literal notranslate"><span class="pre">j</span></code> is <code class="docutils literal notranslate"><span class="pre">#list</span></code>. If <code class="docutils literal notranslate"><span class="pre">I</span></code> is greater than <code class="docutils literal notranslate"><span class="pre">j</span></code>, an empty string is returned.</p>
</section>
<hr class="docutils"/>
<section id="table-insert-list-pos-value">
<h4><code class="docutils literal notranslate"><span class="pre">table.insert</span> <span class="pre">(list,</span> <span class="pre">[pos,]</span> <span class="pre">value)</span></code><a class="headerlink" href="#table-insert-list-pos-value" title="Permalink to this headline">#</a></h4>
<p>Insert the element<code class="docutils literal notranslate"><span class="pre">value</span></code> at the position <code class="docutils literal notranslate"><span class="pre">pos</span></code> of<code class="docutils literal notranslate"><span class="pre">list</span></code>, and move the element<code class="docutils literal notranslate"><span class="pre">list</span> <span class="pre">[pos],</span> <span class="pre">list[pos</span> <span class="pre">1],...,</span> <span class="pre">list[#list]</span></code>backward<code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">The</span> <span class="pre">default</span> <span class="pre">value</span> <span class="pre">of</span> </code>pos<code class="docutils literal notranslate"><span class="pre">is</span></code>#list 1<code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">so</span> <span class="pre">calling</span> </code>table.insert(t,x)<code class="docutils literal notranslate"><span class="pre">will</span> <span class="pre">insert</span> </code>x<code class="docutils literal notranslate"> <span class="pre">at</span> <span class="pre">the</span> <span class="pre">end</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">list</span></code>t.</p>
</section>
<hr class="docutils"/>
<section id="table-move-a1-f-e-t-a2">
<h4><code class="docutils literal notranslate"><span class="pre">table.move</span> <span class="pre">(a1,</span> <span class="pre">f,</span> <span class="pre">e,</span> <span class="pre">t</span> <span class="pre">[,a2])</span></code><a class="headerlink" href="#table-move-a1-f-e-t-a2" title="Permalink to this headline">#</a></h4>
<p>Move element from table <code class="docutils literal notranslate"><span class="pre">a1</span></code> to table <code class="docutils literal notranslate"><span class="pre">a2</span> </code>. This function does the equivalent of the following multiple assignment: <code class="docutils literal notranslate"><span class="pre">a2[t],...</span> <span class="pre">=</span> <span class="pre">a1[f],...,</span> <span class="pre">a1[e]</span></code>. The default value for <code class="docutils literal notranslate"><span class="pre">a2</span></code> is <code class="docutils literal notranslate"><span class="pre">a1</span> </code>. The target interval may overlap with the source interval. Index <code class="docutils literal notranslate"><span class="pre">f</span></code> must be a positive number.</p>
</section>
<hr class="docutils"/>
<section id="table-pack">
<h4><code class="docutils literal notranslate"><span class="pre">table.pack</span> <span class="pre">(···)</span></code><a class="headerlink" href="#table-pack" title="Permalink to this headline">#</a></h4>
<p>Returns a new table populated with all parameters with keys 1,2, etc., and sets the field “<code class="docutils literal notranslate"><span class="pre">n</span></code>” to the total number of parameters. Note that the returned table is not necessarily a sequence.</p>
</section>
<hr class="docutils"/>
<section id="table-remove-list-pos">
<h4><code class="docutils literal notranslate"><span class="pre">table.remove</span> <span class="pre">(list</span> <span class="pre">[,</span> <span class="pre">pos])</span></code><a class="headerlink" href="#table-remove-list-pos" title="Permalink to this headline">#</a></h4>
<p>Removes the element at the <code class="docutils literal notranslate"><span class="pre">pos</span></code> position in <code class="docutils literal notranslate"><span class="pre">list</span></code> and returns the removed value. When <code class="docutils literal notranslate"><span class="pre">pos</span></code> is an integer between 1 and <code class="docutils literal notranslate"><span class="pre">#list</span></code>, it moves the elements <code class="docutils literal notranslate"><span class="pre">list[pos</span> <span class="pre">1],</span> <span class="pre">list[pos</span> <span class="pre">2],...,</span> <span class="pre">list[#list]</span></code> forward and deletes the element <code class="docutils literal notranslate"><span class="pre">list[#list]</span></code>; the index <code class="docutils literal notranslate"><span class="pre">pos</span></code> can be<code class="docutils literal notranslate"><span class="pre">#list</span> <span class="pre">1</span> </code>, or 0 when<code class="docutils literal notranslate"><span class="pre">#list</span> </code>is 0; in these cases, the function deletes the element <code class="docutils literal notranslate"><span class="pre">list[pos]</span></code>。</p>
<p><code class="docutils literal notranslate"><span class="pre">pos</span></code> The default is <code class="docutils literal notranslate"><span class="pre">#list</span></code>, so calling <code class="docutils literal notranslate"><span class="pre">table.remove(l)</span></code> will remove the last element of table `l.</p>
</section>
<hr class="docutils"/>
<section id="table-sort-list-comp">
<h4><code class="docutils literal notranslate"><span class="pre">table.sort</span> <span class="pre">(list</span> <span class="pre">[,</span> <span class="pre">comp])</span></code><a class="headerlink" href="#table-sort-list-comp" title="Permalink to this headline">#</a></h4>
<p>Sorts elements from <code class="docutils literal notranslate"><span class="pre">list[1]</span></code>to <code class="docutils literal notranslate"><span class="pre">list[#list]</span></code> within a table in a specified order. If <code class="docutils literal notranslate"><span class="pre">comp</span></code> is provided, it must be a function that can receive two list elements as parameters. When the first element needs to be ranked before the second element, it returns true (so <code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">comp(list</span> <span class="pre">[I</span> <span class="pre">1],list</span> <span class="pre">[I])</span></code>will be true after sorting). If <code class="docutils literal notranslate"><span class="pre">comp</span></code> is not provided, the standard Lua operation <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> will be used as an alternative.</p>
<p>The sorting algorithm is not stable; that is, when two elements are in equal order, their relative positions after sorting may change.</p>
</section>
<hr class="docutils"/>
<section id="table-unpack-list-i-j">
<h4><code class="docutils literal notranslate"><span class="pre">table.unpack</span> <span class="pre">(list</span> <span class="pre">[,</span> <span class="pre">i</span> <span class="pre">[,</span> <span class="pre">j]])</span></code><a class="headerlink" href="#table-unpack-list-i-j" title="Permalink to this headline">#</a></h4>
<p>Returns the elements in a list. This function is equivalent</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> return list\[i\], list\[i+1\], ···, list\[j\]
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">i</span></code> Default is 1 ,<code class="docutils literal notranslate"><span class="pre">j</span></code> defaults <code class="docutils literal notranslate"><span class="pre">#list</span></code>。</p>
</section>
</section>
<section id="mathematical-function">
<h3>6.7 – mathematical function<a class="headerlink" href="#mathematical-function" title="Permalink to this headline">#</a></h3>
<p>This library provides basic math functions. So the functions are all placed in the table <code class="docutils literal notranslate"><span class="pre">math.</span> <span class="pre">Functions</span> <span class="pre">annotated</span> <span class="pre">with</span> <span class="pre">"</span></code>integer/float<code class="docutils literal notranslate"><span class="pre">"</span> <span class="pre">return</span> <span class="pre">integer</span> <span class="pre">results</span> <span class="pre">for</span> <span class="pre">integer</span> <span class="pre">arguments</span> <span class="pre">and</span> <span class="pre">floating-point</span> <span class="pre">results</span> <span class="pre">for</span> <span class="pre">floating-point</span> <span class="pre">(or</span> <span class="pre">mixed)</span> <span class="pre">arguments.</span> <span class="pre">The</span> <span class="pre">Circle</span> <span class="pre">Entire</span> <span class="pre">functions</span> <span class="pre">([</span></code>math.ceil<code class="docutils literal notranslate"><span class="pre">](#pdf-math.ceil),</span> <span class="pre">[</span></code>math.floor<code class="docutils literal notranslate"><span class="pre">](#pdf-math.floor),</span> <span class="pre">[</span></code>math.modf`](#pdf-math.modf)) return an integer if the result is within an integer range, otherwise it returns a floating point number.</p>
<hr class="docutils"/>
<section id="math-abs-x">
<h4><code class="docutils literal notranslate"><span class="pre">math.abs</span> <span class="pre">(x)</span></code><a class="headerlink" href="#math-abs-x" title="Permalink to this headline">#</a></h4>
<p>Returns the absolute value of <code class="docutils literal notranslate"><span class="pre">x</span></code>。(integer/float)</p>
</section>
<hr class="docutils"/>
<section id="math-acos-x">
<h4><code class="docutils literal notranslate"><span class="pre">math.acos</span> <span class="pre">(x)</span></code><a class="headerlink" href="#math-acos-x" title="Permalink to this headline">#</a></h4>
<p>Returns the inverse cosine of <code class="docutils literal notranslate"><span class="pre">x</span></code> (in radians）。</p>
</section>
<hr class="docutils"/>
<section id="math-asin-x">
<h4><code class="docutils literal notranslate"><span class="pre">math.asin</span> <span class="pre">(x)</span></code><a class="headerlink" href="#math-asin-x" title="Permalink to this headline">#</a></h4>
<p>Returns the arcsine of <code class="docutils literal notranslate"><span class="pre">x</span></code> (in radians）。</p>
</section>
<hr class="docutils"/>
<section id="math-atan-y-x">
<h4><code class="docutils literal notranslate"><span class="pre">math.atan</span> <span class="pre">(y</span> <span class="pre">[,</span> <span class="pre">x])</span></code><a class="headerlink" href="#math-atan-y-x" title="Permalink to this headline">#</a></h4>
<p>Returns the arctangent of <code class="docutils literal notranslate"><span class="pre">y/x</span></code> in radians. It uses the sign of the two arguments to find which quadrant the result falls in. (Even if <code class="docutils literal notranslate"><span class="pre">x</span></code> is zero, it can be handled correctly。）</p>
<p>The default <code class="docutils literal notranslate"><span class="pre">x</span></code> is 1, so calling <code class="docutils literal notranslate"><span class="pre">math.atan(y)</span></code>will return the arctangent of `y.</p>
</section>
<hr class="docutils"/>
<section id="math-ceil-x">
<h4><code class="docutils literal notranslate"><span class="pre">math.ceil</span> <span class="pre">(x)</span></code><a class="headerlink" href="#math-ceil-x" title="Permalink to this headline">#</a></h4>
<p>Returns the smallest integer value not less than `x.</p>
</section>
<hr class="docutils"/>
<section id="math-cos-x">
<h4><code class="docutils literal notranslate"><span class="pre">math.cos</span> <span class="pre">(x)</span></code><a class="headerlink" href="#math-cos-x" title="Permalink to this headline">#</a></h4>
<p>Returns the cosine of <code class="docutils literal notranslate"><span class="pre">x</span></code> (assuming the argument is radians）。</p>
</section>
<hr class="docutils"/>
<section id="math-deg-x">
<h4><code class="docutils literal notranslate"><span class="pre">math.deg</span> <span class="pre">(x)</span></code><a class="headerlink" href="#math-deg-x" title="Permalink to this headline">#</a></h4>
<p>Converts angle <code class="docutils literal notranslate"><span class="pre">x</span></code> from radians to angles.</p>
</section>
<hr class="docutils"/>
<section id="math-exp-x">
<h4><code class="docutils literal notranslate"><span class="pre">math.exp</span> <span class="pre">(x)</span></code><a class="headerlink" href="#math-exp-x" title="Permalink to this headline">#</a></h4>
<p>Returns the value of_ex_(<code class="docutils literal notranslate"><span class="pre">e</span></code> is the base of the natural logarithm.）。</p>
</section>
<hr class="docutils"/>
<section id="math-floor-x">
<h4><code class="docutils literal notranslate"><span class="pre">math.floor</span> <span class="pre">(x)</span></code><a class="headerlink" href="#math-floor-x" title="Permalink to this headline">#</a></h4>
<p>Returns the largest integer value not greater than `x.</p>
</section>
<hr class="docutils"/>
<section id="math-fmod-x-y">
<h4><code class="docutils literal notranslate"><span class="pre">math.fmod</span> <span class="pre">(x,</span> <span class="pre">y)</span></code><a class="headerlink" href="#math-fmod-x-y" title="Permalink to this headline">#</a></h4>
<p>Returns the remainder after dividing <code class="docutils literal notranslate"><span class="pre">x</span></code> by <code class="docutils literal notranslate"><span class="pre">y</span></code> and rounding the quotient to zero。 (integer/float)</p>
</section>
<hr class="docutils"/>
<section id="math-huge">
<h4><code class="docutils literal notranslate"><span class="pre">math.huge</span></code><a class="headerlink" href="#math-huge" title="Permalink to this headline">#</a></h4>
<p>Floating-point number HUGE_VAL, this number is greater than any numeric value.</p>
</section>
<hr class="docutils"/>
<section id="math-log-x-base">
<h4><code class="docutils literal notranslate"><span class="pre">math.log</span> <span class="pre">(x</span> <span class="pre">[,</span> <span class="pre">base])</span></code><a class="headerlink" href="#math-log-x-base" title="Permalink to this headline">#</a></h4>
<p>Returns the logarithm of <code class="docutils literal notranslate"><span class="pre">x</span></code> at the specified base. The default <code class="docutils literal notranslate"><span class="pre">base</span></code> is_e_ (so this function returns the natural logarithm of <code class="docutils literal notranslate"><span class="pre">x</span></code>）。</p>
</section>
<hr class="docutils"/>
<section id="math-max-x">
<h4><code class="docutils literal notranslate"><span class="pre">math.max</span> <span class="pre">(x,</span> <span class="pre">···)</span></code><a class="headerlink" href="#math-max-x" title="Permalink to this headline">#</a></h4>
<p>Returns the largest value in the parameter, the size is determined by the Lua operation <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>。 (integer/float)</p>
</section>
<hr class="docutils"/>
<section id="math-maxinteger">
<h4><code class="docutils literal notranslate"><span class="pre">math.maxinteger</span></code><a class="headerlink" href="#math-maxinteger" title="Permalink to this headline">#</a></h4>
<p>The integer of the maximum value.</p>
</section>
<hr class="docutils"/>
<section id="math-min-x">
<h4><code class="docutils literal notranslate"><span class="pre">math.min</span> <span class="pre">(x,</span> <span class="pre">···)</span></code><a class="headerlink" href="#math-min-x" title="Permalink to this headline">#</a></h4>
<p>Returns the smallest value in the parameter, the size is determined by the Lua operation <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>。 (integer/float)</p>
</section>
<hr class="docutils"/>
<section id="math-mininteger">
<h4><code class="docutils literal notranslate"><span class="pre">math.mininteger</span></code><a class="headerlink" href="#math-mininteger" title="Permalink to this headline">#</a></h4>
<p>Integer of the minimum value.</p>
</section>
<hr class="docutils"/>
<section id="math-modf-x">
<h4><code class="docutils literal notranslate"><span class="pre">math.modf</span> <span class="pre">(x)</span></code><a class="headerlink" href="#math-modf-x" title="Permalink to this headline">#</a></h4>
<p>Returns the integer and fractional parts of `x. The second result must be a floating point number.</p>
</section>
<hr class="docutils"/>
<section id="math-pi">
<h4><code class="docutils literal notranslate"><span class="pre">math.pi</span></code><a class="headerlink" href="#math-pi" title="Permalink to this headline">#</a></h4>
<p><em>π</em> The value.</p>
</section>
<hr class="docutils"/>
<section id="math-rad-x">
<h4><code class="docutils literal notranslate"><span class="pre">math.rad</span> <span class="pre">(x)</span></code><a class="headerlink" href="#math-rad-x" title="Permalink to this headline">#</a></h4>
<p>Converts angle <code class="docutils literal notranslate"><span class="pre">x</span></code> from angles to radians.</p>
</section>
<hr class="docutils"/>
<section id="math-random-m-n">
<h4><code class="docutils literal notranslate"><span class="pre">math.random</span> <span class="pre">([m</span> <span class="pre">[,</span> <span class="pre">n]])</span></code><a class="headerlink" href="#math-random-m-n" title="Permalink to this headline">#</a></h4>
<p>When called without arguments, returns a uniformly distributed floating-point pseudo-random number in the interval_[0,1). When called with two integers <code class="docutils literal notranslate"><span class="pre">m</span></code> and <code class="docutils literal notranslate"><span class="pre">n</span></code>, <code class="docutils literal notranslate"><span class="pre">math.random</span></code> returns a uniformly distributed integer pseudo-random number in the interval_[m, n]. (The value_n-m_cannot be negative and must be within the representation of a Lua integer.) Calling <code class="docutils literal notranslate"><span class="pre">math.random(n)</span></code>is equivalent <code class="docutils literal notranslate"><span class="pre">math.random(1,n)</span></code>。</p>
<p>This function is an encapsulation of the bit random number function provided by C. There is no guarantee of its statistical properties.</p>
</section>
<hr class="docutils"/>
<section id="math-randomseed-x">
<h4><code class="docutils literal notranslate"><span class="pre">math.randomseed</span> <span class="pre">(x)</span></code><a class="headerlink" href="#math-randomseed-x" title="Permalink to this headline">#</a></h4>
<p>Set <code class="docutils literal notranslate"><span class="pre">x</span></code> as the “seed” of the pseudo-random number generator: the same seed produces the same random number sequence.</p>
</section>
<hr class="docutils"/>
<section id="math-sin-x">
<h4><code class="docutils literal notranslate"><span class="pre">math.sin</span> <span class="pre">(x)</span></code><a class="headerlink" href="#math-sin-x" title="Permalink to this headline">#</a></h4>
<p>Returns the sine of <code class="docutils literal notranslate"><span class="pre">x</span></code> (assuming the argument is radians）。</p>
</section>
<hr class="docutils"/>
<section id="math-sqrt-x">
<h4><code class="docutils literal notranslate"><span class="pre">math.sqrt</span> <span class="pre">(x)</span></code><a class="headerlink" href="#math-sqrt-x" title="Permalink to this headline">#</a></h4>
<p>Returns the square root of <code class="docutils literal notranslate"><span class="pre">x.</span> <span class="pre">(You</span> <span class="pre">can</span> <span class="pre">also</span> <span class="pre">use</span> <span class="pre">the</span> <span class="pre">power</span> </code>x ^ 0.5 `to calculate this value。）</p>
</section>
<hr class="docutils"/>
<section id="math-tan-x">
<h4><code class="docutils literal notranslate"><span class="pre">math.tan</span> <span class="pre">(x)</span></code><a class="headerlink" href="#math-tan-x" title="Permalink to this headline">#</a></h4>
<p>Returns the tangent of <code class="docutils literal notranslate"><span class="pre">x</span></code> (assuming the argument is radian）。</p>
</section>
<hr class="docutils"/>
<section id="math-tointeger-x">
<h4><code class="docutils literal notranslate"><span class="pre">math.tointeger</span> <span class="pre">(x)</span></code><a class="headerlink" href="#math-tointeger-x" title="Permalink to this headline">#</a></h4>
<p>If <code class="docutils literal notranslate"><span class="pre">x</span></code> can be converted to an integer, return that integer. Otherwise return <strong>nil</strong>。</p>
</section>
<hr class="docutils"/>
<section id="math-type-x">
<h4><code class="docutils literal notranslate"><span class="pre">math.type</span> <span class="pre">(x)</span></code><a class="headerlink" href="#math-type-x" title="Permalink to this headline">#</a></h4>
<p>Returns “<code class="docutils literal notranslate"><span class="pre">integer</span></code>” if <code class="docutils literal notranslate"><span class="pre">x</span></code> is an integer, “<code class="docutils literal notranslate"><span class="pre">float</span></code>” if it is a floating point, and “<code class="docutils literal notranslate"><span class="pre">float</span></code>” if <code class="docutils literal notranslate"><span class="pre">x</span></code> is not a number <strong>nil</strong>。</p>
</section>
<hr class="docutils"/>
<section id="math-ult-m-n">
<h4><code class="docutils literal notranslate"><span class="pre">math.ult</span> <span class="pre">(m,</span> <span class="pre">n)</span></code><a class="headerlink" href="#math-ult-m-n" title="Permalink to this headline">#</a></h4>
<p>If the integers <code class="docutils literal notranslate"><span class="pre">m</span></code> and <code class="docutils literal notranslate"><span class="pre">n</span></code> are compared as unsigned integers, and <code class="docutils literal notranslate"><span class="pre">m</span></code> is below <code class="docutils literal notranslate"><span class="pre">n</span></code>, return Boolean true; otherwise return false.</p>
</section>
</section>
<section id="input-and-output-library">
<h3>6.8 – input and output library<a class="headerlink" href="#input-and-output-library" title="Permalink to this headline">#</a></h3>
<p>I/O The library provides two different styles of file handling interfaces. The first style uses implicit file handles; it provides operations to set default input files and default output files, and all input and output operations are against these default files. The second style uses explicit file handles.</p>
<p>When implicit file handles are used, all operations are provided by the table <code class="docutils literal notranslate"><span class="pre">io.</span> <span class="pre">If</span> <span class="pre">an</span> <span class="pre">explicit</span> <span class="pre">file</span> <span class="pre">handle</span> <span class="pre">is</span> <span class="pre">used,</span> <span class="pre">[</span></code>io.open<code class="docutils literal notranslate"><span class="pre">](#pdf-io.open)</span> <span class="pre">returns</span> <span class="pre">a</span> <span class="pre">file</span> <span class="pre">handle,</span> <span class="pre">and</span> <span class="pre">all</span> <span class="pre">operations</span> <span class="pre">are</span> <span class="pre">provided</span> <span class="pre">by</span> <span class="pre">the</span> <span class="pre">file</span> <span class="pre">handle</span></code>s methods.</p>
<p>The table <code class="docutils literal notranslate"><span class="pre">io</span></code> also provides three predefined file handles with the same meaning as in C: <code class="docutils literal notranslate"><span class="pre">io.stdin</span></code>, <code class="docutils literal notranslate"><span class="pre">io.stdout</span></code>, and <code class="docutils literal notranslate"><span class="pre">io.stderr</span> </code>. The I/O library never closes these files.</p>
<p>Unless otherwise noted, I/O functions return <strong>nil</strong> when an error occurs (the second return value is the error message, and the third return value is the system-related error code). A value different from <strong>nil</strong> is returned on success. On non-POSIX systems, the process of fetching error messages based on error codes may not be thread-safe because it uses C’s global variables <code class="docutils literal notranslate"><span class="pre">errno</span></code> 。</p>
<hr class="docutils"/>
<section id="io-close-file">
<h4><code class="docutils literal notranslate"><span class="pre">io.close</span> <span class="pre">([file])</span></code><a class="headerlink" href="#io-close-file" title="Permalink to this headline">#</a></h4>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">file:close()</span></code>. The default output file is closed when <code class="docutils literal notranslate"><span class="pre">file</span></code> is not given.</p>
</section>
<hr class="docutils"/>
<section id="io-flush">
<h4><code class="docutils literal notranslate"><span class="pre">io.flush</span> <span class="pre">()</span></code><a class="headerlink" href="#io-flush" title="Permalink to this headline">#</a></h4>
<p>equivalent <code class="docutils literal notranslate"><span class="pre">io.output():flush()</span></code>。</p>
</section>
<hr class="docutils"/>
<section id="io-input-file">
<h4><code class="docutils literal notranslate"><span class="pre">io.input</span> <span class="pre">([file])</span></code><a class="headerlink" href="#io-input-file" title="Permalink to this headline">#</a></h4>
<p>When it is called with a file name, it opens the file of that name (in text mode) and sets the file handle as the default input file. If you call it with a file handle, simply set the handle to the default input file. If called without passing parameters, it returns the current default input file.</p>
<p>In the case of an error, the function throws an error instead of returning an error code.</p>
</section>
<hr class="docutils"/>
<section id="io-lines-filename">
<h4><code class="docutils literal notranslate"><span class="pre">io.lines</span> <span class="pre">([filename</span> <span class="pre">···])</span></code><a class="headerlink" href="#io-lines-filename" title="Permalink to this headline">#</a></h4>
<p>Opens the specified file name in read mode and returns an iterated function. This iterator function works in the same way as the iterator obtained by calling <code class="docutils literal notranslate"><span class="pre">file:lines</span> <span class="pre">(...)</span> </code>with an open file. When the iterator function detects the end of the file, it returns no value (let the loop end) and automatically closes the file.</p>
<p>Calling <code class="docutils literal notranslate"><span class="pre">io.lines()</span></code>(without passing a file name) is equivalent to <code class="docutils literal notranslate"><span class="pre">io.input():lines("*</span> <span class="pre">l")</span></code>; that is, it will iterate the standard input file by line. In this case, it does not close the file after the loop ends.</p>
<p>In the case of an error, the function throws an error instead of returning an error code.</p>
</section>
<hr class="docutils"/>
<section id="io-open-filename-mode">
<h4><code class="docutils literal notranslate"><span class="pre">io.open</span> <span class="pre">(filename</span> <span class="pre">[,</span> <span class="pre">mode])</span></code><a class="headerlink" href="#io-open-filename-mode" title="Permalink to this headline">#</a></h4>
<p>This function opens a file in the mode specified by the string `mode. Returns the new file handle. When an error occurs, returns <strong>nil</strong> plus an error message.</p>
<p><code class="docutils literal notranslate"><span class="pre">mode</span></code> The string can be any of the following values：</p>
<ul class="simple">
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">r</span></code>”:</strong> Read Mode (Default）；</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">w</span></code>”:</strong> Write Mode；</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">a</span></code>”:</strong> Append mode；</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">r+</span></code>”:</strong> Update mode, all previous data is retained；</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">w+</span></code>”:</strong> Update mode, all previous data is deleted；</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">a+</span></code>”:</strong> In the append update mode, all previous data is retained and only writes are allowed at the end of the file.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">mode</span></code> The string can be appended with a <code class="docutils literal notranslate"><span class="pre">B</span></code> at the end, which opens the file in binary on some systems.</p>
</section>
<hr class="docutils"/>
<section id="io-output-file">
<h4><code class="docutils literal notranslate"><span class="pre">io.output</span> <span class="pre">([file])</span></code><a class="headerlink" href="#io-output-file" title="Permalink to this headline">#</a></h4>
<p>Similar to <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">io.input</span></code></span>. However, both operate on the default output file.</p>
</section>
<hr class="docutils"/>
<section id="io-popen-prog-mode">
<h4><code class="docutils literal notranslate"><span class="pre">io.popen</span> <span class="pre">(prog</span> <span class="pre">[,</span> <span class="pre">mode])</span></code><a class="headerlink" href="#io-popen-prog-mode" title="Permalink to this headline">#</a></h4>
<p>This function is related to the system and is not available on all platforms.</p>
<p>Start the program <code class="docutils literal notranslate"><span class="pre">prog</span></code> with a separate process, and the returned file handle can be used to read data from the program (if <code class="docutils literal notranslate"><span class="pre">mode</span></code> is <code class="docutils literal notranslate"><span class="pre">"r"</span></code>, which is the default) or write input to the program (when <code class="docutils literal notranslate"><span class="pre">mode</span></code> is <code class="docutils literal notranslate"><span class="pre">"w"</span></code>）。</p>
</section>
<hr class="docutils"/>
<section id="io-read">
<h4><code class="docutils literal notranslate"><span class="pre">io.read</span> <span class="pre">(···)</span></code><a class="headerlink" href="#io-read" title="Permalink to this headline">#</a></h4>
<p>equivalent <code class="docutils literal notranslate"><span class="pre">io.input():read(···)</span></code>。</p>
</section>
<hr class="docutils"/>
<section id="io-tmpfile">
<h4><code class="docutils literal notranslate"><span class="pre">io.tmpfile</span> <span class="pre">()</span></code><a class="headerlink" href="#io-tmpfile" title="Permalink to this headline">#</a></h4>
<p>If successful, returns a handle to the temporary file. This file is opened in update mode and is automatically deleted at the end of the program.</p>
</section>
<hr class="docutils"/>
<section id="io-type-obj">
<h4><code class="docutils literal notranslate"><span class="pre">io.type</span> <span class="pre">(obj)</span></code><a class="headerlink" href="#io-type-obj" title="Permalink to this headline">#</a></h4>
<p>Check if <code class="docutils literal notranslate"><span class="pre">obj</span></code> is a valid file handle. If <code class="docutils literal notranslate"><span class="pre">obj</span></code> it is an open file handle, return the string <code class="docutils literal notranslate"><span class="pre">"file"</span></code>. If <code class="docutils literal notranslate"><span class="pre">obj</span></code> is a closed file handle, return the string <code class="docutils literal notranslate"><span class="pre">"closed</span> <span class="pre">file"</span></code>. If <code class="docutils literal notranslate"><span class="pre">obj</span></code> is not a file handle, return <strong>nil</strong> 。</p>
</section>
<hr class="docutils"/>
<section id="io-write">
<h4><code class="docutils literal notranslate"><span class="pre">io.write</span> <span class="pre">(···)</span></code><a class="headerlink" href="#io-write" title="Permalink to this headline">#</a></h4>
<p>equivalent <code class="docutils literal notranslate"><span class="pre">io.output():write(···)</span></code>。</p>
</section>
<hr class="docutils"/>
<section id="file-close">
<h4><code class="docutils literal notranslate"><span class="pre">file:close</span> <span class="pre">()</span></code><a class="headerlink" href="#file-close" title="Permalink to this headline">#</a></h4>
<p>Close <code class="docutils literal notranslate"><span class="pre">file</span> </code>. Note that the file is automatically closed when the handle is garbage collected, but how long after that happens is unpredictable.</p>
<p>When closing a file handle created with <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">io.</span> <span class="pre">pop</span></code></span>, <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">file:close</span></code></span> returns the same value that <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">OS.</span> <span class="pre">execute</span></code></span> would return.</p>
</section>
<hr class="docutils"/>
<section id="file-flush">
<h4><code class="docutils literal notranslate"><span class="pre">file:flush</span> <span class="pre">()</span></code><a class="headerlink" href="#file-flush" title="Permalink to this headline">#</a></h4>
<p>Save the written data to `file.</p>
</section>
<hr class="docutils"/>
<section id="file-lines">
<h4><code class="docutils literal notranslate"><span class="pre">file:lines</span> <span class="pre">(···)</span></code><a class="headerlink" href="#file-lines" title="Permalink to this headline">#</a></h4>
<p>Returns an iterator function that reads data from a file in the specified format each time the iterator is called. If no format is specified, the default value “<code class="docutils literal notranslate"><span class="pre">l</span></code>” is used `”. look at an example</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> for c in file:lines(1) do _body_ end
</pre></div>
</div>
<p>The characters are continuously read out from the current position in the file. Unlike <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">io.lines</span></code></span>, this function does not close the file after the loop ends.</p>
<p>In the case of an error, the function throws an error instead of returning an error code.</p>
</section>
<hr class="docutils"/>
<section id="file-read">
<h4><code class="docutils literal notranslate"><span class="pre">file:read</span> <span class="pre">(···)</span></code><a class="headerlink" href="#file-read" title="Permalink to this headline">#</a></h4>
<p>Read the file <code class="docutils literal notranslate"><span class="pre">file</span></code>, the specified format determines what to read. For each format, the function returns the string or number corresponding to the read character. <strong>nil</strong> is returned if the data cannot be read in this format. (For this last case, the function does not read the subsequent format.) When called without passing the format, it reads the next line using the default format (see description below.）。</p>
<p>The formats provided are</p>
<ul class="simple">
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">n</span></code>”:</strong> Reads a number, depending on Lua<code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">conversion</span> <span class="pre">grammar,</span> <span class="pre">may</span> <span class="pre">return</span> <span class="pre">a</span> <span class="pre">floating</span> <span class="pre">point</span> <span class="pre">number</span> <span class="pre">or</span> <span class="pre">an</span> <span class="pre">integer.</span> <span class="pre">(Numbers</span> <span class="pre">can</span> <span class="pre">have</span> <span class="pre">leading</span> <span class="pre">or</span> <span class="pre">trailing</span> <span class="pre">spaces,</span> <span class="pre">as</span> <span class="pre">well</span> <span class="pre">as</span> <span class="pre">symbols.)</span> <span class="pre">As</span> <span class="pre">long</span> <span class="pre">as</span> <span class="pre">it</span> <span class="pre">can</span> <span class="pre">form</span> <span class="pre">a</span> <span class="pre">legal</span> <span class="pre">number,</span> <span class="pre">this</span> <span class="pre">format</span> <span class="pre">always</span> <span class="pre">reads</span> <span class="pre">as</span> <span class="pre">long</span> <span class="pre">as</span> <span class="pre">possible.</span> <span class="pre">If</span> <span class="pre">the</span> <span class="pre">read</span> <span class="pre">prefix</span> <span class="pre">cannot</span> <span class="pre">form</span> <span class="pre">a</span> <span class="pre">legal</span> <span class="pre">number</span> <span class="pre">(such</span> <span class="pre">as</span> <span class="pre">an</span> <span class="pre">empty</span> <span class="pre">string,</span> <span class="pre">"</span></code>0x<code class="docutils literal notranslate"><span class="pre">"</span> <span class="pre">or</span> <span class="pre">"</span></code> 3.4e-`”), the function will be aborted and returned <strong>nil</strong>。</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">a</span></code>”:</strong> Reads the entire file from the current location. Returns an empty string if it is already at the end of the file.</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">l</span></code>”:</strong> Reads a row and ignores the end-of-line tag. When at the end of the file, returns <strong>nil</strong> which is the default format.</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">L</span></code>”:</strong> Reads a line and retains the end-of-line tag (if any), when at the end of the file, returns <strong>nil</strong>。</p></li>
<li><p><strong><em>number</em>:</strong> Reads a string that does not exceed this number of bytes. When at the end of the file, returns **nil * *. If <code class="docutils literal notranslate"><span class="pre">number</span></code> is zero, it reads nothing and returns an empty string. When at the end of the file, returns <strong>nil</strong>。</p></li>
</ul>
<p>Formats “<code class="docutils literal notranslate"><span class="pre">l</span></code>” and “<code class="docutils literal notranslate"><span class="pre">L</span></code>” can only be used in text files.</p>
</section>
<hr class="docutils"/>
<section id="file-seek-whence-offset">
<h4><code class="docutils literal notranslate"><span class="pre">file:seek</span> <span class="pre">([whence</span> <span class="pre">[,</span> <span class="pre">offset]])</span></code><a class="headerlink" href="#file-seek-whence-offset" title="Permalink to this headline">#</a></h4>
<p>Sets and gets the position calculated based on the beginning of the file. The location of the setting is determined by the base point specified by the <code class="docutils literal notranslate"><span class="pre">offset</span></code> and <code class="docutils literal notranslate"><span class="pre">whence</span></code> strings `whence. The base point can be：</p>
<ul class="simple">
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">set</span></code>”:</strong> Base point is 0 (beginning of document）；</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">cur</span></code>”:</strong> Base point is current position；</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">end</span></code>”:</strong> Base point is end of document；</p></li>
</ul>
<p>When <code class="docutils literal notranslate"><span class="pre">seek</span></code> succeeds, returns the position of the file finally calculated from the beginning of the file. When <code class="docutils literal notranslate"><span class="pre">seek</span></code> fails, return <strong>nil</strong> plus an error description string.</p>
<p><code class="docutils literal notranslate"><span class="pre">whence</span></code> The default value of is <code class="docutils literal notranslate"><span class="pre">"cur"</span></code> and <code class="docutils literal notranslate"><span class="pre">offset</span></code> defaults to 0. Therefore, calling <code class="docutils literal notranslate"><span class="pre">file:seek()</span></code>returns the current location of the file without changing it; calling <code class="docutils literal notranslate"><span class="pre">file:seek("set")</span></code> sets the location to the beginning of the file (and returns 0); calling `file:seek(“end”) sets the location to the end of the file and returns the file size.</p>
</section>
<hr class="docutils"/>
<section id="file-setvbuf-mode-size">
<h4><code class="docutils literal notranslate"><span class="pre">file:setvbuf</span> <span class="pre">(mode</span> <span class="pre">[,</span> <span class="pre">size])</span></code><a class="headerlink" href="#file-setvbuf-mode-size" title="Permalink to this headline">#</a></h4>
<p>Sets the buffer mode for the output file. There are three modes：</p>
<ul class="simple">
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">no</span></code>”:</strong> Not buffered; the output operation takes effect immediately.</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">full</span></code>”:</strong> Full buffering; output is only really done when the cache is full or when you explicitly call <code class="docutils literal notranslate"><span class="pre">flush</span></code> on the file (see <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">io.flush</span></code></span>).</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">line</span></code>”:</strong> Line buffering; output will be buffered before each newline, and for some special files (such as terminal devices) before any input.</p></li>
</ul>
<p>For the latter two cases, <code class="docutils literal notranslate"><span class="pre">size</span></code> specifies the buffer size in bytes. There will be an appropriate size by default.</p>
</section>
<hr class="docutils"/>
<section id="file-write">
<h4><code class="docutils literal notranslate"><span class="pre">file:write</span> <span class="pre">(···)</span></code><a class="headerlink" href="#file-write" title="Permalink to this headline">#</a></h4>
<p>Write the values of the parameters to <code class="docutils literal notranslate"><span class="pre">file</span></code> one by one `. Argument must be a string or a number.</p>
<p>On success, the function returns <code class="docutils literal notranslate"><span class="pre">file</span> </code>. Otherwise, <strong>nil</strong> plus the error description string is returned.</p>
</section>
</section>
<section id="operating-system-library">
<h3>6.9 – Operating System Library<a class="headerlink" href="#operating-system-library" title="Permalink to this headline">#</a></h3>
<p>This library is implemented through the table `OS.</p>
<hr class="docutils"/>
<section id="os-clock">
<h4><code class="docutils literal notranslate"><span class="pre">os.clock</span> <span class="pre">()</span></code><a class="headerlink" href="#os-clock" title="Permalink to this headline">#</a></h4>
<p>Returns an approximation of the CPU time in seconds used by the program.</p>
</section>
<hr class="docutils"/>
<section id="os-date-format-time">
<h4><code class="docutils literal notranslate"><span class="pre">os.date</span> <span class="pre">([format</span> <span class="pre">[,</span> <span class="pre">time]])</span></code><a class="headerlink" href="#os-date-format-time" title="Permalink to this headline">#</a></h4>
<p>Returns a string or table containing the date and time of day. The formatting method depends on the given string <code class="docutils literal notranslate"><span class="pre">format</span></code>。</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">time</span></code> parameter is provided, the time is formatted (see the <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">OS.</span> <span class="pre">time</span></code></span> function for the meaning of this value). Otherwise, <code class="docutils literal notranslate"><span class="pre">date</span></code> formats the current time.</p>
<p>If ‘format’ ‘’! ‘’At the beginning, the date is formatted in Coordinated Universal Time. After this optional character item, if’ format’ is the string “’* t’”, ‘date’ returns a table with subsequent fields: ‘year’ (four digits), ‘month’ (1-12),’ day’ (1-31), ‘hour’ (0-23),’ min’ (0-59), ‘sec’ (0-61),’ wday’ (day of the week, Sunday of the year), and ‘isdst’ (daylight saving time marker, a boolean). For the last field, it does not exist if the information is not provided.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">format</span></code> is not “<code class="docutils literal notranslate"><span class="pre">*</span> <span class="pre">t</span></code>”, <code class="docutils literal notranslate"><span class="pre">date</span></code> is returned as a string, and the formatting method follows the rules of the ISO C function `strftime.</p>
<p>If called without parameters, <code class="docutils literal notranslate"><span class="pre">date</span></code> returns a reasonable date-time string in a format that depends on the host program and the current locale (I. e., <code class="docutils literal notranslate"><span class="pre">OS.</span> <span class="pre">date()</span></code> is equivalent <code class="docutils literal notranslate"><span class="pre">os.date("%c")</span></code>）。</p>
<p>On non-POSIX systems, this function may not be thread-safe because it relies on the C functions <code class="docutils literal notranslate"><span class="pre">gmtime</span></code> and `localtime.</p>
</section>
<hr class="docutils"/>
<section id="os-difftime-t2-t1">
<h4><code class="docutils literal notranslate"><span class="pre">os.difftime</span> <span class="pre">(t2,</span> <span class="pre">t1)</span></code><a class="headerlink" href="#os-difftime-t2-t1" title="Permalink to this headline">#</a></h4>
<p>Returns the difference in seconds from time <code class="docutils literal notranslate"><span class="pre">t1</span></code> to <code class="docutils literal notranslate"><span class="pre">t2.</span> <span class="pre">(Here</span> <span class="pre">the</span> <span class="pre">time</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">value</span> <span class="pre">returned</span> <span class="pre">by</span> <span class="pre">[</span></code>OS. time<code class="docutils literal notranslate"><span class="pre">](#pdf-os.time)).</span> <span class="pre">On</span> <span class="pre">POSIX,Windows,</span> <span class="pre">and</span> <span class="pre">some</span> <span class="pre">other</span> <span class="pre">systems,</span> <span class="pre">this</span> <span class="pre">value</span> <span class="pre">is</span> <span class="pre">equal</span> </code>t2<code class="docutils literal notranslate"><span class="pre">_\-_</span></code>t1`。</p>
</section>
<hr class="docutils"/>
<section id="os-execute-command">
<h4><code class="docutils literal notranslate"><span class="pre">os.execute</span> <span class="pre">([command])</span></code><a class="headerlink" href="#os-execute-command" title="Permalink to this headline">#</a></h4>
<p>This function is equivalent to the ISO C function <code class="docutils literal notranslate"><span class="pre">system</span> </code>. It calls the system interpreter to execute <code class="docutils literal notranslate"><span class="pre">command</span> </code>. If the command runs successfully, the first return value is <strong>true</strong>, otherwise it is **nil * *. After the first return value, the function returns a string plus a number. as follows：</p>
<ul class="simple">
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">exit</span></code>”:</strong> The command ends normally; the next number is the exit status code for the command.</p></li>
<li><p><strong>“<code class="docutils literal notranslate"><span class="pre">signal</span></code>”:</strong> The command is interrupted by a signal; the next number is the signal that interrupts the command.</p></li>
</ul>
<p>If called without arguments, <code class="docutils literal notranslate"><span class="pre">OS</span> <span class="pre">.exe</span> <span class="pre">cute</span></code> returns true if the system interpreter exists.</p>
</section>
<hr class="docutils"/>
<section id="os-exit-code-close">
<h4><code class="docutils literal notranslate"><span class="pre">os.exit</span> <span class="pre">([code</span> <span class="pre">[,</span> <span class="pre">close]])</span></code><a class="headerlink" href="#os-exit-code-close" title="Permalink to this headline">#</a></h4>
<p>Call the ISO C function <code class="docutils literal notranslate"><span class="pre">exit</span></code> to terminate the host program. If <code class="docutils literal notranslate"><span class="pre">code</span></code> is <strong>true</strong>, the returned status code is EXIT_SUCCESS. If <code class="docutils literal notranslate"><span class="pre">code</span></code> is <strong>false</strong>, the returned status code is EXIT_FAILURE. If <code class="docutils literal notranslate"><span class="pre">code</span></code> is a number, the returned status code is the number. The default value for <code class="docutils literal notranslate"><span class="pre">code</span></code> is <strong>true</strong>。</p>
<p>If the second optional argument <code class="docutils literal notranslate"><span class="pre">close</span></code> is true, close the Lua state machine before exiting.</p>
</section>
<hr class="docutils"/>
<section id="os-getenv-varname">
<h4><code class="docutils literal notranslate"><span class="pre">os.getenv</span> <span class="pre">(varname)</span></code><a class="headerlink" href="#os-getenv-varname" title="Permalink to this headline">#</a></h4>
<p>Returns the value of the process environment variable <code class="docutils literal notranslate"><span class="pre">varname</span></code>, if the variable is not defined <strong>nil</strong> 。</p>
</section>
<hr class="docutils"/>
<section id="os-remove-filename">
<h4><code class="docutils literal notranslate"><span class="pre">os.remove</span> <span class="pre">(filename)</span></code><a class="headerlink" href="#os-remove-filename" title="Permalink to this headline">#</a></h4>
<p>Delete the file with the specified name (it can be an empty directory on POSIX systems). If the function fails, return <strong>nil</strong> plus an error description string and error code.</p>
</section>
<hr class="docutils"/>
<section id="os-rename-oldname-newname">
<h4><code class="docutils literal notranslate"><span class="pre">os.rename</span> <span class="pre">(oldname,</span> <span class="pre">newname)</span></code><a class="headerlink" href="#os-rename-oldname-newname" title="Permalink to this headline">#</a></h4>
<p>Renames the file or directory named <code class="docutils literal notranslate"><span class="pre">oldname</span></code> to <code class="docutils literal notranslate"><span class="pre">newname</span> </code>. If the function fails, return <strong>nil</strong> plus an error description string and error code.</p>
</section>
<hr class="docutils"/>
<section id="os-setlocale-locale-category">
<h4><code class="docutils literal notranslate"><span class="pre">os.setlocale</span> <span class="pre">(locale</span> <span class="pre">[,</span> <span class="pre">category])</span></code><a class="headerlink" href="#os-setlocale-locale-category" title="Permalink to this headline">#</a></h4>
<p>Sets the current region of the program. <code class="docutils literal notranslate"><span class="pre">locale</span></code> is a locale-dependent system string; <code class="docutils literal notranslate"><span class="pre">category</span></code> is an optional string that describes which classification has changed: <code class="docutils literal notranslate"><span class="pre">"all"</span></code>, <code class="docutils literal notranslate"><span class="pre">"collate"</span></code>, <code class="docutils literal notranslate"><span class="pre">"ctype"</span></code>, <code class="docutils literal notranslate"><span class="pre">"monetary"</span></code>, <code class="docutils literal notranslate"><span class="pre">"numeric"</span></code>, or <code class="docutils literal notranslate"><span class="pre">"time"</span></code>; the default classification is <code class="docutils literal notranslate"><span class="pre">"all"</span></code>. This function returns the name of the new region. If the request is not granted, return <strong>nil</strong> 。</p>
<p>When <code class="docutils literal notranslate"><span class="pre">locale</span></code> is an empty string, the current region is set to a local region defined in the implementation. When <code class="docutils literal notranslate"><span class="pre">locale</span></code> is the string “<code class="docutils literal notranslate"><span class="pre">C</span></code>”, the current area is set to the standard C area.</p>
<p>When the first parameter is <strong>nil</strong>, this function returns only the name of the specified category in the current region.</p>
<p>Since this function relies on the C function <code class="docutils literal notranslate"><span class="pre">setlocale</span></code>, it may not be thread-safe.</p>
</section>
<hr class="docutils"/>
<section id="os-time-table">
<h4><code class="docutils literal notranslate"><span class="pre">os.time</span> <span class="pre">([table])</span></code><a class="headerlink" href="#os-time-table" title="Permalink to this headline">#</a></h4>
<p>When the parameter is not passed, the current time is returned. If a table is passed in, the time represented by this table is returned. The table must contain the fields <code class="docutils literal notranslate"><span class="pre">year</span></code>,<code class="docutils literal notranslate"><span class="pre">month</span></code>, and <code class="docutils literal notranslate"><span class="pre">day</span></code>; it can contain <code class="docutils literal notranslate"><span class="pre">hour</span></code> (default 12 ), <code class="docutils literal notranslate"><span class="pre">min</span></code> (default 0), <code class="docutils literal notranslate"><span class="pre">sec</span></code> (default 0), and <code class="docutils literal notranslate"><span class="pre">isdst</span></code> (default <strong>nil</strong>). For a detailed description of these fields, see the <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">OS.</span> <span class="pre">date</span></code></span> function.</p>
<p>The return value is a number whose meaning is determined by your system. In POSIX,Windows, and some other systems, this number counts the number of seconds that have elapsed since a specified time (“epoch”). For other systems, the meaning is undefined, and you can only use the return number of <code class="docutils literal notranslate"><span class="pre">time</span></code> for the parameters of <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">OS.</span> <span class="pre">date</span></code></span> and <span class="xref myst"><code class="docutils literal notranslate"> <span class="pre">OS.</span> <span class="pre">difftime</span></code></span>.</p>
</section>
<hr class="docutils"/>
<section id="os-tmpname">
<h4><code class="docutils literal notranslate"><span class="pre">os.tmpname</span> <span class="pre">()</span></code><a class="headerlink" href="#os-tmpname" title="Permalink to this headline">#</a></h4>
<p>Returns a filename string that can be used for a temporary file. This file must be explicitly opened before use and explicitly deleted when no longer in use.</p>
<p>On POSIX systems, this function creates a file with this file name to avoid security risks. (Someone else may have created this file without permission at the time between getting the file name and creating the file.) You still need to open it first and delete it at last (even if you don’t use it）。</p>
<p>Only possibly, you should use <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">io.tmpfile</span></code></span> because the file can be automatically deleted at the end of the program.</p>
</section>
</section>
<section id="debug-library">
<h3>6.10 – Debug Library<a class="headerlink" href="#debug-library" title="Permalink to this headline">#</a></h3>
<p>This library provides the functionality of the Lua program debugging interface (<span class="xref myst">§ 4.9</span>). Some of these functions violate the basic assumptions of Lua code (for example, local variables of functions are not accessed from outside the function; meta tables of user data are not modified by Lua code; Lua programs do not crash), so they may compromise the security of other code. In addition, some functions in the library may run very slowly.</p>
<p>All functions in this library are provided in the table `debug. For all functions that operate on threads, the optional first parameter is for the thread. The default value is always the current thread.</p>
<hr class="docutils"/>
<section id="debug-debug">
<h4><code class="docutils literal notranslate"><span class="pre">debug.debug</span> <span class="pre">()</span></code><a class="headerlink" href="#debug-debug" title="Permalink to this headline">#</a></h4>
<p>Enter a user interaction mode and run each string entered by the user. Using simple commands and other debugging settings, users can review global and local variables, change the value of variables, evaluate some expressions, and so on. Entering a line containing only <code class="docutils literal notranslate"><span class="pre">cont</span></code> will end the function so that the caller can continue to run down.</p>
<p>Note that the command entered by <code class="docutils literal notranslate"><span class="pre">debug.debug</span></code> is not embedded in any function in the grammar, so it cannot directly access local variables.</p>
</section>
<hr class="docutils"/>
<section id="debug-gethook-thread">
<h4><code class="docutils literal notranslate"><span class="pre">debug.gethook</span> <span class="pre">([thread])</span></code><a class="headerlink" href="#debug-gethook-thread" title="Permalink to this headline">#</a></h4>
<p>Returns three values representing thread hook settings: the current hook function, the current hook mask, and those set by the current hook count (<span class="xref myst"><code class="docutils literal notranslate"><span class="pre">debug.sethook</span></code></span>）。</p>
</section>
<hr class="docutils"/>
<section id="debug-getinfo-thread-f-what">
<h4><code class="docutils literal notranslate"><span class="pre">debug.getinfo</span> <span class="pre">([thread,]</span> <span class="pre">f</span> <span class="pre">[,</span> <span class="pre">what])</span></code><a class="headerlink" href="#debug-getinfo-thread-f-what" title="Permalink to this headline">#</a></h4>
<p>Returns a table of information about a function. You can provide the function directly, or you can use a number <code class="docutils literal notranslate"><span class="pre">f</span></code> to represent the function. The number <code class="docutils literal notranslate"><span class="pre">f</span></code> represents the function that runs on the corresponding level of the call stack of the specified thread: level 0 represents the current function (<code class="docutils literal notranslate"><span class="pre">getinfo</span></code> itself); level 1 represents the function that calls <code class="docutils literal notranslate"><span class="pre">getinfo</span></code> (unless it is a tail call, which is not included in the stack); and so on. If <code class="docutils literal notranslate"><span class="pre">f</span></code> is a number larger than the number of active functions, <code class="docutils literal notranslate"><span class="pre">getinfo</span></code> returns <strong>nil</strong>。</p>
<p>Only if the string ‘what’ has a description of which items to populate, the returned table can contain all the items that <span class="xref myst">lua_getinfo</span> can return. By default, ‘what’ returns all the information provided except the table of legal row numbers. For option ‘’f’’, the ‘func’ field is added to save the function itself, if possible. For option ‘’L’’, the ‘activelines’ field is added to hold the table of legal line numbers, if possible.</p>
<p>For example, the expression <code class="docutils literal notranslate"><span class="pre">debug.getinfo(1,"n")</span></code>returns a table with information about the current function name (if the name can be found), and the expression <code class="docutils literal notranslate"><span class="pre">debug.getinfo(print)</span></code> returns a table with information about the <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">print</span></code></span> function.</p>
</section>
<hr class="docutils"/>
<section id="debug-getlocal-thread-f-local">
<h4><code class="docutils literal notranslate"><span class="pre">debug.getlocal</span> <span class="pre">([thread,]</span> <span class="pre">f,</span> <span class="pre">local)</span></code><a class="headerlink" href="#debug-getlocal-thread-f-local" title="Permalink to this headline">#</a></h4>
<p>This function returns the name and value of the function<code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">local</span> <span class="pre">variable</span> <span class="pre">with</span> <span class="pre">index</span> </code>local<code class="docutils literal notranslate"><span class="pre">at</span> <span class="pre">the</span></code>f` level of the stack. This function is not only used to access explicitly defined local variables, but also includes formal parameters, temporary variables, etc.</p>
<p>The index of the first parameter or the first local variable defined is 1, and then follows the order defined in the code, and so on. where only the active variables of the current scope of the function are evaluated. Negative index refers to the variable parameter; -1 refers to the first variable parameter. If there is no variable at that index, the function returns **nil * *. If the specified level is out of bounds, an error is thrown. (You can call <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">debug.getinfo</span></code></span> to check if the hierarchy is legal。）</p>
<p>Variable names beginning with ‘’’’ ((open brackets) represent variables without names (e. g. control variables used in loop control, or code blocks with debugging information removed)）。</p>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">f</span></code> can also be a function. In this case, <code class="docutils literal notranslate"><span class="pre">getlocal</span></code> returns only the name of the function parameter.</p>
</section>
<hr class="docutils"/>
<section id="debug-getmetatable-value">
<h4><code class="docutils literal notranslate"><span class="pre">debug.getmetatable</span> <span class="pre">(value)</span></code><a class="headerlink" href="#debug-getmetatable-value" title="Permalink to this headline">#</a></h4>
<p>Returns the meta table for the given `value. Returns if it does not have a meta table <strong>nil</strong> 。</p>
</section>
<hr class="docutils"/>
<section id="debug-getregistry">
<h4><code class="docutils literal notranslate"><span class="pre">debug.getregistry</span> <span class="pre">()</span></code><a class="headerlink" href="#debug-getregistry" title="Permalink to this headline">#</a></h4>
<p>return to the registry (see <span class="xref myst">§4.5</span>）。</p>
</section>
<hr class="docutils"/>
<section id="debug-getupvalue-f-up">
<h4><code class="docutils literal notranslate"><span class="pre">debug.getupvalue</span> <span class="pre">(f,</span> <span class="pre">up)</span></code><a class="headerlink" href="#debug-getupvalue-f-up" title="Permalink to this headline">#</a></h4>
<p>This function returns the name and value of the <code class="docutils literal notranslate"><span class="pre">up</span></code> top value of function `f. If the function does not have that upper value, return <strong>nil</strong> 。</p>
<p>Variable names beginning with ‘’’’ ((open brackets) represent variables without names (code blocks with debug information removed)）。</p>
</section>
<hr class="docutils"/>
<section id="debug-getuservalue-u">
<h4><code class="docutils literal notranslate"><span class="pre">debug.getuservalue</span> <span class="pre">(u)</span></code><a class="headerlink" href="#debug-getuservalue-u" title="Permalink to this headline">#</a></h4>
<p>Returns the Lua value associated on <code class="docutils literal notranslate"><span class="pre">u.</span> <span class="pre">If</span> </code>u` is not user data, return <strong>nil</strong>。</p>
</section>
<hr class="docutils"/>
<section id="debug-sethook-thread-hook-mask-count">
<h4><code class="docutils literal notranslate"><span class="pre">debug.sethook</span> <span class="pre">([thread,]</span> <span class="pre">hook,</span> <span class="pre">mask</span> <span class="pre">[,</span> <span class="pre">count])</span></code><a class="headerlink" href="#debug-sethook-thread-hook-mask-count" title="Permalink to this headline">#</a></h4>
<p>Set a function as a hook function. The string <code class="docutils literal notranslate"><span class="pre">mask</span></code> and the number <code class="docutils literal notranslate"><span class="pre">count</span></code> determine when the hook will be called. A mask is a string of the following characters, each of which has a meaning：</p>
<ul class="simple">
<li><p><strong>‘<code class="docutils literal notranslate"><span class="pre">c</span></code>’:</strong> Whenever Lua calls a function, the hook is called；</p></li>
<li><p><strong>‘<code class="docutils literal notranslate"><span class="pre">r</span></code>’:</strong> Whenever Lua returns from within a function, the hook is called；</p></li>
<li><p><strong>‘<code class="docutils literal notranslate"><span class="pre">l</span></code>’:</strong> Whenever Lua enters a new line, the hook is called.</p></li>
</ul>
<p>In addition, a non-zero <code class="docutils literal notranslate"><span class="pre">count</span></code> is passed in, and the hook will be called every time the <code class="docutils literal notranslate"><span class="pre">count</span></code> instruction is run.</p>
<p>If no parameters are passed in, <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">debug.sethook</span></code></span> closes the hook.</p>
<p>When the hook is called, the first parameter is the event that triggered the call: <code class="docutils literal notranslate"><span class="pre">"call"</span></code> (or <code class="docutils literal notranslate"><span class="pre">"tail</span> <span class="pre">call"</span></code>), <code class="docutils literal notranslate"><span class="pre">"return"</span></code>, <code class="docutils literal notranslate"><span class="pre">"line"</span></code>, <code class="docutils literal notranslate"><span class="pre">"count"</span></code>. For row events, the second argument to the hook is the new row number. Within the hook, you can call<code class="docutils literal notranslate"> <span class="pre">getinfo</span></code> and specify layer 2 to get the details of the running function (layer 0 refers to<code class="docutils literal notranslate"> <span class="pre">getinfo</span></code> function and layer 1 refers to hook function）。</p>
</section>
<hr class="docutils"/>
<section id="debug-setlocal-thread-level-local-value">
<h4><code class="docutils literal notranslate"><span class="pre">debug.setlocal</span> <span class="pre">([thread,]</span> <span class="pre">level,</span> <span class="pre">local,</span> <span class="pre">value)</span></code><a class="headerlink" href="#debug-setlocal-thread-level-local-value" title="Permalink to this headline">#</a></h4>
<p>This function assigns <code class="docutils literal notranslate"><span class="pre">value</span></code> to the <code class="docutils literal notranslate"><span class="pre">local</span></code> local variable of the <code class="docutils literal notranslate"><span class="pre">level</span></code> level function on the stack. If there is no such variable, the function returns **nil * *. If <code class="docutils literal notranslate"><span class="pre">level</span></code> is out of bounds, an error is thrown. (You can call <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">debug.getinfo</span></code></span> to check if the hierarchy is legal.) Otherwise, it returns the name of the local variable.</p>
<p>For variable indexes and names, see <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">debug.getlocal</span></code></span>。</p>
</section>
<hr class="docutils"/>
<section id="debug-setmetatable-value-table">
<h4><code class="docutils literal notranslate"><span class="pre">debug.setmetatable</span> <span class="pre">(value,</span> <span class="pre">table)</span></code><a class="headerlink" href="#debug-setmetatable-value-table" title="Permalink to this headline">#</a></h4>
<p>Set the meta table for <code class="docutils literal notranslate"><span class="pre">value</span></code> to <code class="docutils literal notranslate"><span class="pre">table</span></code> (can be <strong>nil</strong>). Return <code class="docutils literal notranslate"><span class="pre">value</span></code>。</p>
</section>
<hr class="docutils"/>
<section id="debug-setupvalue-f-up-value">
<h4><code class="docutils literal notranslate"><span class="pre">debug.setupvalue</span> <span class="pre">(f,</span> <span class="pre">up,</span> <span class="pre">value)</span></code><a class="headerlink" href="#debug-setupvalue-f-up-value" title="Permalink to this headline">#</a></h4>
<p>This function sets <code class="docutils literal notranslate"><span class="pre">value</span></code> to the <code class="docutils literal notranslate"><span class="pre">up</span></code> top value of function `f. If the function does not have that upper value, return <strong>nil</strong> otherwise, return the name of the upper value.</p>
</section>
<hr class="docutils"/>
<section id="debug-setuservalue-udata-value">
<h4><code class="docutils literal notranslate"><span class="pre">debug.setuservalue</span> <span class="pre">(udata,</span> <span class="pre">value)</span></code><a class="headerlink" href="#debug-setuservalue-udata-value" title="Permalink to this headline">#</a></h4>
<p>Set <code class="docutils literal notranslate"><span class="pre">value</span></code> to the associated value of <code class="docutils literal notranslate"><span class="pre">udata.</span> </code>udata` must be a full user data.</p>
<p>Return <code class="docutils literal notranslate"><span class="pre">udata</span></code>。</p>
</section>
<hr class="docutils"/>
<section id="debug-traceback-thread-message-level">
<h4><code class="docutils literal notranslate"><span class="pre">debug.traceback</span> <span class="pre">([thread,]</span> <span class="pre">[message</span> <span class="pre">[,</span> <span class="pre">level]])</span></code><a class="headerlink" href="#debug-traceback-thread-message-level" title="Permalink to this headline">#</a></h4>
<p>If <code class="docutils literal notranslate"><span class="pre">message</span></code> is present and is not a string or <strong>nil</strong>, the function returns <code class="docutils literal notranslate"><span class="pre">message</span></code> without any processing <code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">Otherwise,</span> <span class="pre">it</span> <span class="pre">returns</span> <span class="pre">stack</span> <span class="pre">backtrace</span> <span class="pre">information</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">call</span> <span class="pre">stack.</span> <span class="pre">The</span> <span class="pre">string</span> <span class="pre">option</span> </code>message<code class="docutils literal notranslate"> <span class="pre">is</span> <span class="pre">added</span> <span class="pre">at</span> <span class="pre">the</span> <span class="pre">beginning</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">stack</span> <span class="pre">backtrace</span> <span class="pre">information.</span> <span class="pre">The</span> <span class="pre">number</span> <span class="pre">option</span></code>level<code class="docutils literal notranslate"><span class="pre">indicates</span> <span class="pre">from</span> <span class="pre">which</span> <span class="pre">level</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">stack</span> <span class="pre">to</span> <span class="pre">backtrack</span> <span class="pre">(the</span> <span class="pre">default</span> <span class="pre">is</span> <span class="pre">1,</span> <span class="pre">where</span></code>traceback` is called）。</p>
</section>
<hr class="docutils"/>
<section id="debug-upvalueid-f-n">
<h4><code class="docutils literal notranslate"><span class="pre">debug.upvalueid</span> <span class="pre">(f,</span> <span class="pre">n)</span></code><a class="headerlink" href="#debug-upvalueid-f-n" title="Permalink to this headline">#</a></h4>
<p>Returns the unique identifier of the <code class="docutils literal notranslate"><span class="pre">n</span></code> upper value of the specified function (a lightweight user data）。</p>
<p>This unique identifier allows the program to check whether two different closures share the upper value. If Lua closures share the same up value (that is, point to an external local variable), the same identifier is returned.</p>
</section>
<hr class="docutils"/>
<section id="debug-upvaluejoin-f1-n1-f2-n2">
<h4><code class="docutils literal notranslate"><span class="pre">debug.upvaluejoin</span> <span class="pre">(f1,</span> <span class="pre">n1,</span> <span class="pre">f2,</span> <span class="pre">n2)</span></code><a class="headerlink" href="#debug-upvaluejoin-f1-n1-f2-n2" title="Permalink to this headline">#</a></h4>
<p>Let the <code class="docutils literal notranslate"><span class="pre">n1</span></code> upper value of Lua closure <code class="docutils literal notranslate"><span class="pre">f1</span></code> refer to the <code class="docutils literal notranslate"><span class="pre">n2</span></code> upper value of Lua closure `f2.</p>
</section>
</section>
</section>
<section id="independent-edition-lua">
<h2>7 – Independent Edition Lua<a class="headerlink" href="#independent-edition-lua" title="Permalink to this headline">#</a></h2>
<p>Although Lua is designed to be an extension language for embedding a host program. It is often used as a separate language. The stand-alone version of the Lua language interpreter is released with the standard package and is called <code class="docutils literal notranslate"><span class="pre">lua</span> </code>. The standalone version of the interpreter retains all of the standard and debug libraries. Its command line usage is：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> lua \[options\] \[script \[args\]\]
</pre></div>
</div>
<p>The options are：</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">-e</span> <span class="pre">_stat_</span></code>:</strong> Execute a string <em>stat</em> ；</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">-l</span> <span class="pre">_mod_</span></code>:</strong> “Request Module” <em>mod</em> ；</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">-i</span></code>:</strong> Enter interactive mode after running_script_；</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">-v</span></code>:</strong> Print version information；</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">-E</span></code>:</strong> Ignore environment variables；</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">--</span></code>:</strong> Abort processing of subsequent options；</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">-</span></code>:</strong> Run <code class="docutils literal notranslate"><span class="pre">stdin</span></code> as a file and abort processing of the following options.</p></li>
</ul>
<p>After processing the options, <code class="docutils literal notranslate"><span class="pre">lua</span></code> runs the specified_script_. If called without parameters, <code class="docutils literal notranslate"><span class="pre">lua</span></code> behaves the same as <code class="docutils literal notranslate"><span class="pre">lua</span> <span class="pre">-v-I</span> </code>when the standard input (<code class="docutils literal notranslate"><span class="pre">stdin</span></code>) is a terminal. otherwise equivalent <code class="docutils literal notranslate"><span class="pre">lua</span> <span class="pre">-</span></code> 。</p>
<p>If the call is made without the <code class="docutils literal notranslate"><span class="pre">-E</span></code> option, the interpreter checks the environment variable<code class="docutils literal notranslate"><span class="pre">LUA_INIT_5_3</span></code>(or<code class="docutils literal notranslate"><span class="pre">LUA_INIT</span></code>if the version name is undefined) before running any parameters. If the variable memory format is <code class="docutils literal notranslate"><span class="pre">@_filename_</span></code>, <code class="docutils literal notranslate"><span class="pre">lua</span></code> executes the file. Otherwise, <code class="docutils literal notranslate"><span class="pre">lua</span></code> executes the string.</p>
<p>If there is an option <code class="docutils literal notranslate"><span class="pre">-E</span></code> in the call, Lua ignores the values of<code class="docutils literal notranslate"><span class="pre">LUA_PATH</span></code>and<code class="docutils literal notranslate"><span class="pre">LUA_CPATH</span></code>in addition to ignoring<code class="docutils literal notranslate"> <span class="pre">LUA_INIT.</span> <span class="pre">Set</span> <span class="pre">the</span> <span class="pre">values</span> <span class="pre">of</span> <span class="pre">[</span></code>package.path<code class="docutils literal notranslate"><span class="pre">](#pdf-package.path)</span> <span class="pre">and</span> <span class="pre">[</span></code>package.cpath<code class="docutils literal notranslate"><span class="pre">](#pdf-package.cpath)</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">default</span> <span class="pre">path</span> <span class="pre">defined</span> <span class="pre">in</span> </code>luaconf.h.</p>
<p>All options except <code class="docutils literal notranslate"><span class="pre">-I</span></code> and <code class="docutils literal notranslate"><span class="pre">-E</span></code> are processed in order. For example, this call</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> $ lua -e'a=1' -e 'print(a)' script.lua
</pre></div>
</div>
<p>You will first set <code class="docutils literal notranslate"><span class="pre">a</span></code> to 1, then print the value of <code class="docutils literal notranslate"><span class="pre">a</span></code>, and finally run the file <code class="docutils literal notranslate"><span class="pre">script.lua</span></code> without parameters. (The <code class="docutils literal notranslate"><span class="pre">$</span></code> here is the command line prompt. Your command line prompt may not be the same。）</p>
<p>Before running any code, <code class="docutils literal notranslate"><span class="pre">lua</span></code> will put all the parameters passed in from the command line into a global table, `arg. The name of the script is placed at index 0, the first parameter immediately after the script name is at index 1, and so on. Any parameters that precede the script name (I. e., the name of the interpreter and options) are placed at the negative index. For example, calling</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> $ lua -la b.lua t1 t2
</pre></div>
</div>
<p>This table is like this：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> arg = { \[-2\] = "lua", \[-1\] = "-la",
         \[0\] = "b.lua",
         \[1\] = "t1", \[2\] = "t2" }
</pre></div>
</div>
<p>If the script name is not provided in the call, the interpreter name is placed at index 0, followed by other parameters. For example, calling</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> $ lua -e "print(arg\[1\])"
</pre></div>
</div>
<p>“<code class="docutils literal notranslate"><span class="pre">-e</span></code>” will be printed out<code class="docutils literal notranslate"><span class="pre">".</span> <span class="pre">If</span> <span class="pre">a</span> <span class="pre">script</span> <span class="pre">name</span> <span class="pre">is</span> <span class="pre">provided,</span> <span class="pre">the</span> <span class="pre">script</span> <span class="pre">is</span> <span class="pre">called</span> <span class="pre">with</span></code>arg[1]<code class="docutils literal notranslate"><span class="pre">,...,</span> </code>arg[#arg]` as arguments. (Like all Lua code blocks, the script is compiled into a variable parameter function.。）</p>
<p>In interactive mode, Lua continuously displays the prompt and waits for the next line of input. Once you read a line, first try to interpret the line as an expression. If successfully interpreted, the value of the expression is printed. Otherwise, the line is interpreted as a statement. If you write an unfinished line, the interpreter will use a different prompt to wait for you to finish.</p>
<p>When an unprotected error occurs in a script, the interpreter reports the error to the standard error stream. If the error object is not a string, but there is a meta method <code class="docutils literal notranslate"><span class="pre">__tostring</span></code>, the interpreter will call this meta method to generate the final message. Otherwise, the interpreter converts the error object to a string and prepends the stack backtrace information.</p>
<p>If the run ends normally, the interpreter shuts down the main Lua state machine (see <span class="xref myst">lua_close</span>). The script can be ended by calling <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">OS.</span> <span class="pre">exit</span></code></span> to circumvent this step.</p>
<p>To make Lua a script interpreter for Unix systems. The standalone interpreter ignores the first line of the code block that is headed. Therefore, Lua scripts can be passed through <code class="docutils literal notranslate"><span class="pre">chmod</span> <span class="pre">x</span></code> as well <code class="docutils literal notranslate"><span class="pre">#!</span> </code>Form becomes an executable file. something like this</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> #!/usr/local/bin/lua
</pre></div>
</div>
<p>（Of course, the location of the Lua interpreter may not be the same for your machine. If <code class="docutils literal notranslate"><span class="pre">lua</span></code> is in your <code class="docutils literal notranslate"><span class="pre">PATH</span></code>, write</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> #!/usr/bin/env lua
</pre></div>
</div>
<p>More generic。）</p>
</section>
<section id="incompatibility-with-previous-versions">
<h2>8 – Incompatibility with previous versions<a class="headerlink" href="#incompatibility-with-previous-versions" title="Permalink to this headline">#</a></h2>
<p>Here we list the incompatibilities that you will encounter when migrating a program from Lua 5.2 to Lua 5.3. You can circumvent some incompatibilities by defining appropriate options when compiling Lua (see the file <code class="docutils literal notranslate"><span class="pre">luaconf.h</span></code>). However, these compatibility options will be removed later.</p>
<p>Lua A version change always modifies some C API and involves changes to the source code. For example, some constant numeric values, using macros to implement some functions. Therefore, you cannot assume binary compatibility between different versions of Lua. When you use the new version, be sure to recompile the client program that uses the Lua API.</p>
<p>Similarly, Lua versioning changes the internal rendering of precompiled code blocks; precompiled code blocks are not compatible between different Lua versions.</p>
<p>The standard path to the official release may also change depending on the version.</p>
<section id="change-of-language">
<h3>8.1 – Change of language<a class="headerlink" href="#change-of-language" title="Permalink to this headline">#</a></h3>
<ul>
<li><p>Lua 5.2 The biggest change to Lua 5.3 is the introduction of integer subtypes for numbers. Although this change does not affect “general” calculations, some calculations (mainly involving overflow) will get different results.</p>
<p>You can eliminate the difference by forcing all numbers to float (in Lua 5.2, all numbers are floats). For example, you can make all constants end in <code class="docutils literal notranslate"><span class="pre">.0</span></code>, or use <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">x</span> <span class="pre">0.0</span> </code>to convert a variable. (This advice is only used to quickly resolve incompatibilities occasionally; it`s not a good programming guideline. If you write the program well, you should use floating points where you need them and integers where you need them.。）</p>
</li>
<li><p>Where floating-point numbers are converted into strings, floating-point numbers equal to integers are now suffixed with <code class="docutils literal notranslate"><span class="pre">.0.</span> <span class="pre">(For</span> <span class="pre">example,</span> <span class="pre">floating</span> <span class="pre">point</span> <span class="pre">numbers</span> <span class="pre">2.0</span> <span class="pre">be</span> <span class="pre">printed</span> <span class="pre">as</span> </code>2.0 <code class="docutils literal notranslate"><span class="pre">instead</span> <span class="pre">of</span> </code>2`.) If you need to customize the format of numbers, you must explicitly format them.</p>
<p>（To be precise, this is not a compatibility issue, because Lua does not specify how numbers are formatted into strings, but some programs assume that they follow a particular format.。）</p>
</li>
<li><p>The generational garbage collector is gone. (It is an experimental feature in Lua 5.2。）</p></li>
</ul>
</section>
<section id="changes-to-the-library">
<h3>8.2 – Changes to the library<a class="headerlink" href="#changes-to-the-library" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bit32</span></code> The library is abandoned. It<code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">easy</span> <span class="pre">to</span> <span class="pre">use</span> <span class="pre">an</span> <span class="pre">external</span> <span class="pre">compatibility</span> <span class="pre">library,</span> <span class="pre">but</span> <span class="pre">it</span></code>s best to replace it directly with the corresponding bit operator. (Note that <code class="docutils literal notranslate"><span class="pre">bit32</span></code> can only be operated on 32-bit integers, while the bit operations in standard Lua can be used on 64-bit integers。）</p></li>
<li><p>The table processing library now considers meta methods when reading and writing elements within them.</p></li>
<li><p><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">ipairs</span></code></span> This iterator will also consider the meta-method, and the <code class="docutils literal notranslate"><span class="pre">__ipairs</span></code> meta-method is discarded.</p></li>
<li><p><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">io.read</span></code></span> The option name of is no longer first. However, for compatibility reasons, Lua will continue to ignore this character.</p></li>
<li><p>These functions in the math library are obsolete: <code class="docutils literal notranslate"><span class="pre">atan2</span></code>, <code class="docutils literal notranslate"><span class="pre">cosh</span></code>, <code class="docutils literal notranslate"><span class="pre">sinh</span></code>, <code class="docutils literal notranslate"><span class="pre">tanh</span></code>, <code class="docutils literal notranslate"><span class="pre">pow</span></code>, <code class="docutils literal notranslate"><span class="pre">frexp</span></code>, and <code class="docutils literal notranslate"><span class="pre">ldexp</span> </code>. You can replace <code class="docutils literal notranslate"><span class="pre">math.pow(x,y)</span></code>with <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">^</span> <span class="pre">y</span></code>; you can replace <code class="docutils literal notranslate"><span class="pre">math.atan2</span></code> with <code class="docutils literal notranslate"><span class="pre">math.atan</span></code>, which can now take one or two arguments; you can replace <code class="docutils literal notranslate"><span class="pre">math.ldexp(x,exp)</span></code> with <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">*</span> <span class="pre">2.0</span> <span class="pre">^</span> <span class="pre">exp</span> </code>. If you use other operations, you can write an extension library or implement them in Lua.</p></li>
<li><p><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">require</span></code></span> The way version numbers are handled when searching for the C loader has changed. Now, the version number should follow the module name (as most other tools do). For compatibility reasons, if the loader cannot be found using the new format, the searcher will still try the old format. (Lua 5.2 has already handled it this way, but it is not written in the document。）</p></li>
</ul>
</section>
<section id="api-the-change">
<h3>8.3 – API The change<a class="headerlink" href="#api-the-change" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>The continuation function now receives the parameters originally obtained with the lua_getctx, so the lua_getctx is removed. Rewrite your code as needed.</p></li>
<li><p>The function <span class="xref myst">lua_dump</span> has an extra parameter <code class="docutils literal notranslate"><span class="pre">strip</span> </code>. If you want to be consistent with the previous behavior, this value passes 0 。</p></li>
<li><p>Functions for passing in and out of unsigned integers (lua_pushunsigned, lua_tounsigned, lua_tounsignedx, luaL_checkunsigned, luaL_optunsigned) are deprecated. Do type conversions directly from the signed version.</p></li>
<li><p>Macros that handle input of non-default integer types (luaL_checkint, luaL_optint, luaL_checklong, luaL_optlong) are deprecated. Use <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_Integer</span></code></span> directly plus a type conversion to replace (or use it in your code whenever possible <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">lua_Integer</span></code></span>）。</p></li>
</ul>
</section>
</section>
<section id="lua-the-full-syntax">
<h2>9 – Lua The full syntax<a class="headerlink" href="#lua-the-full-syntax" title="Permalink to this headline">#</a></h2>
<p>This is the complete syntax of Lua using the extended BNF description. In an extended BNF, {A} represents zero or more A’s, and [A] represents an optional A. (Operator precedence, see <span class="xref myst">§ 3.4.8</span>; for an explanation of final symbols, names, numbers, string literals, see <span class="xref myst">§3.1</span>。）</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>chunk ::= block

block ::= {stat} \[retstat\]

stat ::=  ‘**;**’ |
	 varlist ‘**\=**’ explist |
	 functioncall |
	 label |
	 **break** |
	 **goto** Name |
	 **do** block **end** |
	 **while** exp **do** block **end** |
	 **repeat** block **until** exp |
	 **if** exp **then** block {**elseif** exp **then** block} \[**else** block\] **end** |
	 **for** Name ‘**\=**’ exp ‘**,**’ exp \[‘**,**’ exp\] **do** block **end** |
	 **for** namelist **in** explist **do** block **end** |
	 **function** funcname funcbody |
	 **local** **function** Name funcbody |
	 **local** namelist \[‘**\=**’ explist\]

retstat ::= **return** \[explist\] \[‘**;**’\]

label ::= ‘**::**’ Name ‘**::**’

funcname ::= Name {‘**.**’ Name} \[‘**:**’ Name\]

varlist ::= var {‘**,**’ var}

var ::=  Name | prefixexp ‘**\[**’ exp ‘**\]**’ | prefixexp ‘**.**’ Name

namelist ::= Name {‘**,**’ Name}

explist ::= exp {‘**,**’ exp}

exp ::=  **nil** | **false** | **true** | Numeral | LiteralString | ‘**...**’ | functiondef |
	 prefixexp | tableconstructor | exp binop exp | unop exp

prefixexp ::= var | functioncall | ‘**(**’ exp ‘**)**’

functioncall ::=  prefixexp args | prefixexp ‘**:**’ Name args

args ::=  ‘**(**’ \[explist\] ‘**)**’ | tableconstructor | LiteralString

functiondef ::= **function** funcbody

funcbody ::= ‘**(**’ \[parlist\] ‘**)**’ block **end**

parlist ::= namelist \[‘**,**’ ‘**...**’\] | ‘**...**’

tableconstructor ::= ‘**{**’ \[fieldlist\] ‘**}**’

fieldlist ::= field {fieldsep field} \[fieldsep\]

field ::= ‘**\[**’ exp ‘**\]**’ ‘**\=**’ exp | Name ‘**\=**’ exp | exp

fieldsep ::= ‘**,**’ | ‘**;**’

binop ::=  ‘**+**’ | ‘**\-**’ | ‘**\***’ | ‘**/**’ | ‘**//**’ | ‘**^**’ | ‘**%**’ |
	 ‘**&amp;**’ | ‘**~**’ | ‘**|**’ | ‘**\&gt;&gt;**’ | ‘**&lt;&lt;**’ | ‘**..**’ |
	 ‘**&lt;**’ | ‘**&lt;=**’ | ‘**\&gt;**’ | ‘**\&gt;=**’ | ‘**\==**’ | ‘**~=**’ |
	 **and** | **or**

unop ::= ‘**\-**’ | **not** | ‘**#**’ | ‘**~**’
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          <a class="prev-page" href="luatFramework_exts.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Luat framework (advanced-underlying mechanism)</div>
                
              </div>
            </a>
        </div>
        <p style="font-weight:bold"></p>
        <div class="giscus"></div>
        <script src="https://giscus.app/client.js" data-repo="chenxuuu/luatos-wiki" data-repo-id="R_kgDOHD_oAA" data-category="zzzzz" data-category-id="DIC_kwDOHD_oAM4COQys" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
              Copyright © <a href="https://luatos.com/">LuatOS team</a> | <a href="https://nightly.link/openLuat/luatos-wiki/workflows/sphinx/master">下载离线版文档</a>
            </div>
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Lua 5.3 Reference Manual</a><ul>
<li><a class="reference internal" href="#introduction">1 – Introduction</a></li>
<li><a class="reference internal" href="#basic-concepts">2 – Basic concepts</a><ul>
<li><a class="reference internal" href="#value-and-type">2.1 – Value and Type</a></li>
<li><a class="reference internal" href="#environment-and-global-environment">2.2 – Environment and Global Environment</a></li>
<li><a class="reference internal" href="#error-handling">2.3 – Error handling</a></li>
<li><a class="reference internal" href="#meta-table-and-meta-method">2.4 – Meta Table and Meta Method</a></li>
<li><a class="reference internal" href="#garbage-collection">2.5 – Garbage collection</a><ul>
<li><a class="reference internal" href="#garbage-collection-meta-method">2.5.1 – garbage collection meta-method</a></li>
<li><a class="reference internal" href="#weak-table">2.5.2 – Weak table</a></li>
</ul>
</li>
<li><a class="reference internal" href="#synergy">2.6 – Synergy</a></li>
</ul>
</li>
<li><a class="reference internal" href="#language-definition">3 – Language Definition</a><ul>
<li><a class="reference internal" href="#lexical-convention">3.1 – lexical convention</a></li>
<li><a class="reference internal" href="#variable">3.2 – Variable</a></li>
<li><a class="reference internal" href="#statement">3.3 – Statement</a><ul>
<li><a class="reference internal" href="#statement-block">3.3.1 – statement block</a></li>
<li><a class="reference internal" href="#code-block">3.3.2 – Code Block</a></li>
<li><a class="reference internal" href="#assignment">3.3.3 – Assignment</a></li>
<li><a class="reference internal" href="#control-structure">3.3.4 – control structure</a></li>
<li><a class="reference internal" href="#for-statement">3.3.5 – For Statement</a></li>
<li><a class="reference internal" href="#function-call-statement">3.3.6 – function call statement</a></li>
<li><a class="reference internal" href="#local-declaration">3.3.7 – Local declaration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#expression">3.4 – Expression</a><ul>
<li><a class="reference internal" href="#mathematical-operation-operator">3.4.1 – Mathematical Operation Operator</a></li>
<li><a class="reference internal" href="#bit-operator">3.4.2 – bit operator</a></li>
<li><a class="reference internal" href="#forced-conversion">3.4.3 – Forced Conversion</a></li>
<li><a class="reference internal" href="#comparison-operators">3.4.4 – Comparison Operators</a></li>
<li><a class="reference internal" href="#logical-operator">3.4.5 – logical operator</a></li>
<li><a class="reference internal" href="#string-concatenation">3.4.6 – String concatenation</a></li>
<li><a class="reference internal" href="#take-length-operator">3.4.7 – take length operator</a></li>
<li><a class="reference internal" href="#priority">3.4.8 – Priority</a></li>
<li><a class="reference internal" href="#table-construction">3.4.9 – Table Construction</a></li>
<li><a class="reference internal" href="#function-call">3.4.10 – function call</a></li>
<li><a class="reference internal" href="#function-definition">3.4.11 – Function Definition</a></li>
</ul>
</li>
<li><a class="reference internal" href="#visibility-rules">3.5 – Visibility Rules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#programming-interface">4 – Programming Interface</a><ul>
<li><a class="reference internal" href="#stack">4.1 – Stack</a></li>
<li><a class="reference internal" href="#stack-size">4.2 – Stack Size</a></li>
<li><a class="reference internal" href="#valid-and-acceptable-indexes">4.3 – Valid and Acceptable Indexes</a></li>
<li><a class="reference internal" href="#c-closure">4.4 – C closure</a></li>
<li><a class="reference internal" href="#registry">4.5 – Registry</a></li>
<li><a class="reference internal" href="#c-error-handling-in">4.6 – C Error handling in</a></li>
<li><a class="reference internal" href="#c-give-up-processing-in">4.7 – C Give-up processing in</a></li>
<li><a class="reference internal" href="#functions-and-types">4.8 – Functions and Types</a><ul>
<li><a class="reference internal" href="#lua-absindex"><code class="docutils literal notranslate"><span class="pre">lua_absindex</span></code></a></li>
<li><a class="reference internal" href="#lua-alloc"><code class="docutils literal notranslate"><span class="pre">lua_Alloc</span></code></a></li>
<li><a class="reference internal" href="#lua-arith"><code class="docutils literal notranslate"><span class="pre">lua_arith</span></code></a></li>
<li><a class="reference internal" href="#lua-atpanic"><code class="docutils literal notranslate"><span class="pre">lua_atpanic</span></code></a></li>
<li><a class="reference internal" href="#lua-call"><code class="docutils literal notranslate"><span class="pre">lua_call</span></code></a></li>
<li><a class="reference internal" href="#lua-callk"><code class="docutils literal notranslate"><span class="pre">lua_callk</span></code></a></li>
<li><a class="reference internal" href="#lua-cfunction"><code class="docutils literal notranslate"><span class="pre">lua_CFunction</span></code></a></li>
<li><a class="reference internal" href="#lua-checkstack"><code class="docutils literal notranslate"><span class="pre">lua_checkstack</span></code></a></li>
<li><a class="reference internal" href="#lua-close"><code class="docutils literal notranslate"><span class="pre">lua_close</span></code></a></li>
<li><a class="reference internal" href="#lua-compare"><code class="docutils literal notranslate"><span class="pre">lua_compare</span></code></a></li>
<li><a class="reference internal" href="#lua-concat"><code class="docutils literal notranslate"><span class="pre">lua_concat</span></code></a></li>
<li><a class="reference internal" href="#lua-copy"><code class="docutils literal notranslate"><span class="pre">lua_copy</span></code></a></li>
<li><a class="reference internal" href="#lua-createtable"><code class="docutils literal notranslate"><span class="pre">lua_createtable</span></code></a></li>
<li><a class="reference internal" href="#lua-dump"><code class="docutils literal notranslate"><span class="pre">lua_dump</span></code></a></li>
<li><a class="reference internal" href="#lua-error"><code class="docutils literal notranslate"><span class="pre">lua_error</span></code></a></li>
<li><a class="reference internal" href="#lua-gc"><code class="docutils literal notranslate"><span class="pre">lua_gc</span></code></a></li>
<li><a class="reference internal" href="#lua-getallocf"><code class="docutils literal notranslate"><span class="pre">lua_getallocf</span></code></a></li>
<li><a class="reference internal" href="#lua-getfield"><code class="docutils literal notranslate"><span class="pre">lua_getfield</span></code></a></li>
<li><a class="reference internal" href="#lua-getextraspace"><code class="docutils literal notranslate"><span class="pre">lua_getextraspace</span></code></a></li>
<li><a class="reference internal" href="#lua-getglobal"><code class="docutils literal notranslate"><span class="pre">lua_getglobal</span></code></a></li>
<li><a class="reference internal" href="#lua-geti"><code class="docutils literal notranslate"><span class="pre">lua_geti</span></code></a></li>
<li><a class="reference internal" href="#lua-getmetatable"><code class="docutils literal notranslate"><span class="pre">lua_getmetatable</span></code></a></li>
<li><a class="reference internal" href="#lua-gettable"><code class="docutils literal notranslate"><span class="pre">lua_gettable</span></code></a></li>
<li><a class="reference internal" href="#lua-gettop"><code class="docutils literal notranslate"><span class="pre">lua_gettop</span></code></a></li>
<li><a class="reference internal" href="#lua-getuservalue"><code class="docutils literal notranslate"><span class="pre">lua_getuservalue</span></code></a></li>
<li><a class="reference internal" href="#lua-insert"><code class="docutils literal notranslate"><span class="pre">lua_insert</span></code></a></li>
<li><a class="reference internal" href="#lua-integer"><code class="docutils literal notranslate"><span class="pre">lua_Integer</span></code></a></li>
<li><a class="reference internal" href="#lua-isboolean"><code class="docutils literal notranslate"><span class="pre">lua_isboolean</span></code></a></li>
<li><a class="reference internal" href="#lua-iscfunction"><code class="docutils literal notranslate"><span class="pre">lua_iscfunction</span></code></a></li>
<li><a class="reference internal" href="#lua-isfunction"><code class="docutils literal notranslate"><span class="pre">lua_isfunction</span></code></a></li>
<li><a class="reference internal" href="#lua-isinteger"><code class="docutils literal notranslate"><span class="pre">lua_isinteger</span></code></a></li>
<li><a class="reference internal" href="#lua-islightuserdata"><code class="docutils literal notranslate"><span class="pre">lua_islightuserdata</span></code></a></li>
<li><a class="reference internal" href="#lua-isnil"><code class="docutils literal notranslate"><span class="pre">lua_isnil</span></code></a></li>
<li><a class="reference internal" href="#lua-isnone"><code class="docutils literal notranslate"><span class="pre">lua_isnone</span></code></a></li>
<li><a class="reference internal" href="#lua-isnoneornil"><code class="docutils literal notranslate"><span class="pre">lua_isnoneornil</span></code></a></li>
<li><a class="reference internal" href="#lua-isnumber"><code class="docutils literal notranslate"><span class="pre">lua_isnumber</span></code></a></li>
<li><a class="reference internal" href="#lua-isstring"><code class="docutils literal notranslate"><span class="pre">lua_isstring</span></code></a></li>
<li><a class="reference internal" href="#lua-istable"><code class="docutils literal notranslate"><span class="pre">lua_istable</span></code></a></li>
<li><a class="reference internal" href="#lua-isthread"><code class="docutils literal notranslate"><span class="pre">lua_isthread</span></code></a></li>
<li><a class="reference internal" href="#lua-isuserdata"><code class="docutils literal notranslate"><span class="pre">lua_isuserdata</span></code></a></li>
<li><a class="reference internal" href="#lua-isyieldable"><code class="docutils literal notranslate"><span class="pre">lua_isyieldable</span></code></a></li>
<li><a class="reference internal" href="#lua-kcontext"><code class="docutils literal notranslate"><span class="pre">lua_KContext</span></code></a></li>
<li><a class="reference internal" href="#lua-kfunction"><code class="docutils literal notranslate"><span class="pre">lua_KFunction</span></code></a></li>
<li><a class="reference internal" href="#lua-len"><code class="docutils literal notranslate"><span class="pre">lua_len</span></code></a></li>
<li><a class="reference internal" href="#lua-load"><code class="docutils literal notranslate"><span class="pre">lua_load</span></code></a></li>
<li><a class="reference internal" href="#lua-newstate"><code class="docutils literal notranslate"><span class="pre">lua_newstate</span></code></a></li>
<li><a class="reference internal" href="#lua-newtable"><code class="docutils literal notranslate"><span class="pre">lua_newtable</span></code></a></li>
<li><a class="reference internal" href="#lua-newthread"><code class="docutils literal notranslate"><span class="pre">lua_newthread</span></code></a></li>
<li><a class="reference internal" href="#lua-newuserdata"><code class="docutils literal notranslate"><span class="pre">lua_newuserdata</span></code></a></li>
<li><a class="reference internal" href="#lua-next"><code class="docutils literal notranslate"><span class="pre">lua_next</span></code></a></li>
<li><a class="reference internal" href="#lua-number"><code class="docutils literal notranslate"><span class="pre">lua_Number</span></code></a></li>
<li><a class="reference internal" href="#lua-numbertointeger"><code class="docutils literal notranslate"><span class="pre">lua_numbertointeger</span></code></a></li>
<li><a class="reference internal" href="#lua-pcall"><code class="docutils literal notranslate"><span class="pre">lua_pcall</span></code></a></li>
<li><a class="reference internal" href="#lua-pcallk"><code class="docutils literal notranslate"><span class="pre">lua_pcallk</span></code></a></li>
<li><a class="reference internal" href="#lua-pop"><code class="docutils literal notranslate"><span class="pre">lua_pop</span></code></a></li>
<li><a class="reference internal" href="#lua-pushboolean"><code class="docutils literal notranslate"><span class="pre">lua_pushboolean</span></code></a></li>
<li><a class="reference internal" href="#lua-pushcclosure"><code class="docutils literal notranslate"><span class="pre">lua_pushcclosure</span></code></a></li>
<li><a class="reference internal" href="#lua-pushcfunction"><code class="docutils literal notranslate"><span class="pre">lua_pushcfunction</span></code></a></li>
<li><a class="reference internal" href="#lua-pushfstring"><code class="docutils literal notranslate"><span class="pre">lua_pushfstring</span></code></a></li>
<li><a class="reference internal" href="#lua-pushglobaltable"><code class="docutils literal notranslate"><span class="pre">lua_pushglobaltable</span></code></a></li>
<li><a class="reference internal" href="#lua-pushinteger"><code class="docutils literal notranslate"><span class="pre">lua_pushinteger</span></code></a></li>
<li><a class="reference internal" href="#lua-pushlightuserdata"><code class="docutils literal notranslate"><span class="pre">lua_pushlightuserdata</span></code></a></li>
<li><a class="reference internal" href="#lua-pushliteral"><code class="docutils literal notranslate"><span class="pre">lua_pushliteral</span></code></a></li>
<li><a class="reference internal" href="#lua-pushlstring"><code class="docutils literal notranslate"><span class="pre">lua_pushlstring</span></code></a></li>
<li><a class="reference internal" href="#lua-pushnil"><code class="docutils literal notranslate"><span class="pre">lua_pushnil</span></code></a></li>
<li><a class="reference internal" href="#lua-pushnumber"><code class="docutils literal notranslate"><span class="pre">lua_pushnumber</span></code></a></li>
<li><a class="reference internal" href="#lua-pushstring"><code class="docutils literal notranslate"><span class="pre">lua_pushstring</span></code></a></li>
<li><a class="reference internal" href="#lua-pushthread"><code class="docutils literal notranslate"><span class="pre">lua_pushthread</span></code></a></li>
<li><a class="reference internal" href="#lua-pushvalue"><code class="docutils literal notranslate"><span class="pre">lua_pushvalue</span></code></a></li>
<li><a class="reference internal" href="#lua-pushvfstring"><code class="docutils literal notranslate"><span class="pre">lua_pushvfstring</span></code></a></li>
<li><a class="reference internal" href="#lua-rawequal"><code class="docutils literal notranslate"><span class="pre">lua_rawequal</span></code></a></li>
<li><a class="reference internal" href="#lua-rawget"><code class="docutils literal notranslate"><span class="pre">lua_rawget</span></code></a></li>
<li><a class="reference internal" href="#lua-rawgeti"><code class="docutils literal notranslate"><span class="pre">lua_rawgeti</span></code></a></li>
<li><a class="reference internal" href="#lua-rawgetp"><code class="docutils literal notranslate"><span class="pre">lua_rawgetp</span></code></a></li>
<li><a class="reference internal" href="#lua-rawlen"><code class="docutils literal notranslate"><span class="pre">lua_rawlen</span></code></a></li>
<li><a class="reference internal" href="#lua-rawset"><code class="docutils literal notranslate"><span class="pre">lua_rawset</span></code></a></li>
<li><a class="reference internal" href="#lua-rawseti"><code class="docutils literal notranslate"><span class="pre">lua_rawseti</span></code></a></li>
<li><a class="reference internal" href="#lua-rawsetp"><code class="docutils literal notranslate"><span class="pre">lua_rawsetp</span></code></a></li>
<li><a class="reference internal" href="#lua-reader"><code class="docutils literal notranslate"><span class="pre">lua_Reader</span></code></a></li>
<li><a class="reference internal" href="#lua-register"><code class="docutils literal notranslate"><span class="pre">lua_register</span></code></a></li>
<li><a class="reference internal" href="#lua-remove"><code class="docutils literal notranslate"><span class="pre">lua_remove</span></code></a></li>
<li><a class="reference internal" href="#lua-replace"><code class="docutils literal notranslate"><span class="pre">lua_replace</span></code></a></li>
<li><a class="reference internal" href="#lua-resume"><code class="docutils literal notranslate"><span class="pre">lua_resume</span></code></a></li>
<li><a class="reference internal" href="#lua-rotate"><code class="docutils literal notranslate"><span class="pre">lua_rotate</span></code></a></li>
<li><a class="reference internal" href="#lua-setallocf"><code class="docutils literal notranslate"><span class="pre">lua_setallocf</span></code></a></li>
<li><a class="reference internal" href="#lua-setfield"><code class="docutils literal notranslate"><span class="pre">lua_setfield</span></code></a></li>
<li><a class="reference internal" href="#lua-setglobal"><code class="docutils literal notranslate"><span class="pre">lua_setglobal</span></code></a></li>
<li><a class="reference internal" href="#lua-seti"><code class="docutils literal notranslate"><span class="pre">lua_seti</span></code></a></li>
<li><a class="reference internal" href="#lua-setmetatable"><code class="docutils literal notranslate"><span class="pre">lua_setmetatable</span></code></a></li>
<li><a class="reference internal" href="#lua-settable"><code class="docutils literal notranslate"><span class="pre">lua_settable</span></code></a></li>
<li><a class="reference internal" href="#lua-settop"><code class="docutils literal notranslate"><span class="pre">lua_settop</span></code></a></li>
<li><a class="reference internal" href="#lua-setuservalue"><code class="docutils literal notranslate"><span class="pre">lua_setuservalue</span></code></a></li>
<li><a class="reference internal" href="#lua-state"><code class="docutils literal notranslate"><span class="pre">lua_State</span></code></a></li>
<li><a class="reference internal" href="#lua-status"><code class="docutils literal notranslate"><span class="pre">lua_status</span></code></a></li>
<li><a class="reference internal" href="#lua-stringtonumber"><code class="docutils literal notranslate"><span class="pre">lua_stringtonumber</span></code></a></li>
<li><a class="reference internal" href="#lua-toboolean"><code class="docutils literal notranslate"><span class="pre">lua_toboolean</span></code></a></li>
<li><a class="reference internal" href="#lua-tocfunction"><code class="docutils literal notranslate"><span class="pre">lua_tocfunction</span></code></a></li>
<li><a class="reference internal" href="#lua-tointeger"><code class="docutils literal notranslate"><span class="pre">lua_tointeger</span></code></a></li>
<li><a class="reference internal" href="#lua-tointegerx"><code class="docutils literal notranslate"><span class="pre">lua_tointegerx</span></code></a></li>
<li><a class="reference internal" href="#lua-tolstring"><code class="docutils literal notranslate"><span class="pre">lua_tolstring</span></code></a></li>
<li><a class="reference internal" href="#lua-tonumber"><code class="docutils literal notranslate"><span class="pre">lua_tonumber</span></code></a></li>
<li><a class="reference internal" href="#lua-tonumberx"><code class="docutils literal notranslate"><span class="pre">lua_tonumberx</span></code></a></li>
<li><a class="reference internal" href="#lua-topointer"><code class="docutils literal notranslate"><span class="pre">lua_topointer</span></code></a></li>
<li><a class="reference internal" href="#lua-tostring"><code class="docutils literal notranslate"><span class="pre">lua_tostring</span></code></a></li>
<li><a class="reference internal" href="#lua-tothread"><code class="docutils literal notranslate"><span class="pre">lua_tothread</span></code></a></li>
<li><a class="reference internal" href="#lua-touserdata"><code class="docutils literal notranslate"><span class="pre">lua_touserdata</span></code></a></li>
<li><a class="reference internal" href="#lua-type"><code class="docutils literal notranslate"><span class="pre">lua_type</span></code></a></li>
<li><a class="reference internal" href="#lua-typename"><code class="docutils literal notranslate"><span class="pre">lua_typename</span></code></a></li>
<li><a class="reference internal" href="#lua-unsigned"><code class="docutils literal notranslate"><span class="pre">lua_Unsigned</span></code></a></li>
<li><a class="reference internal" href="#lua-upvalueindex"><code class="docutils literal notranslate"><span class="pre">lua_upvalueindex</span></code></a></li>
<li><a class="reference internal" href="#lua-version"><code class="docutils literal notranslate"><span class="pre">lua_version</span></code></a></li>
<li><a class="reference internal" href="#lua-writer"><code class="docutils literal notranslate"><span class="pre">lua_Writer</span></code></a></li>
<li><a class="reference internal" href="#lua-xmove"><code class="docutils literal notranslate"><span class="pre">lua_xmove</span></code></a></li>
<li><a class="reference internal" href="#lua-yield"><code class="docutils literal notranslate"><span class="pre">lua_yield</span></code></a></li>
<li><a class="reference internal" href="#lua-yieldk"><code class="docutils literal notranslate"><span class="pre">lua_yieldk</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#debug-interface">4.9 – Debug Interface</a><ul>
<li><a class="reference internal" href="#lua-debug"><code class="docutils literal notranslate"><span class="pre">lua_Debug</span></code></a></li>
<li><a class="reference internal" href="#lua-gethook"><code class="docutils literal notranslate"><span class="pre">lua_gethook</span></code></a></li>
<li><a class="reference internal" href="#lua-gethookcount"><code class="docutils literal notranslate"><span class="pre">lua_gethookcount</span></code></a></li>
<li><a class="reference internal" href="#lua-gethookmask"><code class="docutils literal notranslate"><span class="pre">lua_gethookmask</span></code></a></li>
<li><a class="reference internal" href="#lua-getinfo"><code class="docutils literal notranslate"><span class="pre">lua_getinfo</span></code></a></li>
<li><a class="reference internal" href="#lua-getlocal"><code class="docutils literal notranslate"><span class="pre">lua_getlocal</span></code></a></li>
<li><a class="reference internal" href="#lua-getstack"><code class="docutils literal notranslate"><span class="pre">lua_getstack</span></code></a></li>
<li><a class="reference internal" href="#lua-getupvalue"><code class="docutils literal notranslate"><span class="pre">lua_getupvalue</span></code></a></li>
<li><a class="reference internal" href="#lua-hook"><code class="docutils literal notranslate"><span class="pre">lua_Hook</span></code></a></li>
<li><a class="reference internal" href="#lua-sethook"><code class="docutils literal notranslate"><span class="pre">lua_sethook</span></code></a></li>
<li><a class="reference internal" href="#lua-setlocal"><code class="docutils literal notranslate"><span class="pre">lua_setlocal</span></code></a></li>
<li><a class="reference internal" href="#lua-setupvalue"><code class="docutils literal notranslate"><span class="pre">lua_setupvalue</span></code></a></li>
<li><a class="reference internal" href="#lua-upvalueid"><code class="docutils literal notranslate"><span class="pre">lua_upvalueid</span></code></a></li>
<li><a class="reference internal" href="#lua-upvaluejoin"><code class="docutils literal notranslate"><span class="pre">lua_upvaluejoin</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#auxiliary-library">5 – auxiliary library</a><ul>
<li><a class="reference internal" href="#id1">5.1 – Functions and Types</a><ul>
<li><a class="reference internal" href="#lual-addchar"><code class="docutils literal notranslate"><span class="pre">luaL_addchar</span></code></a></li>
<li><a class="reference internal" href="#lual-addlstring"><code class="docutils literal notranslate"><span class="pre">luaL_addlstring</span></code></a></li>
<li><a class="reference internal" href="#lual-addsize"><code class="docutils literal notranslate"><span class="pre">luaL_addsize</span></code></a></li>
<li><a class="reference internal" href="#lual-addstring"><code class="docutils literal notranslate"><span class="pre">luaL_addstring</span></code></a></li>
<li><a class="reference internal" href="#lual-addvalue"><code class="docutils literal notranslate"><span class="pre">luaL_addvalue</span></code></a></li>
<li><a class="reference internal" href="#lual-argcheck"><code class="docutils literal notranslate"><span class="pre">luaL_argcheck</span></code></a></li>
<li><a class="reference internal" href="#lual-argerror"><code class="docutils literal notranslate"><span class="pre">luaL_argerror</span></code></a></li>
<li><a class="reference internal" href="#lual-buffer"><code class="docutils literal notranslate"><span class="pre">luaL_Buffer</span></code></a></li>
<li><a class="reference internal" href="#lual-buffinit"><code class="docutils literal notranslate"><span class="pre">luaL_buffinit</span></code></a></li>
<li><a class="reference internal" href="#lual-buffinitsize"><code class="docutils literal notranslate"><span class="pre">luaL_buffinitsize</span></code></a></li>
<li><a class="reference internal" href="#lual-callmeta"><code class="docutils literal notranslate"><span class="pre">luaL_callmeta</span></code></a></li>
<li><a class="reference internal" href="#lual-checkany"><code class="docutils literal notranslate"><span class="pre">luaL_checkany</span></code></a></li>
<li><a class="reference internal" href="#lual-checkinteger"><code class="docutils literal notranslate"><span class="pre">luaL_checkinteger</span></code></a></li>
<li><a class="reference internal" href="#lual-checklstring"><code class="docutils literal notranslate"><span class="pre">luaL_checklstring</span></code></a></li>
<li><a class="reference internal" href="#lual-checknumber"><code class="docutils literal notranslate"><span class="pre">luaL_checknumber</span></code></a></li>
<li><a class="reference internal" href="#lual-checkoption"><code class="docutils literal notranslate"><span class="pre">luaL_checkoption</span></code></a></li>
<li><a class="reference internal" href="#lual-checkstack"><code class="docutils literal notranslate"><span class="pre">luaL_checkstack</span></code></a></li>
<li><a class="reference internal" href="#lual-checkstring"><code class="docutils literal notranslate"><span class="pre">luaL_checkstring</span></code></a></li>
<li><a class="reference internal" href="#lual-checktype"><code class="docutils literal notranslate"><span class="pre">luaL_checktype</span></code></a></li>
<li><a class="reference internal" href="#lual-checkudata"><code class="docutils literal notranslate"><span class="pre">luaL_checkudata</span></code></a></li>
<li><a class="reference internal" href="#lual-checkversion"><code class="docutils literal notranslate"><span class="pre">luaL_checkversion</span></code></a></li>
<li><a class="reference internal" href="#lual-dofile"><code class="docutils literal notranslate"><span class="pre">luaL_dofile</span></code></a></li>
<li><a class="reference internal" href="#lual-dostring"><code class="docutils literal notranslate"><span class="pre">luaL_dostring</span></code></a></li>
<li><a class="reference internal" href="#lual-error"><code class="docutils literal notranslate"><span class="pre">luaL_error</span></code></a></li>
<li><a class="reference internal" href="#lual-execresult"><code class="docutils literal notranslate"><span class="pre">luaL_execresult</span></code></a></li>
<li><a class="reference internal" href="#lual-fileresult"><code class="docutils literal notranslate"><span class="pre">luaL_fileresult</span></code></a></li>
<li><a class="reference internal" href="#lual-getmetafield"><code class="docutils literal notranslate"><span class="pre">luaL_getmetafield</span></code></a></li>
<li><a class="reference internal" href="#lual-getmetatable"><code class="docutils literal notranslate"><span class="pre">luaL_getmetatable</span></code></a></li>
<li><a class="reference internal" href="#lual-getsubtable"><code class="docutils literal notranslate"><span class="pre">luaL_getsubtable</span></code></a></li>
<li><a class="reference internal" href="#lual-gsub"><code class="docutils literal notranslate"><span class="pre">luaL_gsub</span></code></a></li>
<li><a class="reference internal" href="#lual-len"><code class="docutils literal notranslate"><span class="pre">luaL_len</span></code></a></li>
<li><a class="reference internal" href="#lual-loadbuffer"><code class="docutils literal notranslate"><span class="pre">luaL_loadbuffer</span></code></a></li>
<li><a class="reference internal" href="#lual-loadbufferx"><code class="docutils literal notranslate"><span class="pre">luaL_loadbufferx</span></code></a></li>
<li><a class="reference internal" href="#lual-loadfile"><code class="docutils literal notranslate"><span class="pre">luaL_loadfile</span></code></a></li>
<li><a class="reference internal" href="#lual-loadfilex"><code class="docutils literal notranslate"><span class="pre">luaL_loadfilex</span></code></a></li>
<li><a class="reference internal" href="#lual-loadstring"><code class="docutils literal notranslate"><span class="pre">luaL_loadstring</span></code></a></li>
<li><a class="reference internal" href="#lual-newlib"><code class="docutils literal notranslate"><span class="pre">luaL_newlib</span></code></a></li>
<li><a class="reference internal" href="#lual-newlibtable"><code class="docutils literal notranslate"><span class="pre">luaL_newlibtable</span></code></a></li>
<li><a class="reference internal" href="#lual-newmetatable"><code class="docutils literal notranslate"><span class="pre">luaL_newmetatable</span></code></a></li>
<li><a class="reference internal" href="#lual-newstate"><code class="docutils literal notranslate"><span class="pre">luaL_newstate</span></code></a></li>
<li><a class="reference internal" href="#lual-openlibs"><code class="docutils literal notranslate"><span class="pre">luaL_openlibs</span></code></a></li>
<li><a class="reference internal" href="#lual-optinteger"><code class="docutils literal notranslate"><span class="pre">luaL_optinteger</span></code></a></li>
<li><a class="reference internal" href="#lual-optlstring"><code class="docutils literal notranslate"><span class="pre">luaL_optlstring</span></code></a></li>
<li><a class="reference internal" href="#lual-optnumber"><code class="docutils literal notranslate"><span class="pre">luaL_optnumber</span></code></a></li>
<li><a class="reference internal" href="#lual-optstring"><code class="docutils literal notranslate"><span class="pre">luaL_optstring</span></code></a></li>
<li><a class="reference internal" href="#lual-prepbuffer"><code class="docutils literal notranslate"><span class="pre">luaL_prepbuffer</span></code></a></li>
<li><a class="reference internal" href="#lual-prepbuffsize"><code class="docutils literal notranslate"><span class="pre">luaL_prepbuffsize</span></code></a></li>
<li><a class="reference internal" href="#lual-pushresult"><code class="docutils literal notranslate"><span class="pre">luaL_pushresult</span></code></a></li>
<li><a class="reference internal" href="#lual-pushresultsize"><code class="docutils literal notranslate"><span class="pre">luaL_pushresultsize</span></code></a></li>
<li><a class="reference internal" href="#lual-ref"><code class="docutils literal notranslate"><span class="pre">luaL_ref</span></code></a></li>
<li><a class="reference internal" href="#lual-reg"><code class="docutils literal notranslate"><span class="pre">luaL_Reg</span></code></a></li>
<li><a class="reference internal" href="#lual-requiref"><code class="docutils literal notranslate"><span class="pre">luaL_requiref</span></code></a></li>
<li><a class="reference internal" href="#lual-setfuncs"><code class="docutils literal notranslate"><span class="pre">luaL_setfuncs</span></code></a></li>
<li><a class="reference internal" href="#lual-setmetatable"><code class="docutils literal notranslate"><span class="pre">luaL_setmetatable</span></code></a></li>
<li><a class="reference internal" href="#lual-stream"><code class="docutils literal notranslate"><span class="pre">luaL_Stream</span></code></a></li>
<li><a class="reference internal" href="#lual-testudata"><code class="docutils literal notranslate"><span class="pre">luaL_testudata</span></code></a></li>
<li><a class="reference internal" href="#lual-tolstring"><code class="docutils literal notranslate"><span class="pre">luaL_tolstring</span></code></a></li>
<li><a class="reference internal" href="#lual-traceback"><code class="docutils literal notranslate"><span class="pre">luaL_traceback</span></code></a></li>
<li><a class="reference internal" href="#lual-typename"><code class="docutils literal notranslate"><span class="pre">luaL_typename</span></code></a></li>
<li><a class="reference internal" href="#lual-unref"><code class="docutils literal notranslate"><span class="pre">luaL_unref</span></code></a></li>
<li><a class="reference internal" href="#lual-where"><code class="docutils literal notranslate"><span class="pre">luaL_where</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#standard-library">6 – Standard Library</a><ul>
<li><a class="reference internal" href="#basic-function">6.1 – basic function</a><ul>
<li><a class="reference internal" href="#assert-v-message"><code class="docutils literal notranslate"><span class="pre">assert</span> <span class="pre">(v</span> <span class="pre">[,</span> <span class="pre">message])</span></code></a></li>
<li><a class="reference internal" href="#collectgarbage-opt-arg"><code class="docutils literal notranslate"><span class="pre">collectgarbage</span> <span class="pre">([opt</span> <span class="pre">[,</span> <span class="pre">arg]])</span></code></a></li>
<li><a class="reference internal" href="#dofile-filename"><code class="docutils literal notranslate"><span class="pre">dofile</span> <span class="pre">([filename])</span></code></a></li>
<li><a class="reference internal" href="#error-message-level"><code class="docutils literal notranslate"><span class="pre">error</span> <span class="pre">(message</span> <span class="pre">[,</span> <span class="pre">level])</span></code></a></li>
<li><a class="reference internal" href="#g"><code class="docutils literal notranslate"><span class="pre">_G</span></code></a></li>
<li><a class="reference internal" href="#getmetatable-object"><code class="docutils literal notranslate"><span class="pre">getmetatable</span> <span class="pre">(object)</span></code></a></li>
<li><a class="reference internal" href="#ipairs-t"><code class="docutils literal notranslate"><span class="pre">ipairs</span> <span class="pre">(t)</span></code></a></li>
<li><a class="reference internal" href="#load-chunk-chunkname-mode-env"><code class="docutils literal notranslate"><span class="pre">load</span> <span class="pre">(chunk</span> <span class="pre">[,</span> <span class="pre">chunkname</span> <span class="pre">[,</span> <span class="pre">mode</span> <span class="pre">[,</span> <span class="pre">env]]])</span></code></a></li>
<li><a class="reference internal" href="#loadfile-filename-mode-env"><code class="docutils literal notranslate"><span class="pre">loadfile</span> <span class="pre">([filename</span> <span class="pre">[,</span> <span class="pre">mode</span> <span class="pre">[,</span> <span class="pre">env]]])</span></code></a></li>
<li><a class="reference internal" href="#next-table-index"><code class="docutils literal notranslate"><span class="pre">next</span> <span class="pre">(table</span> <span class="pre">[,</span> <span class="pre">index])</span></code></a></li>
<li><a class="reference internal" href="#pairs-t"><code class="docutils literal notranslate"><span class="pre">pairs</span> <span class="pre">(t)</span></code></a></li>
<li><a class="reference internal" href="#pcall-f-arg1"><code class="docutils literal notranslate"><span class="pre">pcall</span> <span class="pre">(f</span> <span class="pre">[,</span> <span class="pre">arg1,</span> <span class="pre">···])</span></code></a></li>
<li><a class="reference internal" href="#print"><code class="docutils literal notranslate"><span class="pre">print</span> <span class="pre">(···)</span></code></a></li>
<li><a class="reference internal" href="#rawequal-v1-v2"><code class="docutils literal notranslate"><span class="pre">rawequal</span> <span class="pre">(v1,</span> <span class="pre">v2)</span></code></a></li>
<li><a class="reference internal" href="#rawget-table-index"><code class="docutils literal notranslate"><span class="pre">rawget</span> <span class="pre">(table,</span> <span class="pre">index)</span></code></a></li>
<li><a class="reference internal" href="#rawlen-v"><code class="docutils literal notranslate"><span class="pre">rawlen</span> <span class="pre">(v)</span></code></a></li>
<li><a class="reference internal" href="#rawset-table-index-value"><code class="docutils literal notranslate"><span class="pre">rawset</span> <span class="pre">(table,</span> <span class="pre">index,</span> <span class="pre">value)</span></code></a></li>
<li><a class="reference internal" href="#select-index"><code class="docutils literal notranslate"><span class="pre">select</span> <span class="pre">(index,</span> <span class="pre">···)</span></code></a></li>
<li><a class="reference internal" href="#setmetatable-table-metatable"><code class="docutils literal notranslate"><span class="pre">setmetatable</span> <span class="pre">(table,</span> <span class="pre">metatable)</span></code></a></li>
<li><a class="reference internal" href="#tonumber-e-base"><code class="docutils literal notranslate"><span class="pre">tonumber</span> <span class="pre">(e</span> <span class="pre">[,</span> <span class="pre">base])</span></code></a></li>
<li><a class="reference internal" href="#tostring-v"><code class="docutils literal notranslate"><span class="pre">tostring</span> <span class="pre">(v)</span></code></a></li>
<li><a class="reference internal" href="#type-v"><code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">(v)</span></code></a></li>
<li><a class="reference internal" href="#version"><code class="docutils literal notranslate"><span class="pre">_VERSION</span></code></a></li>
<li><a class="reference internal" href="#xpcall-f-msgh-arg1"><code class="docutils literal notranslate"><span class="pre">xpcall</span> <span class="pre">(f,</span> <span class="pre">msgh</span> <span class="pre">[,</span> <span class="pre">arg1,</span> <span class="pre">···])</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#synergy-management">6.2 – Synergy Management</a><ul>
<li><a class="reference internal" href="#coroutine-create-f"><code class="docutils literal notranslate"><span class="pre">coroutine.create</span> <span class="pre">(f)</span></code></a></li>
<li><a class="reference internal" href="#coroutine-isyieldable"><code class="docutils literal notranslate"><span class="pre">coroutine.isyieldable</span> <span class="pre">()</span></code></a></li>
<li><a class="reference internal" href="#coroutine-resume-co-val1"><code class="docutils literal notranslate"><span class="pre">coroutine.resume</span> <span class="pre">(co</span> <span class="pre">[,</span> <span class="pre">val1,</span> <span class="pre">···])</span></code></a></li>
<li><a class="reference internal" href="#coroutine-running"><code class="docutils literal notranslate"><span class="pre">coroutine.running</span> <span class="pre">()</span></code></a></li>
<li><a class="reference internal" href="#coroutine-status-co"><code class="docutils literal notranslate"><span class="pre">coroutine.status</span> <span class="pre">(co)</span></code></a></li>
<li><a class="reference internal" href="#coroutine-wrap-f"><code class="docutils literal notranslate"><span class="pre">coroutine.wrap</span> <span class="pre">(f)</span></code></a></li>
<li><a class="reference internal" href="#coroutine-yield"><code class="docutils literal notranslate"><span class="pre">coroutine.yield</span> <span class="pre">(···)</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module">6.3 – Module</a><ul>
<li><a class="reference internal" href="#require-modname"><code class="docutils literal notranslate"><span class="pre">require</span> <span class="pre">(modname)</span></code></a></li>
<li><a class="reference internal" href="#package-config"><code class="docutils literal notranslate"><span class="pre">package.config</span></code></a></li>
<li><a class="reference internal" href="#package-cpath"><code class="docutils literal notranslate"><span class="pre">package.cpath</span></code></a></li>
<li><a class="reference internal" href="#package-loaded"><code class="docutils literal notranslate"><span class="pre">package.loaded</span></code></a></li>
<li><a class="reference internal" href="#package-loadlib-libname-funcname"><code class="docutils literal notranslate"><span class="pre">package.loadlib</span> <span class="pre">(libname,</span> <span class="pre">funcname)</span></code></a></li>
<li><a class="reference internal" href="#package-path"><code class="docutils literal notranslate"><span class="pre">package.path</span></code></a></li>
<li><a class="reference internal" href="#package-preload"><code class="docutils literal notranslate"><span class="pre">package.preload</span></code></a></li>
<li><a class="reference internal" href="#package-searchers"><code class="docutils literal notranslate"><span class="pre">package.searchers</span></code></a></li>
<li><a class="reference internal" href="#package-searchpath-name-path-sep-rep"><code class="docutils literal notranslate"><span class="pre">package.searchpath</span> <span class="pre">(name,</span> <span class="pre">path</span> <span class="pre">[,</span> <span class="pre">sep</span> <span class="pre">[,</span> <span class="pre">rep]])</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#string-processing">6.4 – String processing</a><ul>
<li><a class="reference internal" href="#string-byte-s-i-j"><code class="docutils literal notranslate"><span class="pre">string.byte</span> <span class="pre">(s</span> <span class="pre">[,</span> <span class="pre">i</span> <span class="pre">[,</span> <span class="pre">j]])</span></code></a></li>
<li><a class="reference internal" href="#string-char"><code class="docutils literal notranslate"><span class="pre">string.char</span> <span class="pre">(···)</span></code></a></li>
<li><a class="reference internal" href="#string-dump-function-strip"><code class="docutils literal notranslate"><span class="pre">string.dump</span> <span class="pre">(function</span> <span class="pre">[,</span> <span class="pre">strip])</span></code></a></li>
<li><a class="reference internal" href="#string-find-s-pattern-init-plain"><code class="docutils literal notranslate"><span class="pre">string.find</span> <span class="pre">(s,</span> <span class="pre">pattern</span> <span class="pre">[,</span> <span class="pre">init</span> <span class="pre">[,</span> <span class="pre">plain]])</span></code></a></li>
<li><a class="reference internal" href="#string-format-formatstring"><code class="docutils literal notranslate"><span class="pre">string.format</span> <span class="pre">(formatstring,</span> <span class="pre">···)</span></code></a></li>
<li><a class="reference internal" href="#string-gmatch-s-pattern"><code class="docutils literal notranslate"><span class="pre">string.gmatch</span> <span class="pre">(s,</span> <span class="pre">pattern)</span></code></a></li>
<li><a class="reference internal" href="#string-gsub-s-pattern-repl-n"><code class="docutils literal notranslate"><span class="pre">string.gsub</span> <span class="pre">(s,</span> <span class="pre">pattern,</span> <span class="pre">repl</span> <span class="pre">[,</span> <span class="pre">n])</span></code></a></li>
<li><a class="reference internal" href="#string-len-s"><code class="docutils literal notranslate"><span class="pre">string.len</span> <span class="pre">(s)</span></code></a></li>
<li><a class="reference internal" href="#string-lower-s"><code class="docutils literal notranslate"><span class="pre">string.lower</span> <span class="pre">(s)</span></code></a></li>
<li><a class="reference internal" href="#string-match-s-pattern-init"><code class="docutils literal notranslate"><span class="pre">string.match</span> <span class="pre">(s,</span> <span class="pre">pattern</span> <span class="pre">[,</span> <span class="pre">init])</span></code></a></li>
<li><a class="reference internal" href="#string-pack-fmt-v1-v2"><code class="docutils literal notranslate"><span class="pre">string.pack</span> <span class="pre">(fmt,</span> <span class="pre">v1,</span> <span class="pre">v2,</span> <span class="pre">···)</span></code></a></li>
<li><a class="reference internal" href="#string-packsize-fmt"><code class="docutils literal notranslate"><span class="pre">string.packsize</span> <span class="pre">(fmt)</span></code></a></li>
<li><a class="reference internal" href="#string-rep-s-n-sep"><code class="docutils literal notranslate"><span class="pre">string.rep</span> <span class="pre">(s,</span> <span class="pre">n</span> <span class="pre">[,</span> <span class="pre">sep])</span></code></a></li>
<li><a class="reference internal" href="#string-reverse-s"><code class="docutils literal notranslate"><span class="pre">string.reverse</span> <span class="pre">(s)</span></code></a></li>
<li><a class="reference internal" href="#string-sub-s-i-j"><code class="docutils literal notranslate"><span class="pre">string.sub</span> <span class="pre">(s,</span> <span class="pre">i</span> <span class="pre">[,</span> <span class="pre">j])</span></code></a></li>
<li><a class="reference internal" href="#string-unpack-fmt-s-pos"><code class="docutils literal notranslate"><span class="pre">string.unpack</span> <span class="pre">(fmt,</span> <span class="pre">s</span> <span class="pre">[,</span> <span class="pre">pos])</span></code></a></li>
<li><a class="reference internal" href="#string-upper-s"><code class="docutils literal notranslate"><span class="pre">string.upper</span> <span class="pre">(s)</span></code></a></li>
<li><a class="reference internal" href="#match-mode">6.4.1 – Match mode</a><ul>
<li><a class="reference internal" href="#character-class">Character Class：</a></li>
<li><a class="reference internal" href="#mode-entry">Mode Entry：</a></li>
<li><a class="reference internal" href="#mode">Mode：</a></li>
<li><a class="reference internal" href="#capture">Capture：</a></li>
</ul>
</li>
<li><a class="reference internal" href="#format-string-used-for-packaging-and-unpacking">6.4.2 – Format string used for packaging and unpacking</a></li>
</ul>
</li>
<li><a class="reference internal" href="#utf-8-support">6.5 – UTF-8 Support</a><ul>
<li><a class="reference internal" href="#utf8-char"><code class="docutils literal notranslate"><span class="pre">utf8.char</span> <span class="pre">(···)</span></code></a></li>
<li><a class="reference internal" href="#utf8-charpattern"><code class="docutils literal notranslate"><span class="pre">utf8.charpattern</span></code></a></li>
<li><a class="reference internal" href="#utf8-codes-s"><code class="docutils literal notranslate"><span class="pre">utf8.codes</span> <span class="pre">(s)</span></code></a></li>
<li><a class="reference internal" href="#utf8-codepoint-s-i-j"><code class="docutils literal notranslate"><span class="pre">utf8.codepoint</span> <span class="pre">(s</span> <span class="pre">[,</span> <span class="pre">i</span> <span class="pre">[,</span> <span class="pre">j]])</span></code></a></li>
<li><a class="reference internal" href="#utf8-len-s-i-j"><code class="docutils literal notranslate"><span class="pre">utf8.len</span> <span class="pre">(s</span> <span class="pre">[,</span> <span class="pre">i</span> <span class="pre">[,</span> <span class="pre">j]])</span></code></a></li>
<li><a class="reference internal" href="#utf8-offset-s-n-i"><code class="docutils literal notranslate"><span class="pre">utf8.offset</span> <span class="pre">(s,</span> <span class="pre">n</span> <span class="pre">[,</span> <span class="pre">i])</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#table-processing">6.6 – Table Processing</a><ul>
<li><a class="reference internal" href="#table-concat-list-sep-i-j"><code class="docutils literal notranslate"><span class="pre">table.concat</span> <span class="pre">(list</span> <span class="pre">[,</span> <span class="pre">sep</span> <span class="pre">[,</span> <span class="pre">i</span> <span class="pre">[,</span> <span class="pre">j]]])</span></code></a></li>
<li><a class="reference internal" href="#table-insert-list-pos-value"><code class="docutils literal notranslate"><span class="pre">table.insert</span> <span class="pre">(list,</span> <span class="pre">[pos,]</span> <span class="pre">value)</span></code></a></li>
<li><a class="reference internal" href="#table-move-a1-f-e-t-a2"><code class="docutils literal notranslate"><span class="pre">table.move</span> <span class="pre">(a1,</span> <span class="pre">f,</span> <span class="pre">e,</span> <span class="pre">t</span> <span class="pre">[,a2])</span></code></a></li>
<li><a class="reference internal" href="#table-pack"><code class="docutils literal notranslate"><span class="pre">table.pack</span> <span class="pre">(···)</span></code></a></li>
<li><a class="reference internal" href="#table-remove-list-pos"><code class="docutils literal notranslate"><span class="pre">table.remove</span> <span class="pre">(list</span> <span class="pre">[,</span> <span class="pre">pos])</span></code></a></li>
<li><a class="reference internal" href="#table-sort-list-comp"><code class="docutils literal notranslate"><span class="pre">table.sort</span> <span class="pre">(list</span> <span class="pre">[,</span> <span class="pre">comp])</span></code></a></li>
<li><a class="reference internal" href="#table-unpack-list-i-j"><code class="docutils literal notranslate"><span class="pre">table.unpack</span> <span class="pre">(list</span> <span class="pre">[,</span> <span class="pre">i</span> <span class="pre">[,</span> <span class="pre">j]])</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mathematical-function">6.7 – mathematical function</a><ul>
<li><a class="reference internal" href="#math-abs-x"><code class="docutils literal notranslate"><span class="pre">math.abs</span> <span class="pre">(x)</span></code></a></li>
<li><a class="reference internal" href="#math-acos-x"><code class="docutils literal notranslate"><span class="pre">math.acos</span> <span class="pre">(x)</span></code></a></li>
<li><a class="reference internal" href="#math-asin-x"><code class="docutils literal notranslate"><span class="pre">math.asin</span> <span class="pre">(x)</span></code></a></li>
<li><a class="reference internal" href="#math-atan-y-x"><code class="docutils literal notranslate"><span class="pre">math.atan</span> <span class="pre">(y</span> <span class="pre">[,</span> <span class="pre">x])</span></code></a></li>
<li><a class="reference internal" href="#math-ceil-x"><code class="docutils literal notranslate"><span class="pre">math.ceil</span> <span class="pre">(x)</span></code></a></li>
<li><a class="reference internal" href="#math-cos-x"><code class="docutils literal notranslate"><span class="pre">math.cos</span> <span class="pre">(x)</span></code></a></li>
<li><a class="reference internal" href="#math-deg-x"><code class="docutils literal notranslate"><span class="pre">math.deg</span> <span class="pre">(x)</span></code></a></li>
<li><a class="reference internal" href="#math-exp-x"><code class="docutils literal notranslate"><span class="pre">math.exp</span> <span class="pre">(x)</span></code></a></li>
<li><a class="reference internal" href="#math-floor-x"><code class="docutils literal notranslate"><span class="pre">math.floor</span> <span class="pre">(x)</span></code></a></li>
<li><a class="reference internal" href="#math-fmod-x-y"><code class="docutils literal notranslate"><span class="pre">math.fmod</span> <span class="pre">(x,</span> <span class="pre">y)</span></code></a></li>
<li><a class="reference internal" href="#math-huge"><code class="docutils literal notranslate"><span class="pre">math.huge</span></code></a></li>
<li><a class="reference internal" href="#math-log-x-base"><code class="docutils literal notranslate"><span class="pre">math.log</span> <span class="pre">(x</span> <span class="pre">[,</span> <span class="pre">base])</span></code></a></li>
<li><a class="reference internal" href="#math-max-x"><code class="docutils literal notranslate"><span class="pre">math.max</span> <span class="pre">(x,</span> <span class="pre">···)</span></code></a></li>
<li><a class="reference internal" href="#math-maxinteger"><code class="docutils literal notranslate"><span class="pre">math.maxinteger</span></code></a></li>
<li><a class="reference internal" href="#math-min-x"><code class="docutils literal notranslate"><span class="pre">math.min</span> <span class="pre">(x,</span> <span class="pre">···)</span></code></a></li>
<li><a class="reference internal" href="#math-mininteger"><code class="docutils literal notranslate"><span class="pre">math.mininteger</span></code></a></li>
<li><a class="reference internal" href="#math-modf-x"><code class="docutils literal notranslate"><span class="pre">math.modf</span> <span class="pre">(x)</span></code></a></li>
<li><a class="reference internal" href="#math-pi"><code class="docutils literal notranslate"><span class="pre">math.pi</span></code></a></li>
<li><a class="reference internal" href="#math-rad-x"><code class="docutils literal notranslate"><span class="pre">math.rad</span> <span class="pre">(x)</span></code></a></li>
<li><a class="reference internal" href="#math-random-m-n"><code class="docutils literal notranslate"><span class="pre">math.random</span> <span class="pre">([m</span> <span class="pre">[,</span> <span class="pre">n]])</span></code></a></li>
<li><a class="reference internal" href="#math-randomseed-x"><code class="docutils literal notranslate"><span class="pre">math.randomseed</span> <span class="pre">(x)</span></code></a></li>
<li><a class="reference internal" href="#math-sin-x"><code class="docutils literal notranslate"><span class="pre">math.sin</span> <span class="pre">(x)</span></code></a></li>
<li><a class="reference internal" href="#math-sqrt-x"><code class="docutils literal notranslate"><span class="pre">math.sqrt</span> <span class="pre">(x)</span></code></a></li>
<li><a class="reference internal" href="#math-tan-x"><code class="docutils literal notranslate"><span class="pre">math.tan</span> <span class="pre">(x)</span></code></a></li>
<li><a class="reference internal" href="#math-tointeger-x"><code class="docutils literal notranslate"><span class="pre">math.tointeger</span> <span class="pre">(x)</span></code></a></li>
<li><a class="reference internal" href="#math-type-x"><code class="docutils literal notranslate"><span class="pre">math.type</span> <span class="pre">(x)</span></code></a></li>
<li><a class="reference internal" href="#math-ult-m-n"><code class="docutils literal notranslate"><span class="pre">math.ult</span> <span class="pre">(m,</span> <span class="pre">n)</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#input-and-output-library">6.8 – input and output library</a><ul>
<li><a class="reference internal" href="#io-close-file"><code class="docutils literal notranslate"><span class="pre">io.close</span> <span class="pre">([file])</span></code></a></li>
<li><a class="reference internal" href="#io-flush"><code class="docutils literal notranslate"><span class="pre">io.flush</span> <span class="pre">()</span></code></a></li>
<li><a class="reference internal" href="#io-input-file"><code class="docutils literal notranslate"><span class="pre">io.input</span> <span class="pre">([file])</span></code></a></li>
<li><a class="reference internal" href="#io-lines-filename"><code class="docutils literal notranslate"><span class="pre">io.lines</span> <span class="pre">([filename</span> <span class="pre">···])</span></code></a></li>
<li><a class="reference internal" href="#io-open-filename-mode"><code class="docutils literal notranslate"><span class="pre">io.open</span> <span class="pre">(filename</span> <span class="pre">[,</span> <span class="pre">mode])</span></code></a></li>
<li><a class="reference internal" href="#io-output-file"><code class="docutils literal notranslate"><span class="pre">io.output</span> <span class="pre">([file])</span></code></a></li>
<li><a class="reference internal" href="#io-popen-prog-mode"><code class="docutils literal notranslate"><span class="pre">io.popen</span> <span class="pre">(prog</span> <span class="pre">[,</span> <span class="pre">mode])</span></code></a></li>
<li><a class="reference internal" href="#io-read"><code class="docutils literal notranslate"><span class="pre">io.read</span> <span class="pre">(···)</span></code></a></li>
<li><a class="reference internal" href="#io-tmpfile"><code class="docutils literal notranslate"><span class="pre">io.tmpfile</span> <span class="pre">()</span></code></a></li>
<li><a class="reference internal" href="#io-type-obj"><code class="docutils literal notranslate"><span class="pre">io.type</span> <span class="pre">(obj)</span></code></a></li>
<li><a class="reference internal" href="#io-write"><code class="docutils literal notranslate"><span class="pre">io.write</span> <span class="pre">(···)</span></code></a></li>
<li><a class="reference internal" href="#file-close"><code class="docutils literal notranslate"><span class="pre">file:close</span> <span class="pre">()</span></code></a></li>
<li><a class="reference internal" href="#file-flush"><code class="docutils literal notranslate"><span class="pre">file:flush</span> <span class="pre">()</span></code></a></li>
<li><a class="reference internal" href="#file-lines"><code class="docutils literal notranslate"><span class="pre">file:lines</span> <span class="pre">(···)</span></code></a></li>
<li><a class="reference internal" href="#file-read"><code class="docutils literal notranslate"><span class="pre">file:read</span> <span class="pre">(···)</span></code></a></li>
<li><a class="reference internal" href="#file-seek-whence-offset"><code class="docutils literal notranslate"><span class="pre">file:seek</span> <span class="pre">([whence</span> <span class="pre">[,</span> <span class="pre">offset]])</span></code></a></li>
<li><a class="reference internal" href="#file-setvbuf-mode-size"><code class="docutils literal notranslate"><span class="pre">file:setvbuf</span> <span class="pre">(mode</span> <span class="pre">[,</span> <span class="pre">size])</span></code></a></li>
<li><a class="reference internal" href="#file-write"><code class="docutils literal notranslate"><span class="pre">file:write</span> <span class="pre">(···)</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#operating-system-library">6.9 – Operating System Library</a><ul>
<li><a class="reference internal" href="#os-clock"><code class="docutils literal notranslate"><span class="pre">os.clock</span> <span class="pre">()</span></code></a></li>
<li><a class="reference internal" href="#os-date-format-time"><code class="docutils literal notranslate"><span class="pre">os.date</span> <span class="pre">([format</span> <span class="pre">[,</span> <span class="pre">time]])</span></code></a></li>
<li><a class="reference internal" href="#os-difftime-t2-t1"><code class="docutils literal notranslate"><span class="pre">os.difftime</span> <span class="pre">(t2,</span> <span class="pre">t1)</span></code></a></li>
<li><a class="reference internal" href="#os-execute-command"><code class="docutils literal notranslate"><span class="pre">os.execute</span> <span class="pre">([command])</span></code></a></li>
<li><a class="reference internal" href="#os-exit-code-close"><code class="docutils literal notranslate"><span class="pre">os.exit</span> <span class="pre">([code</span> <span class="pre">[,</span> <span class="pre">close]])</span></code></a></li>
<li><a class="reference internal" href="#os-getenv-varname"><code class="docutils literal notranslate"><span class="pre">os.getenv</span> <span class="pre">(varname)</span></code></a></li>
<li><a class="reference internal" href="#os-remove-filename"><code class="docutils literal notranslate"><span class="pre">os.remove</span> <span class="pre">(filename)</span></code></a></li>
<li><a class="reference internal" href="#os-rename-oldname-newname"><code class="docutils literal notranslate"><span class="pre">os.rename</span> <span class="pre">(oldname,</span> <span class="pre">newname)</span></code></a></li>
<li><a class="reference internal" href="#os-setlocale-locale-category"><code class="docutils literal notranslate"><span class="pre">os.setlocale</span> <span class="pre">(locale</span> <span class="pre">[,</span> <span class="pre">category])</span></code></a></li>
<li><a class="reference internal" href="#os-time-table"><code class="docutils literal notranslate"><span class="pre">os.time</span> <span class="pre">([table])</span></code></a></li>
<li><a class="reference internal" href="#os-tmpname"><code class="docutils literal notranslate"><span class="pre">os.tmpname</span> <span class="pre">()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#debug-library">6.10 – Debug Library</a><ul>
<li><a class="reference internal" href="#debug-debug"><code class="docutils literal notranslate"><span class="pre">debug.debug</span> <span class="pre">()</span></code></a></li>
<li><a class="reference internal" href="#debug-gethook-thread"><code class="docutils literal notranslate"><span class="pre">debug.gethook</span> <span class="pre">([thread])</span></code></a></li>
<li><a class="reference internal" href="#debug-getinfo-thread-f-what"><code class="docutils literal notranslate"><span class="pre">debug.getinfo</span> <span class="pre">([thread,]</span> <span class="pre">f</span> <span class="pre">[,</span> <span class="pre">what])</span></code></a></li>
<li><a class="reference internal" href="#debug-getlocal-thread-f-local"><code class="docutils literal notranslate"><span class="pre">debug.getlocal</span> <span class="pre">([thread,]</span> <span class="pre">f,</span> <span class="pre">local)</span></code></a></li>
<li><a class="reference internal" href="#debug-getmetatable-value"><code class="docutils literal notranslate"><span class="pre">debug.getmetatable</span> <span class="pre">(value)</span></code></a></li>
<li><a class="reference internal" href="#debug-getregistry"><code class="docutils literal notranslate"><span class="pre">debug.getregistry</span> <span class="pre">()</span></code></a></li>
<li><a class="reference internal" href="#debug-getupvalue-f-up"><code class="docutils literal notranslate"><span class="pre">debug.getupvalue</span> <span class="pre">(f,</span> <span class="pre">up)</span></code></a></li>
<li><a class="reference internal" href="#debug-getuservalue-u"><code class="docutils literal notranslate"><span class="pre">debug.getuservalue</span> <span class="pre">(u)</span></code></a></li>
<li><a class="reference internal" href="#debug-sethook-thread-hook-mask-count"><code class="docutils literal notranslate"><span class="pre">debug.sethook</span> <span class="pre">([thread,]</span> <span class="pre">hook,</span> <span class="pre">mask</span> <span class="pre">[,</span> <span class="pre">count])</span></code></a></li>
<li><a class="reference internal" href="#debug-setlocal-thread-level-local-value"><code class="docutils literal notranslate"><span class="pre">debug.setlocal</span> <span class="pre">([thread,]</span> <span class="pre">level,</span> <span class="pre">local,</span> <span class="pre">value)</span></code></a></li>
<li><a class="reference internal" href="#debug-setmetatable-value-table"><code class="docutils literal notranslate"><span class="pre">debug.setmetatable</span> <span class="pre">(value,</span> <span class="pre">table)</span></code></a></li>
<li><a class="reference internal" href="#debug-setupvalue-f-up-value"><code class="docutils literal notranslate"><span class="pre">debug.setupvalue</span> <span class="pre">(f,</span> <span class="pre">up,</span> <span class="pre">value)</span></code></a></li>
<li><a class="reference internal" href="#debug-setuservalue-udata-value"><code class="docutils literal notranslate"><span class="pre">debug.setuservalue</span> <span class="pre">(udata,</span> <span class="pre">value)</span></code></a></li>
<li><a class="reference internal" href="#debug-traceback-thread-message-level"><code class="docutils literal notranslate"><span class="pre">debug.traceback</span> <span class="pre">([thread,]</span> <span class="pre">[message</span> <span class="pre">[,</span> <span class="pre">level]])</span></code></a></li>
<li><a class="reference internal" href="#debug-upvalueid-f-n"><code class="docutils literal notranslate"><span class="pre">debug.upvalueid</span> <span class="pre">(f,</span> <span class="pre">n)</span></code></a></li>
<li><a class="reference internal" href="#debug-upvaluejoin-f1-n1-f2-n2"><code class="docutils literal notranslate"><span class="pre">debug.upvaluejoin</span> <span class="pre">(f1,</span> <span class="pre">n1,</span> <span class="pre">f2,</span> <span class="pre">n2)</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#independent-edition-lua">7 – Independent Edition Lua</a></li>
<li><a class="reference internal" href="#incompatibility-with-previous-versions">8 – Incompatibility with previous versions</a><ul>
<li><a class="reference internal" href="#change-of-language">8.1 – Change of language</a></li>
<li><a class="reference internal" href="#changes-to-the-library">8.2 – Changes to the library</a></li>
<li><a class="reference internal" href="#api-the-change">8.3 – API The change</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lua-the-full-syntax">9 – Lua The full syntax</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div>

<script>
  window.chatbaseConfig = {
    chatbotId: "kXE945ztlW6gUvKdR4qnn",
  }
</script><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <script src="../_static/js/baidu.js"></script>
    <script src="../_static/js/a.js"></script>
    <script src="../_static/js/jquery.magnific-popup.min.js"></script>
    </body>
</html>