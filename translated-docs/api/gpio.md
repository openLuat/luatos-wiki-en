# gpio - GPIO Operation

{bdg-success}`Adapted` {bdg-primary}`Air101/Air103` {bdg-primary}`Air601` {bdg-primary}`Air105` {bdg-primary}`ESP32C3` {bdg-primary}`ESP32S3` {bdg-primary}`Air780E/Air700E` {bdg-primary}`Air780EP`

```{note}
This page document is automatically generated by [this file](https://gitee.com/openLuat/LuatOS/tree/master/luat/modules/luat_lib_gpio.c). If there is any error, please submit issue or help modify pr, thank youÔºÅ
```

```{tip}
This library has its own demo,[click this link to view the demo example of gpio](https://gitee.com/openLuat/LuatOS/tree/master/demo/gpio)
```
```{tip}
There are also video tutorials in this library, [click this link to view](https://www.bilibili.com/video/BV1hr4y1p7dt)
```

## Constant

|constant | type | explanation|
|-|-|-|
|gpio.LOW|number|Low level|
|gpio.HIGH|number|High Level|
|gpio.PULLUP|number|Pull-up|
|gpio.PULLDOWN|number|Drop-down|
|gpio.RISING|number|Rising edge trigger|
|gpio.FALLING|number|Falling edge trigger|
|gpio.BOTH|number|Two-way trigger, some devices support|
|gpio.HIGH_IRQ|number|High level trigger, some devices support|
|gpio.LOW_IRQ|number|Low-level trigger, some devices support|


## gpio.setup(pin, mode, pull, irq, alt)



Set Pin Function

**Parameters**

|Incoming Value Type | Explanation|
|-|-|
|int|pin gpio Number, must be numeric|
|any|mode Input and output mode:<br> Number 0/1 represents output mode <br>nil represents input mode <br>function represents interrupt mode|
|int|pull The following pull-up mode can be gpio.PULLUP or gpio.PULLDOWN, which needs to be selected according to the actual hardware|
|int|irq Interrupt trigger mode, default gpio.BOTH. interrupt triggering mode <br> rising edge gpio.RISING<br> falling edge gpio.FALLING<br> both rising and falling are triggered gpio.BOTH |
|int|alt Multiplexing option, currently only EC618 platform needs this parameter, some GPIO can be multiplexed to different pins, you can select the multiplexing option (0 or 4) to multiplex to the corresponding pin|

**Return Value**

|return value type | explanation|
|-|-|
|any|Output mode returns the closure of the set level, input mode and interrupt mode returns the closure of the acquired level|

**Examples**

```lua
-- Set gpio17 as input
gpio.setup(17, nil)
-- Set gpio17 to output, and the initialization level is low, using the hardware default pull-up configuration
gpio.setup(17, 0)
-- Set gpio17 to output, initialize level high, and enable internal pull-up
gpio.setup(17, 1, gpio.PULLUP)
-- Set gpio27 to interrupt
gpio.setup(27, function(val) print("IRQ_27",val) end, gpio.PULLUP)
-- Set gpio27 to interrupt
gpio.setup(27, function(val) print("IRQ_27",val) end, gpio.PULLUP)

-- alt_func Added in 2023.7.2
-- Set the AIR780E PIN33 to be multiplexed into gpio18, the direction output, and the initialization level is low, using the hardware default pull-up configuration
gpio.setup(18, 0, nil, nil, 4)

```

---

## gpio.set(pin, value)



Set Pin Level

**Parameters**

|Incoming Value Type | Explanation|
|-|-|
|int|pin GPIO Number, must be numeric|
|int|value Level, which can be high level gpio.HIGH, low level gpio.LOW, or directly write the value 1 or 0|

**Return Value**

|return value type | explanation|
|-|-|
|nil|No return value|

**Examples**

```lua
-- Set gpio17 to low
gpio.set(17, 0)

```

---

## gpio.get(pin)



Get Pin Level

**Parameters**

|Incoming Value Type | Explanation|
|-|-|
|int|pin GPIO Number, must be numeric|

**Return Value**

|return value type | explanation|
|-|-|
|value|Level, high level gpio.HIGH, low level gpio.LOW, corresponding to value 1 and 0|

**Examples**

```lua
-- Get the current level of gpio17.
gpio.get(17)

```

---

## gpio.close(pin)



Turn off the pin function (high impedance input state), turn off the interrupt

**Parameters**

|Incoming Value Type | Explanation|
|-|-|
|int|pin GPIO Number, must be numeric|

**Return Value**

|return value type | explanation|
|-|-|
|nil|No return value, always successful execution|

**Examples**

```lua
-- Close gpio17
gpio.close(17)

```

---

## gpio.setDefaultPull(val)



Set the default pull-up/pull-down setting of GPIO pin, the default is platform customization (generally open and leak).

**Parameters**

|Incoming Value Type | Explanation|
|-|-|
|int|val 0 Platform customization, 1 pull-up, 2 pull-down|

**Return Value**

|return value type | explanation|
|-|-|
|boolean|If the pass value is correct, return true, otherwise return false|

**Examples**

```lua
-- Set the pull default value of gpio.setup to pull up
gpio.setDefaultPull(1)

```

---

## gpio.toggle(pin)



Transform GPIO pin output level, only output mode available

**Parameters**

|Incoming Value Type | Explanation|
|-|-|
|int|GPIO number of the pin|

**Return Value**

|return value type | explanation|
|-|-|
|nil|No return value|

**Examples**

```lua
-- This API was added on 2022.05.17
-- Assuming there are LEDs on GPIO16, switch every 500ms
gpio.setup(16, 0)
sys.timerLoopStart(function()
    gpio.toggle(16)
end, 500)

```

---

## gpio.pulse(pin,level,len,delay)



Output a set of pulses at the same GPIO. Note that len's unit is bit, with the high bit first..

**Parameters**

|Incoming Value Type | Explanation|
|-|-|
|int|gpio No.|
|int/string|Value or string.|
|int|len The unit of length is bit, with the high bit in front..|
|int|delay Delay, currently no fixed time unit|

**Return Value**

|return value type | explanation|
|-|-|
|nil|No return value|

**Examples**

```lua
-- Through the PB06 pin output output 8 level changes.
gpio.pulse(pin.PB06,0xA9, 8, 0)

```

---

## gpio.debounce(pin, ms, mode)



Anti-shake settings, anti-shake according to hardware ticks

**Parameters**

|Incoming Value Type | Explanation|
|-|-|
|int|gpio Number, 0~127, related to hardware|
|int|Anti-shake duration, in milliseconds, with a maximum of 65555 ms. If it is set to 0, it is turned off.|
|int|mode, 0 cooling mode, 1 delay mode. Default is 0|

**Return Value**

|return value type | explanation|
|-|-|
|nil|No return value|

**Examples**

```lua
-- Shake elimination mode, currently supports 2 types, starting on 2022.12.16 mode=1
-- 0 After the interrupt is triggered, report it once immediately, and then accept the interrupt again after cooling for N milliseconds.
-- 1 After triggering the interrupt, delay N milliseconds, during which there is no new interrupt and no level change, report once

-- Turn on anti-shake, mode 0-cooling, report immediately after interruption, but report only once within 100ms
gpio.debounce(7, 100) -- If the chip supports pin library, pin.PA7 can be used instead of numbers.7
-- Turn on anti-shake, mode 1-delay, wait for 100ms after interruption, if the level is maintained during the period, report once after the time is up
-- Correspondingly, if the input is a 50hz square wave, then no report will be triggered.
gpio.debounce(7, 100, 1)

-- Turn off anti-shake, and turn off when the time is set to 0.
gpio.debounce(7, 0)

```

---

