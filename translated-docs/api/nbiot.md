# nbiot - NB-IOT Operation Library

{bdg-secondary}`Adaptation status unknown`

```{note}
This page document is automatically generated by [this file](https://gitee.com/openLuat/LuatOS/tree/master/luat/modules/luat_lib_nbiot.c). If there is any error, please submit issue or help modify pr, thank youÔºÅ
```


## nbiot.isReady()



Is the network ready

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|boolean|Connected returns true, otherwise false|

**Examples**

```lua
--  Determine whether it is connected to the Internet
if nbiot.isReady() then 
    log.info("nbiot", "net is ready")
end

```

---

## nbiot.imsi()



Read IMSI

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|string|Returns the IMSI value or if it does not exist nil|

**Examples**

```lua
--Read imsi
log.info("nbiot", "imsi", nbiot.imsi())

```

---

## nbiot.iccid()



Read ICCID

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|string|Returns the ICCID value or if it does not exist nil|

**Examples**

```lua
-- Read iccid
log.info("nbiot", "iccid", nbiot.iccid())

```

---

## nbiot.imei(val)



Read or set IMEI

**Parameters**

|Incoming Value Type | Explanation|
|-|-|
|string|Pass in the imei value to be set, and read it without passing it.|

**Return Value**

|return value type | explanation|
|-|-|
|string|Returns the imei value, if it does not exist nil|

**Examples**

```lua
-- Read imei
log.info("nbiot", "imei", nbiot.imei())
@usage 
-- Setup imei
log.info("nbiot", "imei", nbiot.imei("898989898989899898"))

```

---

## nbiot.rssi()



Read RSSI

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|Returns the rssi value|

**Examples**

```lua
-- Read rssi
log.info("nbiot", "rssi", nbiot.rssi())

```

---

## nbiot.apn()



Read APN

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|string|Returns the apn value|

**Examples**

```lua
-- Read APN
log.info("nbiot", "apn", nbiot.apn())

```

---

## nbiot.userApn(apn,Auth_User_Name,Auth_Password,PDN_TYPE)



Read Settings User APN

**Parameters**

|Incoming Value Type | Explanation|
|-|-|
|return|Read return PDN_TYPE,Auth_User_Name,Auth_Password, set return bool|

**Return Value**

None

**Examples**

```lua
-- Read APN
log.info("nbiot", "apn", nbiot.userApn())

```

---

## nbiot.tac()



Read TAC

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|Returns the TAC value|

**Examples**

```lua
-- Read TAC
log.info("nbiot", "tac", nbiot.tac())

```

---

## nbiot.tauTime()



Read Tau Time

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|Returns the Tau Time value|

**Examples**

```lua
-- Read Tau Time
log.info("nbiot", "tau time", nbiot.tauTime())

```

---

## nbiot.activeTime()



Read Active Time

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|Returns the Active Time value|

**Examples**

```lua
-- Read Active Time
log.info("nbiot", "Active Time", nbiot.activeTime())

```

---

## nbiot.cellID()



Read CellID

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|Returns the CellID value|

**Examples**

```lua
-- Read CellID
log.info("nbiot", "CellID", nbiot.cellID())

```

---

## nbiot.snr()



Read SNR

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|Returns the SNR value|

**Examples**

```lua
-- Read SNR
log.info("nbiot", "SNR", nbiot.snr())

```

---

## nbiot.csq()



reading CSQ, is not exactly equivalent to GSM's CSQ

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|return csq value|

**Examples**

```lua
-- Read csq
log.info("nbiot", "csq", nbiot.csq())

```

---

## nbiot.ceLevel()



Read CE Level

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|Returns the CE Level value|

**Examples**

```lua
-- Read CE Level
log.info("nbiot", "CE Level", nbiot.ceLevel())

```

---

## nbiot.sn(val)



Read or set SN, ordinary brush machine (brush bottom layer/brush script) will not clear

**Parameters**

|Incoming Value Type | Explanation|
|-|-|
|string|SN value to be set (only visible characters), read if no value is passed|

**Return Value**

|return value type | explanation|
|-|-|
|string|Returns the SN value|

**Examples**

```lua
-- Read SN
log.info("nbiot", "SN", nbiot.sn())
@usage 
-- Setup SN
log.info("nbiot", "SN", nbiot.sn("My Custom SN"))

```

---

## nbiot.updateCellInfo()



Refresh network information, which can be refreshed through scheduled tasks, with a minimum interval of 5 seconds

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|boolean|Returns true if the refresh thread is successfully started, otherwise false.|

**Examples**

```lua
-- Refresh Network Information
nbiot.updateCellInfo()
sys.waitUntil("CELL_INFO_IND", 3000)
log.info("nbiot", "cell", json.encode(nbiot.getCellInfo()))

```

---

## nbiot.mcc()



Read MCC value, available after network registration, refresh through nbiot.updateCellInfo()

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|Operator MCC Value|

**Examples**

```lua
-- Read MCC
log.info("nbiot", "mcc", nbiot.mcc())

```

---

## nbiot.mnc()



Read MNC value, available after network registration, refresh through nbiot.updateCellInfo()

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|Operator MNC Value|

**Examples**

```lua
-- Read MNC
log.info("nbiot", "mnc", nbiot.mnc())

```

---

## nbiot.earfcn()



Read the earfcn value and use it after registering the network. Refresh it through nbiot.updateCellInfo()

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|Operator earfcn value|

**Examples**

```lua
-- Read earfcn
log.info("nbiot", "earfcn", nbiot.earfcn())

```

---

## nbiot.phyCellId()



Read the phyCellId value, available after registering the network, and refresh it through nbiot.updateCellInfo()

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|Operator phyCellId value|

**Examples**

```lua
-- Read phyCellId
log.info("nbiot", "phyCellId", nbiot.phyCellId())

```

---

## nbiot.rsrq()



Read rsrq value, available after network registration, refresh through nbiot.updateCellInfo()

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|operator ersrq value|

**Examples**

```lua
-- Read rsrq
log.info("nbiot", "rsrq", nbiot.rsrq())

```

---

## nbiot.rsrp()



Read the rsrp value, available after registering the network, and refresh it through nbiot.updateCellInfo()

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|operator rsrp value|

**Examples**

```lua
-- Read rsrp
log.info("nbiot", "rsrp", nbiot.rsrp())

```

---

## nbiot.powerLevel()



Read the PowerLevel value, available after registering the network, and refresh it through nbiot.updateCellInfo()

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|Operator PowerLevel value|

**Examples**

```lua
-- Read PowerLevel
log.info("nbiot", "PowerLevel", nbiot.powerLevel())

```

---

## nbiot.getCellInfo()



Get the details of the network base station, available after registering the network, and refresh through nbio. updateCellInfo()

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|table|Network Base Station Details|

**Examples**

```lua
-- Read base station information
log.info("nbiot", "cell info", json.encode(nbiot.getCellInfo()))

```

---

## nbiot.setCFUN(val)



Enter or exit airplane mode

**Parameters**

|Incoming Value Type | Explanation|
|-|-|
|int|0 Flight mode, 1 normal networking mode|

**Return Value**

|return value type | explanation|
|-|-|
|boolean|Set success to return true, otherwise return false|

**Examples**

```lua
-- Enter Flight Mode
nbiot.setCFUN(0)

```

---

## nbiot.setBootCFUN(val)



Set whether to enter flight mode when the device is powered on

**Parameters**

|Incoming Value Type | Explanation|
|-|-|
|int|0 Flight mode, 1 normal networking mode|

**Return Value**

|return value type | explanation|
|-|-|
|boolean|Set success to return true, otherwise return false|

**Examples**

```lua
-- Set to power up to enter flight mode
nbiot.setBootCFUN(0)

```

---

## nbiot.getBootCFUN(val)



Obtain whether the device enters flight mode when it is powered on

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|Power on to enter the flight mode to return to 0, enter the normal mode to return 1|

**Examples**

```lua
-- Get Power-Up Mode
nbiot.getBootCFUN()

```

---

## nbiot.setPSM(psmMode,tauTimeS,activeTimeS)



Setting PSM parameters

**Parameters**

|Incoming Value Type | Explanation|
|-|-|
|int|psm Mode, CMI_MM_DISABLE_PSM(0)/CMI_MM_ENABLE_PSM(1)/CMI_MM_DISCARD_PSM(2)|
|int|TAU time(unit: S)---related to T3412|
|int|active time(unit: S)---related to T3324|

**Return Value**

|return value type | explanation|
|-|-|
|boolean|Set success to return true, otherwise return false|

**Examples**

```lua
-- Setup PSM
nbiot.setPSM(1, 60, 120)

```

---

## nbiot.setEDRX(modeVal,actType,reqEdrxValueMs)



Setting the EDRX Parameters

**Parameters**

|Incoming Value Type | Explanation|
|-|-|
|int|Mode,CMI_MM_DISABLE_EDRX = 0/CMI_MM_ENABLE_EDRX_AND_DISABLE_IND = 1/CMI_MM_ENABLE_EDRX_AND_ENABLE_IND = 2/CMI_MM_DISCARD_EDRX = 3|
|int|Optional value, 0 or 5. CMI_MM_EDRX_NO_ACT_OR_NOT_USE_EDRX = 0/CMI_MM_EDRX_NB_IOT = 5|
|int|edrx value, a 4-byte length binary string|

**Return Value**

|return value type | explanation|
|-|-|
|boolean|Set success to return true, otherwise return false|

**Examples**

```lua
-- Setup EDRX
nbiot.setPSM(1, 5, "0101")

```

---

## nbiot.getPSM()



Get PSM parameters

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|psm Mode, CMI_MM_DISABLE_PSM(0)/CMI_MM_ENABLE_PSM(1)/CMI_MM_DISCARD_PSM(2)|
|int|TAU time(unit: S)---related to T3412|
|int|active time(unit: S)---related to T3324|

**Examples**

```lua
-- Get PSM
log.info("psm", nbiot.getPSM())

```

---

## nbiot.getEDRX()



Get EDRX parameters

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|Mode,CMI_MM_DISABLE_EDRX = 0/CMI_MM_ENABLE_EDRX_AND_DISABLE_IND = 1/CMI_MM_ENABLE_EDRX_AND_ENABLE_IND = 2/CMI_MM_DISCARD_EDRX = 3|
|int|Optional value, 0 or 5. CMI_MM_EDRX_NO_ACT_OR_NOT_USE_EDRX = 0/CMI_MM_EDRX_NB_IOT = 5|
|int|edrx Value, in milliseconds|

**Examples**

```lua
-- Get EDRX
log.info("edrx", nbiot.getEDRX())

```

---

## nbiot.setTZ(tz, auto)



Setting Time Zone Parameters

**Parameters**

|Incoming Value Type | Explanation|
|-|-|
|int|The time zone parameter, which is optional. The unit is 1/4 time zone. The default value is East Zone 8. The corresponding value is 32|
|boolean|Whether to automatically set the time zone. Optional. The default value is true|

**Return Value**

None

**Examples**

```lua
-- Set to East Zone 8, disable automatic time zone update
nbiot.setTZ(32, false)
@usage 
-- Enable automatic time zone update
nbiot.setTZ(nil, true)

```

---

## nbiot.getTZ()



Get Time Zone Parameters

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|The time zone parameter, the unit is 1/4 time zone, the default East Zone 8, and the value is 32|
|boolean|Set the time zone automatically, the default is true|

**Examples**

```lua
-- Get Time Zone Parameters
log.info("timezone", nbiot.getTZ())

```

---

## nbiot.setBands(modes)



Set Band Mode (Not Available)

**Parameters**

|Incoming Value Type | Explanation|
|-|-|
|any|The pattern, which needs to be an array in the form of table, must be passed in.|

**Return Value**

|return value type | explanation|
|-|-|
|boolean|Set Results|

**Examples**

```lua
-- Search only band 8
log.info("band", nbiot.setBands({8}))

```

---

## nbiot.getBands()



Gets the currently used Band mode (not available)

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|table|Array of the set band|

**Examples**

```lua
-- Search only band 8
log.info("band", json.encode(nbiot.getBands()))

```

---

## nbiot.setEDRXPtw(val)



Setting the EDX PTW parameters

**Parameters**

|Incoming Value Type | Explanation|
|-|-|
|int|Value to be set|

**Return Value**

|return value type | explanation|
|-|-|
|boolean|Returns true on success, otherwise false|

**Examples**

```lua
-- Set PTW value X
nbiot.setEDRXPtw(val)
-- Optional Value
reqPtwValue:
NB-S1 mode
The field contains the PTW value in seconds for NB-S1 mode.The PTW value is used
as specified in 3GPP TS 23.682 [133a].The PTW value is derived as follows:
bit
         Paging Time Window length
0 0 0 0  2,56 seconds
0 0 0 1  5,12 seconds
0 0 1 0  7,68 seconds
0 0 1 1  10,24 seconds
0 1 0 0  12,8 seconds
0 1 0 1  15,36 seconds
0 1 1 0  17,92 seconds
0 1 1 1  20,48 seconds
1 0 0 0  23,04 seconds
1 0 0 1  25,6 seconds
1 0 1 0  28,16 seconds
1 0 1 1  30,72 seconds
1 1 0 0  33,28 seconds
1 1 0 1  35,84 seconds
1 1 1 0  38,4 seconds
1 1 1 1  40,96 seconds
 

```

---

## nbiot.getEDRXPtw()



Get EDX PTW parameters

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|ptw Value|

**Examples**

```lua
-- Print PTW value
log.info("ptw", nbiot.getEDRXPtw())

```

---

## nbiot.ticks()



Get tick count

**Parameters**

None

**Return Value**

|return value type | explanation|
|-|-|
|int|tick Count|

**Examples**

```lua
-- Print PTW value
log.info("tick", nbiot.ticks())

```

---

